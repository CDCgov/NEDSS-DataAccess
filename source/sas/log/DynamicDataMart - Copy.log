1                                           The SAS System             22:41 Saturday, January 6, 2024

NOTE: Copyright (c) 2002-2010 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.3 (TS1M2) 
      Licensed to GENERAL DYNAMICS IT INC/CDC NEDSS 2, Site 70238317.
NOTE: This session is executing on the X64_DSRV12  platform.



NOTE: Enhanced analytical products:

SAS/ETS 12.1

NOTE: SAS initialization used:
      real time           1.23 seconds
      cpu time            0.20 seconds
      

NOTE: AUTOEXEC processing beginning; file is 
      D:\wildfly-10.0.0.Final\nedssdomain\Nedss\report\autoexec.sas.

NOTE: Libref RDBDATA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: D:\wildfly-10.0.0.Final\nedssdomain\Nedss\report\dw\etl\rdbdata
NOTE: Libref NBSFMT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: D:\wildfly-10.0.0.Final\nedssdomain\Nedss\report\format
NOTE: The V6 engine on this host is limited to read-only access of SAS data files without index 
      optimization.  V6 data files cannot be created or updated and V6 catalogs cannot be read.
NOTE: Libref LIBRARY was successfully assigned as follows: 
      Engine:        V6 
      Physical Name: D:\wildfly-10.0.0.Final\nedssdomain\Nedss\report\metadata

NOTE: AUTOEXEC processing completed.

1          /**
2          Author: Pradeep Kumar Sharma
3          Company : CSRA
4          Year : 2018
5          NBS Version: 5.4
6          Description: This is the root sas class to create the dynamic datamart for page builder
6        ! pages.
7          This process not only create dynamic datamarts, but also drop orphan datamarts
8          
9          */
10         
11         /*calling the existing macro etllib*/
12         %etllib;
NOTE: Libref NBS_ODS was successfully assigned as follows: 
      Engine:        ODBC 
      Physical Name: nedss1
NOTE: Libref NBS_SRT was successfully assigned as follows: 
      Engine:        ODBC 
      Physical Name: nbs_srt
NOTE: Libref NBS_RDB was successfully assigned as follows: 
      Engine:        ODBC 
2                                           The SAS System             22:41 Saturday, January 6, 2024

      Physical Name: nbs_rdb
13         /*formatting*/
14         OPTIONS COMPRESS=YES;
15         options fmtsearch=(nbsfmt);
16         /*Creates a global variable assigned to 0*/
17         %global etlerr;
18         %let etlerr=0;
19         /*Include this file in order to be able to call the macros. We need to run the code from
19       ! Autoexec*/
20         %include dyndmpgm(DynamicDataMacro.sas);
2118       OPTIONS NOCARDIMAGE;
2119       /***TBD start*/
2120       /*Only shows if key is not null*/
2121       %MACRO ASSIGN_KEY (DS, KEY);
2122        DATA &DS;
2123         IF &KEY=1 THEN OUTPUT;
2124         SET &DS;
2125       	&KEY+1;
2126       	OUTPUT;
2127        RUN;
2128        PROC SORT DATA=&DS NODUPKEY; BY &KEY;RUN;
2129       %MEND ASSIGN_KEY;
2130       /*loading the data in the database*/
2131       PROC DATASETS LIB=WORK MEMTYPE=DATA
2132       		KILL;
                                              Directory

                    Libref         WORK                                           
                    Engine         V9                                             
                    Physical Name  D:\SAS Temporary Files\_TD3592_EC2AMAZ-ICQ89EN_
                    Filename       D:\SAS Temporary Files\_TD3592_EC2AMAZ-ICQ89EN_
WARNING: No matching members in directory.
2133       RUN;

2134       QUIT;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.28 seconds
      cpu time            0.01 seconds
      

2135       
2136       PROC SQL;
2137         DROP TABLE NBS_RDB.INIT;
NOTE: Table NBS_RDB.INIT has been dropped.
2138       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.00 seconds
      

2139       
2140       PROC SQL;
2141       /*It creates a table with 2 columns: form_cd and the datamart_nm associated to the
3                                           The SAS System             22:41 Saturday, January 6, 2024

2141     ! investigation page, where there's a datamart name defined and a condition associated to the
2141     !  investigation.*/
2142       CREATE TABLE NBS_RDB.INIT AS
2143       	SELECT  NBS_PAGE.FORM_CD, NBS_PAGE.DATAMART_NM FROM NBS_ODS.PAGE_COND_MAPPING INNER JOIN
2143     ! NBS_ODS.NBS_PAGE
2144       	ON PAGE_COND_MAPPING.WA_TEMPLATE_UID = NBS_PAGE.WA_TEMPLATE_UID
2145       WHERE DATAMART_NM IS NOT NULL AND CONDITION_CD IS NOT NULL;
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.INIT created, with 5 rows and 2 columns.

2146       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.03 seconds
      

2147       
2148       PROC SQL;
2149         DROP TABLE NBS_RDB.NBS_PAGE;
NOTE: Table NBS_RDB.NBS_PAGE has been dropped.
2150       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2151       
2152       PROC SQL;
2153       /*It creates a table with 2 columns: form_cd and the datamart_nm associated to the
2153     ! investigation page, where there's a datamart name defined and a condition associated to the
2153     !  investigation.*/
2154       CREATE TABLE NBS_RDB.NBS_PAGE AS
2155       	SELECT  DISTINCT NBS_PAGE.FORM_CD, NBS_PAGE.DATAMART_NM FROM NBS_ODS.PAGE_COND_MAPPING
2155     ! INNER JOIN NBS_ODS.NBS_PAGE
2156       	ON PAGE_COND_MAPPING.WA_TEMPLATE_UID = NBS_PAGE.WA_TEMPLATE_UID
2157       WHERE DATAMART_NM IS NOT NULL AND CONDITION_CD IS NOT NULL;
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.NBS_PAGE created, with 4 rows and 2 columns.

2158       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.00 seconds
      

2159       
2160       
2161       PROC SQL;
2162       /*it creates a table with 2 columns: investigation_form_cd and the datamart_nm associated
2162     ! to the investigation page where the rdb_table_nm is investigation*/
2163       CREATE TABLE INIT_FORM_SET AS
2164       SELECT INIT.FORM_CD  AS INVESTIGATION_FORM_CD 'INVESTIGATION_FORM_CD', INIT.DATAMART_NM
2164     ! FROM NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA
2165       ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD
4                                           The SAS System             22:41 Saturday, January 6, 2024

2166       INNER JOIN NBS_ODS.NBS_RDB_METADATA
2167       ON NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID
2168       WHERE RDB_TABLE_NM='INVESTIGATION' ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: The query as specified involves ordering by an item that doesn't appear in its SELECT clause.
NOTE: Compressing data set WORK.INIT_FORM_SET decreased size by 0.00 percent. 
      Compressed is 4 pages; un-compressed would require 4 pages.
NOTE: Table WORK.INIT_FORM_SET created, with 207 rows and 2 columns.

2169       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.23 seconds
      cpu time            0.07 seconds
      

2170       /*Sorting the data with no duplicates and order by investigation_form_cd*/
2171       PROC SORT DATA= INIT_FORM_SET NODUPKEY; BY INVESTIGATION_FORM_CD;RUN;

NOTE: There were 207 observations read from the data set WORK.INIT_FORM_SET.
NOTE: 203 observations with duplicate key values were deleted.
NOTE: The data set WORK.INIT_FORM_SET has 4 observations and 2 variables.
NOTE: Compressing data set WORK.INIT_FORM_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2172       /*SAS needs to assign keys this way*/
2173       %ASSIGN_KEY (INIT_FORM_SET, SORT_KEY);

NOTE: There were 4 observations read from the data set WORK.INIT_FORM_SET.
NOTE: The data set WORK.INIT_FORM_SET has 5 observations and 3 variables.
NOTE: Compressing data set WORK.INIT_FORM_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.00 seconds
      


NOTE: There were 5 observations read from the data set WORK.INIT_FORM_SET.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INIT_FORM_SET has 4 observations and 3 variables.
NOTE: Compressing data set WORK.INIT_FORM_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2174       /*DATA _NULL_;
2175       set INIT_FORM_SET;
2176          	RDB_TABLE_NM='D_INV_ADMINISTRATIVE';
2177          	DIMENSION= TRIM("'")||TRIM('D_INV_ADMINISTRATIVE')||TRIM("'") ;
5                                           The SAS System             22:41 Saturday, January 6, 2024

2178         	INVESTIGATION_FORM_CODE = TRIM("'")||TRIM(FORM_CD)||TRIM("'") ;
2179        		
2180       
2181         DIM_KEY = 	TRIM('D_INV_ADMINISTRATIVE')||TRIM('_KEY');
2182         IF COUNTSTD>0 then call execute('%MANAGE_D_INV('||RDB_TABLE_NM||','|| DIMENSION||','||
2182     ! DIM_KEY||','|| 'F_STD_PAGE_CASE'||','|| INVESTIGATION_FORM_CODE||')');
2183         IF COUNTSTD=0 then call execute('%MANAGE_D_INV('||RDB_TABLE_NM||','|| DIMENSION||','||
2183     ! DIM_KEY||','|| 'F_PAGE_CASE'||','|| INVESTIGATION_FORM_CODE||')');
2184         RUN;
2185       */
2186       
2187       DATA INIT_FORM_SET;
2188         SET INIT_FORM_SET;
2189       	BY SORT_KEY;
2190       	LENGTH RDB_COLUMN_NAME $30;
2191       	LENGTH INVESTIGATION_FORM_CODE $30;
2192       	IF FIRST.SORT_KEY THEN/*this is the way SAS iterates through each of the records*/
2193       
2194       		DATAMART_NAME = COMPRESS( "'"||DATAMART_NM||"'") ;
2195       		INVESTIGATION_FORM_CODE = TRIM("'")||TRIM(FORM_CD)||TRIM("'") ;
2196        		call symputx('DATAMART_NAME', COMPRESS("'"||DATAMART_NM||"'"));/*set the value into the
2196     ! first parameter (variable) and trims*/
2197        		DATAMART_TABLE_NAME = COMPRESS('DM_INV_'|| DATAMART_NM);
2198       		
2199       		/*Compiling and organizing and formatting metadata tables for investigation, patients,
2199     ! etc.*/
2200       		call execute('%INVEST_FORM_PROC()');
2201       		
2202       		/*Compiling and organizing and formatting metadata tables for case management*/
2203       		call execute('%MANAGE_CASE_MANAGEMENT()');
2204       	
2205       		/*MANAGE_D_INV ('D_INV_ADMINISTRATIVE','D_INV_ADMINISTRATIVE','D_INV_ADMINISTRATIVE_KEY')
2205     !        */
2206       		/*MANAGE_D_INV: creates all the columns necessary like OTH, UNIT, plus the regular ones.
2206     ! etc*/
2207       		DIM1='D_INV_ADMINISTRATIVE';
2208       		DIM1_KEY=COMPRESS(DIM1|| '_KEY');
2209       		call execute('%MANAGE_D_INV ('||DIM1||','|| "'"||DIM1||"'"||','|| DIM1_KEY ||')');
2210       
2211       		DIM2='D_INV_CLINICAL';
2212       		DIM2_KEY=COMPRESS(DIM2|| '_KEY');
2213       		call execute('%MANAGE_D_INV ('||DIM2||','|| "'"||DIM2||"'"||','|| DIM2_KEY ||')');
2214       
2215       		DIM3='D_INV_COMPLICATION';
2216       		DIM3_KEY=COMPRESS(DIM3|| '_KEY');
2217       		call execute('%MANAGE_D_INV ('||DIM3||','|| "'"||DIM3||"'"||','|| DIM3_KEY ||')');
2218       
2219       		DIM4='D_INV_CONTACT';
2220       		DIM4_KEY=COMPRESS(DIM4|| '_KEY');
2221       		call execute('%MANAGE_D_INV ('||DIM4||','|| "'"||DIM4||"'"||','|| DIM4_KEY ||')');
2222       		
2223       		DIM5='D_INV_DEATH';
2224       		DIM5_KEY=COMPRESS(DIM5|| '_KEY');
2225       		call execute('%MANAGE_D_INV ('||DIM5||','|| "'"||DIM5||"'"||','|| DIM5_KEY ||')');
6                                           The SAS System             22:41 Saturday, January 6, 2024

2226       
2227        		DIM6='D_INV_EPIDEMIOLOGY';
2228       		DIM6_KEY=COMPRESS(DIM6|| '_KEY');
2229       		call execute('%MANAGE_D_INV ('||DIM6||','|| "'"||DIM6||"'"||','|| DIM6_KEY ||')');
2230       
2231       		DIM7='D_INV_HIV';
2232       		DIM7_KEY=COMPRESS(DIM7|| '_KEY');
2233       		call execute('%MANAGE_D_INV ('||DIM7||','|| "'"||DIM7||"'"||','|| DIM7_KEY ||')');
2234       
2235       		DIM8='D_INV_PATIENT_OBS';
2236       		DIM8_KEY=COMPRESS(DIM8|| '_KEY');
2237       		call execute('%MANAGE_D_INV ('||DIM8||','|| "'"||DIM8||"'"||','|| DIM8_KEY ||')');
2238       
2239       		DIM9='D_INV_ISOLATE_TRACKING ';
2240       		DIM9_KEY=COMPRESS(DIM9|| '_KEY');
2241       		call execute('%MANAGE_D_INV ('||DIM9||','|| "'"||DIM9||"'"||','|| DIM9_KEY ||')');
2242       
2243       		DIM10='D_INV_LAB_FINDING';
2244       		DIM10_KEY=COMPRESS(DIM10|| '_KEY');
2245       		call execute('%MANAGE_D_INV ('||DIM10||','|| "'"||DIM10||"'"||','|| DIM10_KEY ||')');
2246       
2247       		DIM11='D_INV_MEDICAL_HISTORY';
2248       		DIM11_KEY=COMPRESS(DIM11|| '_KEY');
2249       		call execute('%MANAGE_D_INV ('||DIM11||','|| "'"||DIM11||"'"||','|| DIM11_KEY ||')');
2250       
2251       		DIM12='D_INV_MOTHER';
2252       		DIM12_KEY=COMPRESS(DIM12|| '_KEY');
2253       		call execute('%MANAGE_D_INV ('||DIM12||','|| "'"||DIM12||"'"||','|| DIM12_KEY ||')');
2254       
2255       		DIM13='D_INV_OTHER';
2256       		DIM13_KEY=COMPRESS(DIM13|| '_KEY');
2257       		call execute('%MANAGE_D_INV ('||DIM13||','|| "'"||DIM13||"'"||','|| DIM13_KEY ||')');
2258       
2259       		DIM14='D_INV_PREGNANCY_BIRTH';
2260       		DIM14_KEY=COMPRESS(DIM14|| '_KEY');
2261       		call execute('%MANAGE_D_INV ('||DIM14||','|| "'"||DIM14||"'"||','|| DIM14_KEY ||')');
2262       
2263       		DIM15='D_INV_RESIDENCY';
2264       		DIM15_KEY=COMPRESS(DIM15|| '_KEY');
2265       		call execute('%MANAGE_D_INV ('||DIM15||','|| "'"||DIM15||"'"||','|| DIM15_KEY ||')');
2266       
2267       		DIM16='D_INV_RISK_FACTOR';
2268       		DIM16_KEY=COMPRESS(DIM16|| '_KEY');
2269       		call execute('%MANAGE_D_INV ('||DIM16||','|| "'"||DIM16||"'"||','|| DIM16_KEY ||')');
2270       
2271        		DIM17='D_INV_SOCIAL_HISTORY';
2272       		DIM17_KEY=COMPRESS(DIM17|| '_KEY');
2273       		call execute('%MANAGE_D_INV ('||DIM17||','|| "'"||DIM17||"'"||','|| DIM17_KEY ||')');
2274       
2275       		DIM18='D_INV_SYMPTOM';
2276       		DIM18_KEY=COMPRESS(DIM18|| '_KEY');
2277       		call execute('%MANAGE_D_INV ('||DIM18||','|| "'"||DIM18||"'"||','|| DIM18_KEY ||')');
2278       
2279       		DIM19='D_INV_TREATMENT';
7                                           The SAS System             22:41 Saturday, January 6, 2024

2280       		DIM19_KEY=COMPRESS(DIM19|| '_KEY');
2281       		call execute('%MANAGE_D_INV ('||DIM19||','|| "'"||DIM19||"'"||','|| DIM19_KEY ||')');
2282       
2283       		DIM20='D_INV_TRAVEL';
2284       		DIM20_KEY=COMPRESS(DIM20|| '_KEY');
2285       		call execute('%MANAGE_D_INV ('||DIM20||','|| "'"||DIM20||"'"||','|| DIM20_KEY ||')');
2286       
2287       		DIM21='D_INV_UNDER_CONDITION';
2288       		DIM21_KEY=COMPRESS(DIM21|| '_KEY');
2289       		call execute('%MANAGE_D_INV ('||DIM21||','|| "'"||DIM21||"'"||','|| DIM21_KEY ||')');
2290       
2291       		DIM22='D_INV_VACCINATION';
2292       		DIM22_KEY=COMPRESS(DIM22|| '_KEY');
2293       		call execute('%MANAGE_D_INV ('||DIM22||','|| "'"||DIM22||"'"||','|| DIM22_KEY ||')');
2294       		
2295       		DIM23='D_INV_STD';
2296       		DIM23_KEY=COMPRESS(DIM23|| '_KEY');
2297       		call execute('%MANAGE_D_INV ('||DIM23||','|| "'"||DIM23||"'"||','|| DIM23_KEY ||')');
2298       
2299       		/*
2300       		It creates a table with rdb_column_nm, user_defined_column_nm, part_type_cd, which
2300     ! relates to the elements coming from D_Organization
2301       		and it creates the key, detail and qec columns for each of them removing the uid from the
2301     !  user_defined_column_nm, and then appending
2302       		_key, _detail, _qec.
2303       		*/
2304       		call execute('%ORGDATA ()');
2305       		
2306       		/*Same than previous one but the data comes from rdb_table_nm = D_PROVIDER*/
2307       		call execute('%PROVDATA ()');
2308       		
2309       		/*This macro handles repeating blocks of varchar questions*/
2310       		call execute('%REPEATVARCHARDATA()');
2311       		
2312       		/*This macro handles repeating blocks of date questions*/
2313       		call execute('%REPEATDATEDATA()');
2314       		
2315       		/*This macro handles repeating blocks of numeric questions*/
2316       		
2317       		call execute('%REPEATNUMERICDATA()');
2318       
2319       		/*it creates the actual datamart_table_name. First it removed the table if already
2319     ! exists, and then it is created.*/
2320       		call execute('%CREATEDM('||DATAMART_TABLE_NAME||')');
2321       
2322       
2323       
2324       	OUTPUT;
2325       
2326       RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2195:45   
NOTE: Variable RDB_COLUMN_NAME is uninitialized.
8                                           The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable FORM_CD is uninitialized.
WARNING: Apparent symbolic reference INV_SEL2 not resolved.
WARNING: Apparent symbolic reference PAT_SEL not resolved.
WARNING: Apparent symbolic reference CM_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
9                                           The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
10                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
11                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'HAV_DATAMART'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
12                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'HAV_DATAMART'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'HAV_DATAMART'
13                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
WARNING: Apparent symbolic reference INV_SEL2 not resolved.
WARNING: Apparent symbolic reference PAT_SEL not resolved.
WARNING: Apparent symbolic reference CM_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
14                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
15                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
16                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
17                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
18                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
WARNING: Apparent symbolic reference INV_SEL2 not resolved.
WARNING: Apparent symbolic reference PAT_SEL not resolved.
WARNING: Apparent symbolic reference CM_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
19                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
20                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
21                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
22                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_NIC'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
23                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_NIC'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'AL_NIC'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
24                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
WARNING: Apparent symbolic reference INV_SEL2 not resolved.
WARNING: Apparent symbolic reference PAT_SEL not resolved.
WARNING: Apparent symbolic reference CM_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
25                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
26                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
27                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
28                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: Apparent symbolic reference D_INV_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_UNIT not resolved.
WARNING: Apparent symbolic reference D_INV_CASE_OTH not resolved.
WARNING: Apparent symbolic reference D_INV_CASE not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'TB_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'TB_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
29                                          The SAS System             22:41 Saturday, January 6, 2024

GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
GLOBAL ETLERR 0
GLOBAL SQLOBS 207
GLOBAL SQLOOPS 27253
GLOBAL DATAMART_NAME 'TB_LTBI'
GLOBAL SYS_SQL_IP_ALL -1
GLOBAL SYS_SQL_IP_STMT 
GLOBAL DATASOURCE "nbs_rdb"
GLOBAL SYSDBMSG 
GLOBAL SAS_REPORT_HOME D:/wildfly-10.0.0.Final/nedssdomain/Nedss/report
GLOBAL SAS_REPORT_DBTYPE SQL SERVER
GLOBAL MAX_COLUMN_CHARACTER_LIMIT $15000
GLOBAL MAX_COLUMN_ROW_LIMIT_HTML 10000
GLOBAL MAX_COLUMN_ROW_LIMIT_CSV 100000
GLOBAL USERNAME "nbs_rdb"
GLOBAL SYSDBRC 0
GLOBAL SQLXRC 0
GLOBAL ETL_LAB_GOBACK_DAYS 1050
GLOBAL SQLXMSG  
GLOBAL PASSWORD "rdb"
GLOBAL ETL_HEALTHCHECK_GOBACK_DAYS 20
GLOBAL SQLXOBS 0
GLOBAL SQLRC 0
GLOBAL METRICS_GOBACKBY_DAYS 730
GLOBAL SQLEXITCODE 0
WARNING: Apparent symbolic reference D_REPEAT_COMMA_NAME not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference FACT_CASE not resolved.
WARNING: Apparent symbolic reference D_REPEAT_CASE_NAME not resolved.
NOTE: There were 4 observations read from the data set WORK.INIT_FORM_SET.
NOTE: The data set WORK.INIT_FORM_SET has 4 observations and 54 variables.
NOTE: Compressing data set WORK.INIT_FORM_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.39 seconds
      cpu time            0.06 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
30                                          The SAS System             22:41 Saturday, January 6, 2024

1         +             DROP TABLE NBS_RDB.SUMM_DATAMART;
NOTE: Table NBS_RDB.SUMM_DATAMART has been dropped.
1         +                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1         +                                                     PROC SQL;
1         +                                                                  CREATE TABLE 
NBS_RDB.SUMM_DATAMART AS SELECT PATIENT_KEY AS PATIENT_KEY, INVESTIGATION_KEY, DISEASE_GRP_CD      
FROM NBS_RDB.INV_SUMM_DATAMART        INNER JOIN NBS_RDB.CONDITION ON
2         + INV_SUMM_DATAMART.DISEASE_CD = CONDITION.CONDITION_CD      WHERE CONDITION.DISEASE_GRP_CD 
= (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART');
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.SUMM_DATAMART created, with 3997 rows and 3 columns.

2         +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           16.28 seconds
      cpu time            0.06 seconds
      

2         +
PROC SQL;  
2         +
  CREATE TABLE INV_METADATA AS SELECT  DISTINCT INIT.FORM_CD,
3         + INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM FROM NBS_RDB.INIT INNER JOIN 
NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD INNER JOIN
4         + NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='INVESTIGATION'  AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART')
5         + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.INV_METADATA created, with 45 rows and 5 columns.

5         +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

5         +
DATA INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET INV_METADATA;    SORT_KEY+1;
6         + OUTPUT;       RUN;

NOTE: There were 45 observations read from the data set WORK.INV_METADATA.
31                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.INV_METADATA has 46 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

6         +                      PROC SORT DATA=INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 46 observations read from the data set WORK.INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INV_METADATA has 45 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

6         +                                                                            ;
6         +                                                                              DATA 
INVLISTING;   SET INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   USER_DEFINED_COLUMN_NAME = TRIM
7         +(RDB_COLUMN_NM) || ' AS ' ||TRIM(USER_DEFINED_COLUMN_NM)|| 
"'"||TRIM(USER_DEFINED_COLUMN_NM)||"'";   RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || 
RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 45 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INVLISTING has 45 observations and 8 variables.
NOTE: Compressing data set WORK.INVLISTING decreased size by 84.44 percent. 
      Compressed is 7 pages; un-compressed would require 45 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

7         +
PROC SQL;  
7         +
  DELETE FROM INVLISTING WHERE SORT_KEY <
8         +(SELECT MAX (SORT_KEY) FROM INVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 44 rows were deleted from WORK.INVLISTING.

8         +                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

8         +                                               DATA INVLISTING; SET INVLISTING;    CALL 
SYMPUTX('INV_SEL2', '');  LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  
32                                          The SAS System             22:41 Saturday, January 6, 2024

TRIMMED_VALUE=SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1);   CALL SYMPUTX('INV_SEL2', TRIMMED_VALUE);
9         + RUN;

NOTE: There were 1 observations read from the data set WORK.INVLISTING.
NOTE: The data set WORK.INVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.INVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

9         +       PROC SQL;
9         +                   CREATE TABLE INVESTIGATION_DATA AS   SELECT  &INV_SEL2, 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.INVESTIGATION  INNER JOIN NBS_RDB.SUMM_DATAMART ON  
SUMM_DATAMART.INVESTIGATION_KEY  =INVESTIGATION.INVESTIGATION_KEY WHERE
10        + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART');
NOTE: Compressing data set WORK.INVESTIGATION_DATA decreased size by 96.45 percent. 
      Compressed is 71 pages; un-compressed would require 1999 pages.
NOTE: Table WORK.INVESTIGATION_DATA created, with 3997 rows and 46 columns.

10        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.06 seconds
      

10        +
PROC SQL;  
10        +
   CREATE TABLE CASE_MANAGEMENT_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
11        + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM NBS_RDB.INIT 
INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  INNER 
JOIN NBS_ODS.NBS_RDB_METADATA  ON
12        + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_CASE_MANAGEMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
13        + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL  ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.CASE_MANAGEMENT_METADATA created, with 0 rows and 5 columns.

13        +
   INSERT INTO CASE_MANAGEMENT_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
14        + DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_CASE_MANAGEMENT';
NOTE: 1 row was inserted into WORK.CASE_MANAGEMENT_METADATA.

14        +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      
33                                          The SAS System             22:41 Saturday, January 6, 2024


14        +                                                                         PROC SQL;
14        +                                                                                   CREATE 
TABLE INV_SUMM_DATAMART AS SELECT INV_SUMM_DATAMART.PROGRAM_JURISDICTION_OID,  
INV_SUMM_DATAMART.INVESTIGATION_KEY,  INV_SUMM_DATAMART.PATIENT_KEY,
15        + INV_SUMM_DATAMART.PATIENT_LOCAL_ID,  INV_SUMM_DATAMART.INVESTIGATION_CREATE_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_CREATED_BY,  INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,
16        + INV_SUMM_DATAMART.EVENT_DATE,  INV_SUMM_DATAMART.EVENT_DATE_TYPE,  
INV_SUMM_DATAMART.LABORATORY_INFORMATION,  INV_SUMM_DATAMART.EARLIEST_SPECIMEN_COLLECT_DATE,  
INV_SUMM_DATAMART.NOTIFICATION_STATUS,  INV_SUMM_DATAMART.CONFIRMATION_METHOD,
17        + INV_SUMM_DATAMART.CONFIRMATION_DT,   INV_SUMM_DATAMART.DISEASE_CD,  
INV_SUMM_DATAMART.DISEASE,  INV_SUMM_DATAMART.NOTIFICATION_LAST_UPDATED_DATE,   
INV_SUMM_DATAMART.NOTIFICATION_LOCAL_ID,  INV_SUMM_DATAMART.PROGRAM_AREA,
18        + INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,  INV_SUMM_DATAMART.PATIENT_COUNTY_CODE,  
INV_SUMM_DATAMART.JURISDICTION_NM  FROM NBS_RDB.INV_SUMM_DATAMART  INNER JOIN INVESTIGATION_DATA ON  
INVESTIGATION_DATA.INVESTIGATION_KEY =
19        + INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_LAST_UPDTD_BY already exists on file WORK.INV_SUMM_DATAMART.
NOTE: Compressing data set WORK.INV_SUMM_DATAMART decreased size by 93.45 percent. 
      Compressed is 262 pages; un-compressed would require 3997 pages.
NOTE: Table WORK.INV_SUMM_DATAMART created, with 3997 rows and 22 columns.

19        +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           32.10 seconds
      cpu time            6.17 seconds
      

19        +                                              PROC SQL;
19        +                                                         CREATE TABLE PAT_METADATA AS   
SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM
20        + NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD 
= INIT.FORM_CD INNER JOIN NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='D_PATIENT'  AND
21        + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART') AND RDB_COLUMN_NM NOT IN ('PATIENT_WORK_STREET_ADDRESS_1', 
'PATIENT_WORK_STREET_ADDRESS_2') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
22        + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PAT_METADATA created, with 28 rows and 5 columns.

22        +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

22        +
DATA PAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PAT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;
34                                          The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.PAT_METADATA has 29 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

22        +
PROC SORT DATA=PAT_METADATA
23        + NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 29 observations read from the data set WORK.PAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PAT_METADATA has 28 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

23        +                           ;
23        +                             DATA LISTING;   SET PAT_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   
USER_DEFINED_COLUMN_NAME = ' AS ' ||USER_DEFINED_COLUMN_NM||
24        + "'"||USER_DEFINED_COLUMN_NM||"'";   RDB_COLUMN_NAME_LIST = (TRIM(RDB_COLUMN_NM) || 
USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);     OUTPUT; RUN;

NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.LISTING has 28 observations and 8 variables.
NOTE: Compressing data set WORK.LISTING decreased size by 85.71 percent. 
      Compressed is 4 pages; un-compressed would require 28 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

24        +
PROC SQL;  
24        +
  DELETE FROM LISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM LISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 27 rows were deleted from WORK.LISTING.

24        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
35                                          The SAS System             22:41 Saturday, January 6, 2024


24        +
 DATA      
25        + LISTING; SET LISTING;   CALL SYMPUTX('PAT_SEL', '');  
LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  TRIMMED_VALUE=TRIM(SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1)); 
  CALL SYMPUTX('PAT_SEL', TRIMMED_VALUE); RUN;

NOTE: There were 1 observations read from the data set WORK.LISTING.
NOTE: The data set WORK.LISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.LISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

25        +
PROC SQL;  
25        +
  CREATE TABLE PATIENT_DATA AS   SELECT
26        + &PAT_SEL,SUMM_DATAMART.INVESTIGATION_KEY  FROM NBS_RDB.D_PATIENT INNER JOIN 
NBS_RDB.SUMM_DATAMART ON  D_PATIENT.PATIENT_KEY = SUMM_DATAMART.PATIENT_KEY; QUIT;
NOTE: Compressing data set WORK.PATIENT_DATA decreased size by 89.75 percent. 
      Compressed is 82 pages; un-compressed would require 800 pages.
NOTE: Table WORK.PATIENT_DATA created, with 3996 rows and 29 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.50 seconds
      cpu time            0.06 seconds
      

27        + DATA CASE_MANAGEMENT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET 
CASE_MANAGEMENT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

27        +
PROC SORT DATA=CASE_MANAGEMENT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
36                                          The SAS System             22:41 Saturday, January 6, 2024

      

27        +
;          
27        +
DATA CMLISTING;   SET CASE_MANAGEMENT_METADATA;   BY
28        + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) 
|| ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
29        +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CMLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

29        +
PROC SQL;  
29        +
  DELETE FROM CMLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
30        + CMLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.CMLISTING.

30        +             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

30        +                     DATA CMLISTING; SET CMLISTING;   CALL SYMPUTX('CM_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1,
31        + LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= 
'D_CASE_MANAGEMENT.INVESTIGATION_KEY AS INVESTIGATION_KEY';  CALL SYMPUTX('CM_CASE', TRIMMED_VALUE);  
RUN;

NOTE: There were 1 observations read from the data set WORK.CMLISTING.
NOTE: The data set WORK.CMLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

31        +
PROC SQL;  
37                                          The SAS System             22:41 Saturday, January 6, 2024

31        +
  CREATE TABLE CASE_MANAGEMENT_DATA AS   SELECT  &CM_CASE ,
32        + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  LEFT JOIN  
NBS_RDB.D_CASE_MANAGEMENT ON  SUMM_DATAMART.INVESTIGATION_KEY  =D_CASE_MANAGEMENT.INVESTIGATION_KEY 
WHERE SUMM_DATAMART.DISEASE_GRP_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
33        + DATAMART_NM='HAV_DATAMART')  AND D_CASE_MANAGEMENT.INVESTIGATION_KEY>1;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.CASE_MANAGEMENT_DATA.
NOTE: Compression was disabled for data set WORK.CASE_MANAGEMENT_DATA because compression overhead 
      would increase the size of the data set.
NOTE: Table WORK.CASE_MANAGEMENT_DATA created, with 0 rows and 1 columns.

33        +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.00 seconds
      

34        + PROC SQL;
34        +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
34        +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

34        +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

34        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

34        +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
35        +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

35        +
PROC SQL;  
35        +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
36        + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
38                                          The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
37        + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
38        + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 11 rows and 5 columns.

38        +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
39        + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

39        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

39        +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 13 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

39        +
PROC SORT DATA=D_INV_METADATA NODUPKEY;
40        + BY SORT_KEY;RUN;

NOTE: There were 13 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 12 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

40        +                 ;
40        +                    DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
39                                          The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
41        + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 12 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 83.33 percent. 
      Compressed is 2 pages; un-compressed would require 12 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

41        +
  PROC     
42        + SQL;
42        +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 11 rows were deleted from WORK.DYNINVLISTING.

42        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

42        +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
43        + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
44        + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      43:221   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

44        +                                                         PROC SQL;
40                                          The SAS System             22:41 Saturday, January 6, 2024

44        +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
45        + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
46        + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
47        + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

47        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.06 seconds
      

47        +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
48        + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

48        +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

48        +
;          
48        +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
49        + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
41                                          The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
50        + RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

50        +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
51        +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
52        + OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

52        +               PROC SQL;
52        +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

52        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

52        +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

52        +
42                                          The SAS System             22:41 Saturday, January 6, 2024

DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
53        + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
54        +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      54:60    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

54        +
PROC SQL;  
54        +
  CREATE TABLE
55        + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
56        + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
57        + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
58        + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

58        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

58        +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
59        +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
43                                          The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

59        +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

59        +                                                                           ;
59        +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
60        +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
61        +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

61        +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
62        + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

62        +
PROC SQL;  
63        + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

63        +
44                                          The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

63        +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

63        +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
64        + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
65        + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      65:50    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

65        +
PROC SQL;  
65        +
  CREATE TABLE
66        + D_INV_ADMINISTRATIVE AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
67        + NBS_RDB. D_INV_ADMINISTRATIVE ON  &FACT_CASE .D_INV_ADMINISTRATIVE_KEY  
=D_INV_ADMINISTRATIVE .D_INV_ADMINISTRATIVE_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.45 percent. 
      Compressed is 22 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_ADMINISTRATIVE created, with 3996 rows and 13 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           2.73 seconds
      cpu time            0.01 seconds
      

68        + D_INV_ADMINISTRATIVE; SET D_INV_ADMINISTRATIVE;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
45                                          The SAS System             22:41 Saturday, January 6, 2024

_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_ADMINISTRATIVE.
NOTE: The data set WORK.D_INV_ADMINISTRATIVE has 3996 observations and 13 variables.
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.45 percent. 
      Compressed is 22 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

69        + PROC SQL;
69        +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
69        +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

69        +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

69        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

69        +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
70        +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

70        +
PROC SQL;  
70        +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
46                                          The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.RDB_TABLE_NM,
71        + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
72        + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CLINICAL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
73        + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 6 rows and 5 columns.

73        +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
74        + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_CLINICAL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

74        +                                                                                           
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

74        +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

74        +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
75        + SORT_KEY;RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

75        +              ;
47                                          The SAS System             22:41 Saturday, January 6, 2024

75        +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
76        + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 7 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 71.43 percent. 
      Compressed is 2 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

76        +
PROC SQL;  
77        + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 6 rows were deleted from WORK.DYNINVLISTING.

77        +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

77        +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
78        + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
79        + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      78:221   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

79        +                                                         PROC SQL;
79        +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
48                                          The SAS System             22:41 Saturday, January 6, 2024

INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
80        + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
81        + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CLINICAL' 
   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
82        + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

82        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

82        +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
83        + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

83        +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

83        +
;          
83        +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
84        + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
49                                          The SAS System             22:41 Saturday, January 6, 2024

85        + RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

85        +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
86        +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
87        + OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

87        +               PROC SQL;
87        +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

87        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

87        +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

87        +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
88        + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
50                                          The SAS System             22:41 Saturday, January 6, 2024

LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
89        +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      89:60    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

89        +
PROC SQL;  
89        +
  CREATE TABLE
90        + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
91        + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_CLINICAL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
92        + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
93        + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

93        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

93        +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
94        +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
51                                          The SAS System             22:41 Saturday, January 6, 2024

      

94        +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

94        +                                                                           ;
94        +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
95        +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
96        +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

96        +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
97        + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

97        +
PROC SQL;  
98        + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

98        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
52                                          The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

98        +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

98        +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
99        + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
100       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      100:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

100       +
PROC SQL;  
100       +
  CREATE TABLE
101       + D_INV_CLINICAL AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
102       + NBS_RDB. D_INV_CLINICAL ON  &FACT_CASE .D_INV_CLINICAL_KEY  =D_INV_CLINICAL 
.D_INV_CLINICAL_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_CLINICAL; SET
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 99.65 percent. 
      Compressed is 14 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_CLINICAL created, with 3996 rows and 8 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           1.81 seconds
      cpu time            0.04 seconds
      

103       + D_INV_CLINICAL;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

53                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_CLINICAL.
NOTE: The data set WORK.D_INV_CLINICAL has 3996 observations and 8 variables.
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 99.65 percent. 
      Compressed is 14 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

104       + PROC SQL;
104       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
104       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

104       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

104       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

104       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
105       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

105       +
PROC SQL;  
105       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
106       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
54                                          The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
107       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
108       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

108       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
109       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_COMPLICATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

109       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

109       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

109       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
110       + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

110       +              ;
110       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
55                                          The SAS System             22:41 Saturday, January 6, 2024

111       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

111       +
PROC SQL;  
112       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

112       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

112       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
113       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
114       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      113:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

114       +                                                         PROC SQL;
114       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
115       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
56                                          The SAS System             22:41 Saturday, January 6, 2024

= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
116       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
117       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

117       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

117       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
118       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

118       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

118       +
;          
118       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
119       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
120       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
57                                          The SAS System             22:41 Saturday, January 6, 2024


120       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
121       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
122       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

122       +               PROC SQL;
122       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

122       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

122       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

122       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
123       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
124       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      124:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
58                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

124       +
PROC SQL;  
124       +
  CREATE TABLE
125       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
126       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
127       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
128       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

128       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

128       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
129       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

129       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

129       +                                                                           ;
129       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
59                                          The SAS System             22:41 Saturday, January 6, 2024

    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
130       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
131       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

131       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
132       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

132       +
PROC SQL;  
133       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

133       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

133       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

133       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
134       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
60                                          The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
135       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      135:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

135       +
PROC SQL;  
135       +
  CREATE TABLE
136       + D_INV_COMPLICATION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
137       + NBS_RDB. D_INV_COMPLICATION ON  &FACT_CASE .D_INV_COMPLICATION_KEY  =D_INV_COMPLICATION 
.D_INV_COMPLICATION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_COMPLICATION created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

138       + D_INV_COMPLICATION; SET D_INV_COMPLICATION;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_COMPLICATION.
NOTE: The data set WORK.D_INV_COMPLICATION has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
61                                          The SAS System             22:41 Saturday, January 6, 2024

      

139       + PROC SQL;
139       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
139       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

139       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

139       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

139       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
140       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

140       +
PROC SQL;  
140       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
141       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
142       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CONTACT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
143       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

143       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
144       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_CONTACT'  ;
62                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was inserted into WORK.D_INV_METADATA.

144       +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

144       +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

144       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

144       +
;  DATA    
145       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
146       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

146       +
PROC SQL;  
146       +
63                                          The SAS System             22:41 Saturday, January 6, 2024

  DELETE FROM
147       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

147       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

147       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
148       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
149       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      148:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

149       +                                   PROC SQL;
149       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
150       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
151       + RDB_TABLE_NM='D_INV_CONTACT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
152       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

152       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

64                                          The SAS System             22:41 Saturday, January 6, 2024

152       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

152       +
PROC SORT  
153       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

153       +                                                   ;
153       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
154       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

154       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
155       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
156       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
65                                          The SAS System             22:41 Saturday, January 6, 2024


156       +
PROC SQL;  
156       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
157       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

157       +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

157       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

157       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
158       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
159       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      159:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

159       +
PROC SQL;  
159       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
160       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
161       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CONTACT'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
66                                          The SAS System             22:41 Saturday, January 6, 2024

162       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
163       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

163       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

163       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

163       +
PROC SORT DATA=D_INV_METADATA_UNIT
164       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

164       +                           ;
164       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
165       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

165       +
67                                          The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT; SET
166       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
167       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

167       +
PROC SQL;  
167       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
168       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

168       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

168       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

168       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
169       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
170       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      170:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
68                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

170       +
PROC SQL;  
170       +
  CREATE TABLE D_INV_CONTACT AS   SELECT
171       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CONTACT ON
172       + &FACT_CASE .D_INV_CONTACT_KEY  =D_INV_CONTACT .D_INV_CONTACT_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_CONTACT; SET D_INV_CONTACT;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_CONTACT decreased size by 98.60 percent. 
      Compressed is 7 pages; un-compressed would require 500 pages.
NOTE: Table WORK.D_INV_CONTACT created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.57 seconds
      cpu time            0.03 seconds
      

173       + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_CONTACT.
NOTE: The data set WORK.D_INV_CONTACT has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_CONTACT decreased size by 98.60 percent. 
      Compressed is 7 pages; un-compressed would require 500 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

174       + PROC SQL;
174       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
174       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

174       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
69                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was updated in WORK.STD_TESTER.

174       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

174       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
175       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

175       +
PROC SQL;  
175       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
176       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
177       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_DEATH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
178       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

178       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
179       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_DEATH'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

179       +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.06 seconds
      

179       +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
70                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

179       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

179       +
;  DATA    
180       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
181       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

181       +
PROC SQL;  
181       +
  DELETE FROM
182       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

182       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

182       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
71                                          The SAS System             22:41 Saturday, January 6, 2024

183       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
184       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      183:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

184       +                                   PROC SQL;
184       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
185       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
186       + RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
187       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

187       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.00 seconds
      

187       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

187       +
PROC SORT  
188       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

72                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

188       +                                                   ;
188       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
189       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

189       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
190       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
191       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

191       +
PROC SQL;  
191       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
192       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

192       +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
73                                          The SAS System             22:41 Saturday, January 6, 2024


192       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

192       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
193       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
194       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      194:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

194       +
PROC SQL;  
194       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
195       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
196       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_DEATH'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
197       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
198       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

198       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

198       +
74                                          The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

198       +
PROC SORT DATA=D_INV_METADATA_UNIT
199       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

199       +                           ;
199       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
200       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

200       +
DATA D_INV_METADATA_UNIT; SET
201       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
202       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

75                                          The SAS System             22:41 Saturday, January 6, 2024

202       +
PROC SQL;
202       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
203       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

203       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

203       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

203       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
204       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
205       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      205:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

205       +
PROC SQL;  
205       +
  CREATE TABLE D_INV_DEATH AS   SELECT
206       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_DEATH ON
207       + &FACT_CASE .D_INV_DEATH_KEY  =D_INV_DEATH .D_INV_DEATH_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_DEATH; SET D_INV_DEATH;  DROP _TEMA001 _TEMA002 
76                                          The SAS System             22:41 Saturday, January 6, 2024

_TEMA003
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_DEATH created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.03 seconds
      

208       + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_DEATH.
NOTE: The data set WORK.D_INV_DEATH has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

209       + PROC SQL;
209       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
209       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

209       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

209       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

209       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
210       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

77                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

210       +
PROC SQL;  
210       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
211       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
212       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
213       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 40 rows and 5 columns.

213       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
214       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

214       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

214       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 41 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 42 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

214       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
215       + SORT_KEY;RUN;

78                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 42 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 41 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

215       +              ;
215       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
216       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 41 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 41 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 87.80 percent. 
      Compressed is 5 pages; un-compressed would require 41 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

216       +
PROC SQL;  
217       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 40 rows were deleted from WORK.DYNINVLISTING.

217       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

217       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
218       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
219       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      218:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
79                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

219       +                                                         PROC SQL;
219       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
220       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
221       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
222       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

222       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

222       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
223       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

223       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

223       +
;          
223       +
80                                          The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
224       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
225       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

225       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
226       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
227       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

227       +               PROC SQL;
227       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

227       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

227       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

227       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
81                                          The SAS System             22:41 Saturday, January 6, 2024

228       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
229       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      229:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

229       +
PROC SQL;  
229       +
  CREATE TABLE
230       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
231       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
232       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
233       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

233       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

233       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
234       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
82                                          The SAS System             22:41 Saturday, January 6, 2024


234       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

234       +                                                                           ;
234       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
235       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
236       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

236       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
237       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

237       +
PROC SQL;  
238       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

238       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
83                                          The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

238       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

238       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
239       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
240       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      240:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

240       +
PROC SQL;  
240       +
  CREATE TABLE
241       + D_INV_EPIDEMIOLOGY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
242       + NBS_RDB. D_INV_EPIDEMIOLOGY ON  &FACT_CASE .D_INV_EPIDEMIOLOGY_KEY  =D_INV_EPIDEMIOLOGY 
.D_INV_EPIDEMIOLOGY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 99.67 percent. 
      Compressed is 13 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_EPIDEMIOLOGY created, with 3996 rows and 41 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           2.56 seconds
      cpu time            0.10 seconds
      

243       + D_INV_EPIDEMIOLOGY; SET D_INV_EPIDEMIOLOGY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
84                                          The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_EPIDEMIOLOGY.
NOTE: The data set WORK.D_INV_EPIDEMIOLOGY has 3996 observations and 41 variables.
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 99.67 percent. 
      Compressed is 13 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

244       + PROC SQL;
244       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
244       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

244       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

244       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

244       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
245       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

245       +
PROC SQL;  
245       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
246       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
85                                          The SAS System             22:41 Saturday, January 6, 2024

INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
247       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_HIV'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS
248       + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

248       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
249       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_HIV'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

249       +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.04 seconds
      

249       +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

249       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

249       +
;  DATA    
250       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
251       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

86                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

251       +
PROC SQL;  
251       +
  DELETE FROM
252       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

252       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

252       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
253       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
254       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      253:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

254       +                                   PROC SQL;
254       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
255       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_HIV'
256       +    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
87                                          The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
257       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

257       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.07 seconds
      

257       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

257       +
PROC SORT DATA=D_INV_METADATA_OTH
258       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

258       +                           ;
258       +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
259       + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

259       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
260       + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
88                                          The SAS System             22:41 Saturday, January 6, 2024

||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
261       +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

261       +
PROC SQL;  
261       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
262       + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

262       +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

262       +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

262       +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
263       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
264       +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      263:219   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

264       +
89                                          The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
264       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
265       + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
266       + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_HIV'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
267       + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
268       + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

268       +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

268       +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

268       +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

268       +
;   DATA   
269       + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
270       + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
90                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

270       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
271       + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
272       +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

272       +
PROC SQL;  
272       +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
273       + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

273       +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

273       +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

273       +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
274       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
275       +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      274:219   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
91                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

275       +
PROC SQL;  
275       +
  CREATE TABLE D_INV_HIV AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
276       + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_HIV ON  &FACT_CASE .D_INV_HIV_KEY  =D_INV_HIV .D_INV_HIV_KEY
277       + WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART');
NOTE: Compressing data set WORK.D_INV_HIV increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_HIV created, with 3996 rows and 2 columns.

277       +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.00 seconds
      

277       +
;          
277       +
DATA D_INV_HIV; SET D_INV_HIV;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_HIV.
NOTE: The data set WORK.D_INV_HIV has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_HIV increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

279       + PROC SQL;
279       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
92                                          The SAS System             22:41 Saturday, January 6, 2024

      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
279       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

279       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

279       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

279       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
280       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

280       +
PROC SQL;  
280       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
281       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
282       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
283       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 7 rows and 5 columns.

283       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
284       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_PATIENT_OBS'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

284       +
 QUIT;     
93                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

284       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 9 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

284       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
285       + SORT_KEY;RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

285       +              ;
285       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
286       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 8 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

286       +
PROC SQL;  
287       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
94                                          The SAS System             22:41 Saturday, January 6, 2024

NOTE: 7 rows were deleted from WORK.DYNINVLISTING.

287       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

287       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
288       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
289       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      288:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

289       +                                                         PROC SQL;
289       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
290       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
291       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
292       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

292       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

292       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
293       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;
95                                          The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

293       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

293       +
;          
293       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
294       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
295       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

295       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
296       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
297       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

297       +               PROC SQL;
297       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
96                                          The SAS System             22:41 Saturday, January 6, 2024

(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

297       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

297       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

297       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
298       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
299       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      299:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

299       +
PROC SQL;  
299       +
  CREATE TABLE
300       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
301       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
302       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
97                                          The SAS System             22:41 Saturday, January 6, 2024

303       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

303       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

303       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
304       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

304       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

304       +                                                                           ;
304       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
305       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
306       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

306       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
307       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
98                                          The SAS System             22:41 Saturday, January 6, 2024

(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

307       +
PROC SQL;  
308       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

308       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

308       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

308       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
309       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
310       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      310:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

310       +
99                                          The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
310       +
  CREATE TABLE
311       + D_INV_PATIENT_OBS AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
312       + NBS_RDB. D_INV_PATIENT_OBS ON  &FACT_CASE .D_INV_PATIENT_OBS_KEY  =D_INV_PATIENT_OBS 
.D_INV_PATIENT_OBS_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_PATIENT_OBS;
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS decreased size by 99.52 percent. 
      Compressed is 19 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_PATIENT_OBS created, with 3996 rows and 8 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.70 seconds
      cpu time            0.01 seconds
      

313       + SET D_INV_PATIENT_OBS;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_PATIENT_OBS.
NOTE: The data set WORK.D_INV_PATIENT_OBS has 3996 observations and 8 variables.
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS decreased size by 99.52 percent. 
      Compressed is 19 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

314       + PROC SQL;
314       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
314       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

314       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

314       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
100                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

314       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
315       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

315       +
PROC SQL;  
315       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
316       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
317       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
318       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

318       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
319       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

319       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.09 seconds
      

319       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
101                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

319       +
PROC SORT DATA=D_INV_METADATA NODUPKEY
320       +; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

320       +                  ;
320       +                     DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
321       + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

321       +
  PROC     
322       + SQL;
322       +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

322       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

322       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
102                                         The SAS System             22:41 Saturday, January 6, 2024

323       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
324       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      323:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

324       +                                                         PROC SQL;
324       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
325       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
326       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL
327       + AND OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

327       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

327       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
328       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

328       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
103                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

328       +
;          
328       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
329       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
330       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

330       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
331       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
332       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

332       +               PROC SQL;
332       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

332       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

104                                         The SAS System             22:41 Saturday, January 6, 2024

332       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

332       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
333       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
334       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      334:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

334       +
PROC SQL;  
334       +
  CREATE TABLE
335       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
336       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=
337       +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
338       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

338       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

338       +
105                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
339       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

339       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

339       +                                                                           ;
339       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
340       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
341       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

341       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
342       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

342       +
PROC SQL;  
106                                         The SAS System             22:41 Saturday, January 6, 2024

343       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

343       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

343       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

343       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
344       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
345       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      345:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

345       +
PROC SQL;  
345       +
  CREATE TABLE
346       + D_INV_ISOLATE_TRACKING AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER
347       + JOIN  NBS_RDB. D_INV_ISOLATE_TRACKING ON  &FACT_CASE .D_INV_ISOLATE_TRACKING_KEY  
=D_INV_ISOLATE_TRACKING .D_INV_ISOLATE_TRACKING_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_ISOLATE_TRACKING created, with 3996 rows and 2 columns.
107                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

348       +  DATA D_INV_ISOLATE_TRACKING; SET D_INV_ISOLATE_TRACKING;  DROP _TEMA001 _TEMA002 
_TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_ISOLATE_TRACKING.
NOTE: The data set WORK.D_INV_ISOLATE_TRACKING has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

349       + PROC SQL;
349       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
349       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

349       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

349       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

349       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
350       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
108                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

350       +
PROC SQL;  
350       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
351       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
352       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
353       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.D_INV_METADATA created, with 43 rows and 5 columns.

353       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
354       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_LAB_FINDING'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

354       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

354       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 44 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 45 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

354       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
355       + SORT_KEY;RUN;

NOTE: There were 45 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 44 observations and 6 variables.
109                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

355       +              ;
355       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
356       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 44 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 44 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 88.64 percent. 
      Compressed is 5 pages; un-compressed would require 44 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

356       +
PROC SQL;  
357       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 43 rows were deleted from WORK.DYNINVLISTING.

357       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

357       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
358       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
359       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      358:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
110                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

359       +                                                         PROC SQL;
359       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
360       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
361       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
362       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

362       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

362       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
363       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

363       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

363       +
;          
363       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
364       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
111                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
365       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

365       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
366       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
367       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

367       +               PROC SQL;
367       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

367       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

367       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

367       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
368       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
112                                         The SAS System             22:41 Saturday, January 6, 2024

 IF
369       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      369:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

369       +
PROC SQL;  
369       +
  CREATE TABLE
370       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
371       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
372       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
373       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

373       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

373       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
374       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

374       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

113                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

374       +                                                                           ;
374       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
375       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
376       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

376       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
377       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

377       +
PROC SQL;  
378       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

378       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

114                                         The SAS System             22:41 Saturday, January 6, 2024

378       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

378       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
379       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
380       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      380:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

380       +
PROC SQL;  
380       +
  CREATE TABLE
381       + D_INV_LAB_FINDING AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
382       + NBS_RDB. D_INV_LAB_FINDING ON  &FACT_CASE .D_INV_LAB_FINDING_KEY  =D_INV_LAB_FINDING 
.D_INV_LAB_FINDING_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_LAB_FINDING;
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 99.47 percent. 
      Compressed is 21 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_LAB_FINDING created, with 3996 rows and 44 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.78 seconds
      cpu time            0.09 seconds
      

383       + SET D_INV_LAB_FINDING;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
115                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_LAB_FINDING.
NOTE: The data set WORK.D_INV_LAB_FINDING has 3996 observations and 44 variables.
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 99.47 percent. 
      Compressed is 21 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

384       + PROC SQL;
384       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
384       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

384       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

384       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

384       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
385       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

385       +
PROC SQL;  
385       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
386       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
387       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
116                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
388       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 9 rows and 5 columns.

388       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
389       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

389       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

389       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 11 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

389       +
PROC SORT DATA=D_INV_METADATA NODUPKEY;
390       + BY SORT_KEY;RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 10 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

390       +                 ;
390       +                    DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
391       + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
117                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 10 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 80.00 percent. 
      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

391       +
  PROC     
392       + SQL;
392       +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 9 rows were deleted from WORK.DYNINVLISTING.

392       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

392       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
393       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
394       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      393:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

394       +                                                         PROC SQL;
394       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
395       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
118                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
396       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
397       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

397       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

397       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
398       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

398       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

398       +
;          
398       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
399       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
400       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
119                                         The SAS System             22:41 Saturday, January 6, 2024

      

400       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
401       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
402       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

402       +               PROC SQL;
402       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

402       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

402       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

402       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
403       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
404       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      404:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
120                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

404       +
PROC SQL;  
404       +
  CREATE TABLE
405       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
406       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
407       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
408       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

408       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.01 seconds
      

408       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
409       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

409       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

409       +                                                                           ;
409       +                                                                               DATA 
121                                         The SAS System             22:41 Saturday, January 6, 2024

D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
410       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
411       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

411       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
412       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

412       +
PROC SQL;  
413       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

413       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

413       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

413       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
122                                         The SAS System             22:41 Saturday, January 6, 2024

414       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
415       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      415:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

415       +
PROC SQL;  
415       +
  CREATE TABLE
416       + D_INV_MEDICAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
417       +  NBS_RDB. D_INV_MEDICAL_HISTORY ON  &FACT_CASE .D_INV_MEDICAL_HISTORY_KEY  
=D_INV_MEDICAL_HISTORY .D_INV_MEDICAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 99.57 percent. 
      Compressed is 17 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_MEDICAL_HISTORY created, with 3996 rows and 10 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.72 seconds
      cpu time            0.07 seconds
      

418       + D_INV_MEDICAL_HISTORY; SET D_INV_MEDICAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_MEDICAL_HISTORY.
NOTE: The data set WORK.D_INV_MEDICAL_HISTORY has 3996 observations and 10 variables.
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 99.57 percent. 
      Compressed is 17 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
123                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

419       + PROC SQL;
419       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
419       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

419       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

419       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

419       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
420       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

420       +
PROC SQL;  
420       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
421       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
422       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
423       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

423       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
124                                         The SAS System             22:41 Saturday, January 6, 2024

424       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_MOTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

424       +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

424       +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

424       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

424       +
;  DATA    
425       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
426       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

426       +
PROC SQL;  
125                                         The SAS System             22:41 Saturday, January 6, 2024

426       +
  DELETE FROM
427       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

427       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

427       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
428       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
429       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      428:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

429       +                                   PROC SQL;
429       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
430       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
431       + RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
432       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

432       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      
126                                         The SAS System             22:41 Saturday, January 6, 2024


432       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

432       +
PROC SORT  
433       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

433       +                                                   ;
433       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
434       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

434       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
435       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
436       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
127                                         The SAS System             22:41 Saturday, January 6, 2024

      

436       +
PROC SQL;  
436       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
437       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

437       +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

437       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

437       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
438       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
439       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      439:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

439       +
PROC SQL;  
439       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
440       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
441       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_MOTHER'    AND 
128                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
442       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
443       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

443       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

443       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

443       +
PROC SORT DATA=D_INV_METADATA_UNIT
444       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

444       +                           ;
444       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
445       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

129                                         The SAS System             22:41 Saturday, January 6, 2024

445       +
DATA D_INV_METADATA_UNIT; SET
446       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
447       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

447       +
PROC SQL;  
447       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
448       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

448       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

448       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

448       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
449       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
450       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      450:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
130                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

450       +
PROC SQL;  
450       +
  CREATE TABLE D_INV_MOTHER AS   SELECT
451       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_MOTHER ON
452       + &FACT_CASE .D_INV_MOTHER_KEY  =D_INV_MOTHER .D_INV_MOTHER_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_MOTHER; SET D_INV_MOTHER;  DROP _TEMA001 _TEMA002 
_TEMA003
NOTE: Compressing data set WORK.D_INV_MOTHER decreased size by 98.00 percent. 
      Compressed is 10 pages; un-compressed would require 500 pages.
NOTE: Table WORK.D_INV_MOTHER created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

453       + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_MOTHER.
NOTE: The data set WORK.D_INV_MOTHER has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_MOTHER decreased size by 98.00 percent. 
      Compressed is 10 pages; un-compressed would require 500 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

454       + PROC SQL;
454       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
454       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

131                                         The SAS System             22:41 Saturday, January 6, 2024

454       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

454       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

454       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
455       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

455       +
PROC SQL;  
455       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
456       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
457       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_OTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
458       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 11 rows and 5 columns.

458       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
459       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_OTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

459       +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

459       +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

132                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 13 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

459       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 13 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 12 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

459       +
;  DATA    
460       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
461       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 12 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 83.33 percent. 
      Compressed is 2 pages; un-compressed would require 12 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

461       +
PROC SQL;  
461       +
  DELETE FROM
462       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 11 rows were deleted from WORK.DYNINVLISTING.

462       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
133                                         The SAS System             22:41 Saturday, January 6, 2024


462       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
463       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
464       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      463:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

464       +                                   PROC SQL;
464       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
465       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
466       + RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
467       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

467       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

467       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

134                                         The SAS System             22:41 Saturday, January 6, 2024

467       +
PROC SORT
468       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

468       +                                                   ;
468       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
469       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

469       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
470       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
471       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

471       +
PROC SQL;  
471       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
472       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

472       +                                     QUIT;
135                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

472       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

472       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
473       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
474       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      474:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

474       +
PROC SQL;  
474       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
475       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
476       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_OTHER'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
477       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
478       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

478       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
136                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

478       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

478       +
PROC SORT DATA=D_INV_METADATA_UNIT
479       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

479       +                           ;
479       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
480       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

480       +
DATA D_INV_METADATA_UNIT; SET
481       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
482       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
137                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

482       +
PROC SQL;  
482       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
483       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

483       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

483       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

483       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
484       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
485       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      485:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

485       +
PROC SQL;  
485       +
  CREATE TABLE D_INV_OTHER AS   SELECT
486       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
138                                         The SAS System             22:41 Saturday, January 6, 2024

=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_OTHER ON
487       + &FACT_CASE .D_INV_OTHER_KEY  =D_INV_OTHER .D_INV_OTHER_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_OTHER; SET D_INV_OTHER;  DROP _TEMA001 _TEMA002 
_TEMA003
NOTE: Compressing data set WORK.D_INV_OTHER decreased size by 99.37 percent. 
      Compressed is 25 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_OTHER created, with 3996 rows and 12 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.90 seconds
      cpu time            0.06 seconds
      

488       + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_OTHER.
NOTE: The data set WORK.D_INV_OTHER has 3996 observations and 12 variables.
NOTE: Compressing data set WORK.D_INV_OTHER decreased size by 99.37 percent. 
      Compressed is 25 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

489       + PROC SQL;
489       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
489       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

489       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

489       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

489       +
139                                         The SAS System             22:41 Saturday, January 6, 2024

DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
490       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

490       +
PROC SQL;  
490       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
491       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
492       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
493       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

493       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
494       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

494       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

494       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

140                                         The SAS System             22:41 Saturday, January 6, 2024

494       +
PROC SORT DATA=D_INV_METADATA NODUPKEY;
495       + BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

495       +                 ;
495       +                    DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
496       + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

496       +
  PROC     
497       + SQL;
497       +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

497       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

497       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
498       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
141                                         The SAS System             22:41 Saturday, January 6, 2024

499       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      498:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

499       +                                                         PROC SQL;
499       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
500       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
501       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
502       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

502       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

502       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
503       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

503       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
142                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

503       +
;          
503       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
504       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
505       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

505       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
506       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
507       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

507       +               PROC SQL;
507       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

507       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

507       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

143                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

507       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
508       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
509       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      509:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

509       +
PROC SQL;  
509       +
  CREATE TABLE
510       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
511       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
512       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
513       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

513       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

513       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
514       +       RUN;
144                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

514       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

514       +                                                                           ;
514       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
515       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
516       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

516       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
517       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

517       +
PROC SQL;  
518       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
145                                         The SAS System             22:41 Saturday, January 6, 2024

         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

518       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

518       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

518       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
519       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
520       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      520:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

520       +
PROC SQL;  
520       +
  CREATE TABLE
521       + D_INV_PREGNANCY_BIRTH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
522       +  NBS_RDB. D_INV_PREGNANCY_BIRTH ON  &FACT_CASE .D_INV_PREGNANCY_BIRTH_KEY  
=D_INV_PREGNANCY_BIRTH .D_INV_PREGNANCY_BIRTH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH decreased size by 98.60 percent. 
      Compressed is 7 pages; un-compressed would require 500 pages.
NOTE: Table WORK.D_INV_PREGNANCY_BIRTH created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
146                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

523       + D_INV_PREGNANCY_BIRTH; SET D_INV_PREGNANCY_BIRTH;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_PREGNANCY_BIRTH.
NOTE: The data set WORK.D_INV_PREGNANCY_BIRTH has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH decreased size by 98.60 percent. 
      Compressed is 7 pages; un-compressed would require 500 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

524       + PROC SQL;
524       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
524       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

524       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

524       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

524       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
525       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

147                                         The SAS System             22:41 Saturday, January 6, 2024

525       +
PROC SQL;
525       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
526       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
527       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
528       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

528       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
529       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_RESIDENCY'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

529       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

529       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

529       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
530       + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
148                                         The SAS System             22:41 Saturday, January 6, 2024

      

530       +              ;
530       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
531       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

531       +
PROC SQL;  
532       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

532       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

532       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
533       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
534       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      533:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

149                                         The SAS System             22:41 Saturday, January 6, 2024

534       +                                                         PROC SQL;
534       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
535       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
536       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
537       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

537       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

537       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
538       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

538       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

538       +
;          
538       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
539       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
540       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
150                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

540       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
541       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
542       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

542       +               PROC SQL;
542       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

542       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

542       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

542       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
543       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
544       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

151                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      544:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

544       +
PROC SQL;  
544       +
  CREATE TABLE
545       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
546       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
547       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
548       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

548       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

548       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
549       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

549       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
152                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

549       +                                                                           ;
549       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
550       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
551       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

551       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
552       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

552       +
PROC SQL;  
553       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

553       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

553       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
153                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

553       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
554       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
555       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      555:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

555       +
PROC SQL;  
555       +
  CREATE TABLE
556       + D_INV_RESIDENCY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
557       + NBS_RDB. D_INV_RESIDENCY ON  &FACT_CASE .D_INV_RESIDENCY_KEY  =D_INV_RESIDENCY 
.D_INV_RESIDENCY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_RESIDENCY; SET
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_RESIDENCY created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

558       + D_INV_RESIDENCY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_RESIDENCY.
154                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_RESIDENCY has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

560       + PROC SQL;
560       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
560       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

560       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

560       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

560       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
561       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

561       +
PROC SQL;  
561       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
562       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
563       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
564       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
155                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 10 rows and 5 columns.

564       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
565       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_RISK_FACTOR'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

565       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

565       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 12 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

565       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
566       + SORT_KEY;RUN;

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 11 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

566       +              ;
566       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
567       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 11 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 81.82 percent. 
156                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

567       +
PROC SQL;  
568       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 10 rows were deleted from WORK.DYNINVLISTING.

568       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

568       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
569       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
570       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      569:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

570       +                                                         PROC SQL;
570       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
571       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
572       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
573       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.
157                                         The SAS System             22:41 Saturday, January 6, 2024


573       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.06 seconds
      

573       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
574       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

574       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

574       +
;          
574       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
575       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
576       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

576       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
577       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
158                                         The SAS System             22:41 Saturday, January 6, 2024

578       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

578       +               PROC SQL;
578       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

578       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

578       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

578       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
579       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
580       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      580:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

580       +
PROC SQL;  
159                                         The SAS System             22:41 Saturday, January 6, 2024

580       +
  CREATE TABLE
581       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
582       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
583       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
584       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

584       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.06 seconds
      

584       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
585       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

585       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

585       +                                                                           ;
585       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
586       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
587       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
160                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

587       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
588       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

588       +
PROC SQL;  
589       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

589       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

589       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

589       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
590       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
591       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
161                                         The SAS System             22:41 Saturday, January 6, 2024

      591:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

591       +
PROC SQL;  
591       +
  CREATE TABLE
592       + D_INV_RISK_FACTOR AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
593       + NBS_RDB. D_INV_RISK_FACTOR ON  &FACT_CASE .D_INV_RISK_FACTOR_KEY  =D_INV_RISK_FACTOR 
.D_INV_RISK_FACTOR_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_RISK_FACTOR;
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 99.62 percent. 
      Compressed is 15 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_RISK_FACTOR created, with 3996 rows and 11 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.95 seconds
      cpu time            0.04 seconds
      

594       + SET D_INV_RISK_FACTOR;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_RISK_FACTOR.
NOTE: The data set WORK.D_INV_RISK_FACTOR has 3996 observations and 11 variables.
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 99.62 percent. 
      Compressed is 15 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

595       + PROC SQL;
595       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
162                                         The SAS System             22:41 Saturday, January 6, 2024

595       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

595       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

595       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

595       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
596       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

596       +
PROC SQL;  
596       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
597       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
598       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
599       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

599       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
600       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

600       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      
163                                         The SAS System             22:41 Saturday, January 6, 2024


600       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

600       +
PROC SORT DATA=D_INV_METADATA NODUPKEY;
601       + BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

601       +                 ;
601       +                    DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
602       + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

602       +
  PROC     
603       + SQL;
603       +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.
164                                         The SAS System             22:41 Saturday, January 6, 2024


603       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

603       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
604       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
605       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      604:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

605       +                                                         PROC SQL;
605       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
606       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
607       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
608       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

608       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

608       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
609       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

165                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

609       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

609       +
;          
609       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
610       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
611       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

611       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
612       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
613       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

613       +               PROC SQL;
613       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
166                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

613       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

613       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

613       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
614       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
615       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      615:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

615       +
PROC SQL;  
615       +
  CREATE TABLE
616       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
617       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
618       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
619       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
167                                         The SAS System             22:41 Saturday, January 6, 2024

IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

619       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

619       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
620       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

620       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

620       +                                                                           ;
620       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
621       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
622       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

622       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
623       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
168                                         The SAS System             22:41 Saturday, January 6, 2024

|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

623       +
PROC SQL;  
624       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

624       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

624       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

624       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
625       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
626       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      626:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

626       +
PROC SQL;  
169                                         The SAS System             22:41 Saturday, January 6, 2024

626       +
  CREATE TABLE
627       + D_INV_SOCIAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
628       + NBS_RDB. D_INV_SOCIAL_HISTORY ON  &FACT_CASE .D_INV_SOCIAL_HISTORY_KEY  
=D_INV_SOCIAL_HISTORY .D_INV_SOCIAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_SOCIAL_HISTORY created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      

629       + D_INV_SOCIAL_HISTORY; SET D_INV_SOCIAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_SOCIAL_HISTORY.
NOTE: The data set WORK.D_INV_SOCIAL_HISTORY has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

630       + PROC SQL;
630       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
630       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

630       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

630       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
170                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

630       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
631       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

631       +
PROC SQL;  
631       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
632       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
633       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SYMPTOM'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
634       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 6 rows and 5 columns.

634       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
635       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_SYMPTOM'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

635       +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

635       +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
171                                         The SAS System             22:41 Saturday, January 6, 2024


635       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

635       +
;  DATA    
636       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
637       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 7 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 71.43 percent. 
      Compressed is 2 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

637       +
PROC SQL;  
637       +
  DELETE FROM
638       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 6 rows were deleted from WORK.DYNINVLISTING.

638       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

638       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
639       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
640       + COMPBL(TRIMMED_VALUE));   RUN;
172                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      639:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

640       +                                   PROC SQL;
640       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
641       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
642       + RDB_TABLE_NM='D_INV_SYMPTOM'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
643       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

643       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

643       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

643       +
PROC SORT  
644       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
173                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

644       +                                                   ;
644       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
645       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

645       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
646       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
647       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

647       +
PROC SQL;  
647       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
648       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

648       +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

648       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

174                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

648       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
649       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
650       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      650:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

650       +
PROC SQL;  
650       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
651       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
652       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_SYMPTOM'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
653       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
654       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

654       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

654       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
175                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

654       +
PROC SORT DATA=D_INV_METADATA_UNIT
655       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

655       +                           ;
655       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
656       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

656       +
DATA D_INV_METADATA_UNIT; SET
657       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
658       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

658       +
PROC SQL;  
658       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
176                                         The SAS System             22:41 Saturday, January 6, 2024

659       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

659       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

659       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

659       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
660       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
661       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      661:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

661       +
PROC SQL;  
661       +
  CREATE TABLE D_INV_SYMPTOM AS   SELECT
662       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_SYMPTOM ON
663       + &FACT_CASE .D_INV_SYMPTOM_KEY  =D_INV_SYMPTOM .D_INV_SYMPTOM_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_SYMPTOM; SET D_INV_SYMPTOM;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_SYMPTOM decreased size by 99.62 percent. 
      Compressed is 15 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_SYMPTOM created, with 3996 rows and 7 columns.

177                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.97 seconds
      cpu time            0.07 seconds
      

664       + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_SYMPTOM.
NOTE: The data set WORK.D_INV_SYMPTOM has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.D_INV_SYMPTOM decreased size by 99.62 percent. 
      Compressed is 15 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

665       + PROC SQL;
665       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
665       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

665       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

665       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

665       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
666       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
178                                         The SAS System             22:41 Saturday, January 6, 2024


666       +
PROC SQL;  
666       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
667       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
668       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
669       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

669       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
670       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_TREATMENT'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

670       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.04 seconds
      

670       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

670       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
671       + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
179                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

671       +              ;
671       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
672       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

672       +
PROC SQL;  
673       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

673       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

673       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
674       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
675       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      674:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
180                                         The SAS System             22:41 Saturday, January 6, 2024


675       +                                                         PROC SQL;
675       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
676       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
677       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
678       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

678       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.01 seconds
      

678       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
679       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

679       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

679       +
;          
679       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
680       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
681       + RDB_COLUMN_NM2; RUN;

181                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

681       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
682       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
683       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

683       +               PROC SQL;
683       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

683       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

683       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

683       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
684       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
685       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;
182                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      685:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

685       +
PROC SQL;  
685       +
  CREATE TABLE
686       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
687       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
688       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
689       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

689       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

689       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
690       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

690       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
183                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

690       +                                                                           ;
690       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
691       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
692       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

692       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
693       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

693       +
PROC SQL;  
694       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

694       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

694       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
184                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

694       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
695       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
696       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      696:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

696       +
PROC SQL;  
696       +
  CREATE TABLE
697       + D_INV_TREATMENT AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
698       + NBS_RDB. D_INV_TREATMENT ON  &FACT_CASE .D_INV_TREATMENT_KEY  =D_INV_TREATMENT 
.D_INV_TREATMENT_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_TREATMENT; SET
NOTE: Compressing data set WORK.D_INV_TREATMENT increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_TREATMENT created, with 3996 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.04 seconds
      

699       + D_INV_TREATMENT;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
185                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 3996 observations read from the data set WORK.D_INV_TREATMENT.
NOTE: The data set WORK.D_INV_TREATMENT has 3996 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_TREATMENT increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

700       + PROC SQL;
700       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
700       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

700       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

700       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

700       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
701       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

701       +
PROC SQL;  
701       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
702       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
703       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR
704       + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
186                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 8 rows and 5 columns.

704       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
705       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_TRAVEL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

705       +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

705       +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 10 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

705       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 9 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

705       +
;  DATA    
706       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
707       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 9 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
187                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

707       +
PROC SQL;  
707       +
  DELETE FROM
708       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 8 rows were deleted from WORK.DYNINVLISTING.

708       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

708       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
709       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
710       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      709:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

710       +                                   PROC SQL;
710       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
711       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
712       + RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
713       + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

188                                         The SAS System             22:41 Saturday, January 6, 2024

713       +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.06 seconds
      

713       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

713       +
PROC SORT  
714       + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

714       +                                                   ;
714       +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
715       + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

715       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
716       + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
717       +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;
189                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

717       +
PROC SQL;  
717       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
718       + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

718       +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

718       +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

718       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
719       +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
720       + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      720:9    2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

720       +
PROC SQL;  
720       +
190                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
721       + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
722       + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_TRAVEL'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
723       + DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
724       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

724       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

724       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

724       +
PROC SORT DATA=D_INV_METADATA_UNIT
725       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

725       +                           ;
725       +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
726       + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
191                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

726       +
DATA D_INV_METADATA_UNIT; SET
727       + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
728       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

728       +
PROC SQL;  
728       +
  DELETE FROM D_INV_METADATA_UNIT WHERE
729       + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

729       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

729       +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

729       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
730       + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
731       +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;
192                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      731:25   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

731       +
PROC SQL;  
731       +
  CREATE TABLE D_INV_TRAVEL AS   SELECT
732       + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_TRAVEL ON
733       + &FACT_CASE .D_INV_TRAVEL_KEY  =D_INV_TRAVEL .D_INV_TRAVEL_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_TRAVEL; SET D_INV_TRAVEL;  DROP _TEMA001 _TEMA002 
_TEMA003
NOTE: Compressing data set WORK.D_INV_TRAVEL decreased size by 99.60 percent. 
      Compressed is 16 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_TRAVEL created, with 3996 rows and 9 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.57 seconds
      cpu time            0.04 seconds
      

734       + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_TRAVEL.
NOTE: The data set WORK.D_INV_TRAVEL has 3996 observations and 9 variables.
NOTE: Compressing data set WORK.D_INV_TRAVEL decreased size by 99.60 percent. 
      Compressed is 16 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

735       + PROC SQL;
735       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
193                                         The SAS System             22:41 Saturday, January 6, 2024

      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
735       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

735       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

735       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

735       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
736       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

736       +
PROC SQL;  
736       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
737       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
738       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
739       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 7 rows and 5 columns.

739       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
740       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_UNDER_CONDITION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

740       +
 QUIT;     
194                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

740       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 9 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

740       +
PROC SORT DATA=D_INV_METADATA NODUPKEY;
741       + BY SORT_KEY;RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

741       +                 ;
741       +                    DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM)
742       + || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 8 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

742       +
  PROC     
743       + SQL;
743       +       DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
195                                         The SAS System             22:41 Saturday, January 6, 2024

DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 7 rows were deleted from WORK.DYNINVLISTING.

743       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

743       +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
744       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
745       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      744:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

745       +                                                         PROC SQL;
745       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
746       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
747       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
748       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

748       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

196                                         The SAS System             22:41 Saturday, January 6, 2024

748       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
749       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

749       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

749       +
;          
749       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
750       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
751       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

751       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
752       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
753       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
197                                         The SAS System             22:41 Saturday, January 6, 2024


753       +               PROC SQL;
753       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

753       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

753       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

753       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
754       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
755       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      755:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

755       +
PROC SQL;  
755       +
  CREATE TABLE
756       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
757       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
198                                         The SAS System             22:41 Saturday, January 6, 2024

758       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
759       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

759       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

759       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
760       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

760       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

760       +                                                                           ;
760       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
761       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
762       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

762       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
199                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
763       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

763       +
PROC SQL;  
764       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

764       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

764       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

764       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
765       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
766       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      766:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
200                                         The SAS System             22:41 Saturday, January 6, 2024

      

766       +
PROC SQL;  
766       +
  CREATE TABLE
767       + D_INV_UNDER_CONDITION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
768       +  NBS_RDB. D_INV_UNDER_CONDITION ON  &FACT_CASE .D_INV_UNDER_CONDITION_KEY  
=D_INV_UNDER_CONDITION .D_INV_UNDER_CONDITION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION decreased size by 99.55 percent. 
      Compressed is 18 pages; un-compressed would require 3996 pages.
NOTE: Table WORK.D_INV_UNDER_CONDITION created, with 3996 rows and 8 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.59 seconds
      cpu time            0.06 seconds
      

769       + D_INV_UNDER_CONDITION; SET D_INV_UNDER_CONDITION;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_UNDER_CONDITION.
NOTE: The data set WORK.D_INV_UNDER_CONDITION has 3996 observations and 8 variables.
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION decreased size by 99.55 percent. 
      Compressed is 18 pages; un-compressed would require 3996 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

770       + PROC SQL;
770       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
770       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

770       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

201                                         The SAS System             22:41 Saturday, January 6, 2024

770       +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

770       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
771       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

771       +
PROC SQL;  
771       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
772       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
773       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
774       + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 6 rows and 5 columns.

774       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
775       + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART'),  
RDB_TABLE_NM='D_INV_VACCINATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

775       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

775       +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
202                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

775       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
776       + SORT_KEY;RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

776       +              ;
776       +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
777       + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 7 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 71.43 percent. 
      Compressed is 2 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

777       +
PROC SQL;  
778       + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 6 rows were deleted from WORK.DYNINVLISTING.

778       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

778       +
203                                         The SAS System             22:41 Saturday, January 6, 2024

DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
779       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
780       + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      779:221   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

780       +                                                         PROC SQL;
780       +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
781       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
782       + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
783       + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

783       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

783       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
784       + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

784       +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;
204                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

784       +
;          
784       +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
785       + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
786       + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

786       +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
787       +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
788       + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

788       +               PROC SQL;
788       +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

788       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
205                                         The SAS System             22:41 Saturday, January 6, 2024

      

788       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

788       +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
789       + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
790       +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      790:60   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

790       +
PROC SQL;  
790       +
  CREATE TABLE
791       + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
792       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
793       + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
794       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

794       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      
206                                         The SAS System             22:41 Saturday, January 6, 2024


794       +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
795       +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

795       +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

795       +                                                                           ;
795       +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
796       +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
797       +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

797       +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
798       + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

207                                         The SAS System             22:41 Saturday, January 6, 2024

798       +
PROC SQL;
799       + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

799       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

799       +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

799       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
800       + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
801       + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      801:50   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

801       +
PROC SQL;  
801       +
  CREATE TABLE
802       + D_INV_VACCINATION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
803       + NBS_RDB. D_INV_VACCINATION ON  &FACT_CASE .D_INV_VACCINATION_KEY  =D_INV_VACCINATION 
.D_INV_VACCINATION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART'); ;QUIT;;    DATA D_INV_VACCINATION;
NOTE: Compressing data set WORK.D_INV_VACCINATION decreased size by 99.30 percent. 
208                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 14 pages; un-compressed would require 1999 pages.
NOTE: Table WORK.D_INV_VACCINATION created, with 3996 rows and 7 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.54 seconds
      cpu time            0.03 seconds
      

804       + SET D_INV_VACCINATION;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3996 observations read from the data set WORK.D_INV_VACCINATION.
NOTE: The data set WORK.D_INV_VACCINATION has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.D_INV_VACCINATION decreased size by 99.30 percent. 
      Compressed is 14 pages; un-compressed would require 1999 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

805       + PROC SQL;
805       +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
805       +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

805       +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

805       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

805       +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
806       +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
209                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

806       +
PROC SQL;  
806       +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
807       + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
808       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_STD'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS
809       + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

809       +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
810       + WHERE DATAMART_NM='HAV_DATAMART'),  RDB_TABLE_NM='D_INV_STD'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

810       +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

810       +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

810       +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
210                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

810       +
;  DATA    
811       + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
812       +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

812       +
PROC SQL;  
812       +
  DELETE FROM
813       + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

813       +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

813       +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
814       + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
815       + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      814:200   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
211                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

815       +                                   PROC SQL;
815       +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
816       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_STD'
817       +    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
818       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

818       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

818       +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

818       +
PROC SORT DATA=D_INV_METADATA_OTH
819       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

819       +                           ;
819       +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
820       + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

212                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

820       +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
821       + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
822       +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

822       +
PROC SQL;  
822       +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
823       + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

823       +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

823       +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

823       +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
824       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
825       +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

213                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      824:219   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

825       +
PROC SQL;  
825       +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
826       + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
827       + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_STD'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND
828       + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
829       + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

829       +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

829       +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

829       +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
214                                         The SAS System             22:41 Saturday, January 6, 2024


829       +
;   DATA   
830       + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
831       + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

831       +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
832       + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
833       +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

833       +
PROC SQL;  
833       +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
834       + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

834       +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

834       +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

215                                         The SAS System             22:41 Saturday, January 6, 2024

834       +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
835       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
836       +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      835:219   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

836       +
PROC SQL;  
836       +
       CREATE TABLE D_INV_STD AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
837       + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART;
NOTE: Compressing data set WORK.D_INV_STD increased size by 41.18 percent. 
      Compressed is 24 pages; un-compressed would require 17 pages.
NOTE: Table WORK.D_INV_STD created, with 3997 rows and 2 columns.

837       +                                                             ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

837       +                                                                   ;
837       +                                                                        DATA D_INV_STD; 
SET D_INV_STD;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

NOTE: Compression was disabled for data set WORK.D_INV_STD because compression overhead would 
      increase the size of the data set.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3997 observations read from the data set WORK.D_INV_STD.
NOTE: The data set WORK.D_INV_STD has 3997 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
216                                         The SAS System             22:41 Saturday, January 6, 2024


839       + PROC SQL;
839       +           CREATE TABLE ORGANIZATION_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
840       + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' 
and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND
841       + PART_TYPE_CD IS NOT NULL AND RDB_TABLE_NM ='D_ORGANIZATION' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.ORGANIZATION_METADATA created, with 2 rows and 3 columns.

841       +                                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

841       +                                                                                         
DATA ORGANIZATION_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET ORGANIZATION_METADATA;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

841       +
PROC SORT DATA=ORGANIZATION_METADATA
842       + NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

842       +                           ;
842       +                             PROC SQL;
842       +                                       CREATE TABLE ORGANIZATION  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.ORGANIZATION because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.ORGANIZATION created, with 0 rows and 1 columns.
842       +                                                                                           
QUIT;
217                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

842       +
DATA ORGANIZATION_METADATA;   SET ORGANIZATION_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF 
FIRST.SORT_KEY THEN  IF part_type_cd= 'FldFupFacilityOfPHC'
843       + THEN PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
844       + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY';    KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY';  DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1,
845       + INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL';  QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 
1, INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC';  UID= USER_DEFINED_COLUMN_NM;  call 
execute('%POPULATE_ORGANIZATION('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||
846       + KEY||','||  DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      845:234   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 9 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
2         + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
3         + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
HOSPITAL_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
4         + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
HOSPITAL_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 83.58 percent. 
      Compressed is 22 pages; un-compressed would require 134 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 3996 rows and 15 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
218                                         The SAS System             22:41 Saturday, January 6, 2024

      

4         +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH HSP_DETAIL  $2000;   IF
5         + ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; HSP_KEY=ORGANIZATION_KEY; HSP_QEC 
=ORGANIZATION_QUICK_CODE; HSP_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN 
CITY_STATE_ZIP =PROPCASE(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM
6         +(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || TRIM(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM
7         +(ORGANIZATION_LOCAL_ID))>0 THEN HSP_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN HSP_DETAIL =TRIM(HSP_DETAIL) ||'<br>' || 
PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN
8         + HSP_DETAIL=  TRIM(HSP_DETAIL) ||'<br>' ||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); 
IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0 then HSP_DETAIL=  TRIM(HSP_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM
9         +(CITY_STATE_ZIP))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ; 
IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || 
PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0
10        + then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
HSP_DETAIL= TRIM(HSP_DETAIL)|| ', ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK)
11        +; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br> ext. ' || 
TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(HSP_DETAIL))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)||
12        + '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME ORGANIZATION_STREET_ADDRESS_1 
ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  
ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP ORGANIZATION_CITY
13        + ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE HOSPITAL_KEY;  RUN;

NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 3996 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 95.80 percent. 
      Compressed is 24 pages; un-compressed would require 571 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

13        +                                                                                    PROC 
SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 3996 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 95.80 percent. 
      Compressed is 24 pages; un-compressed would require 571 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

13        +
DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;
219                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 3996 observations and 6 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 95.80 percent. 
      Compressed is 24 pages; un-compressed would require 571 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

14        + PROC SQL;
14        +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
15        + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
16        + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
ORG_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
17        + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
ORG_AS_REPORTER_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 77.61 percent. 
      Compressed is 30 pages; un-compressed would require 134 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 3996 rows and 15 columns.

17        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.36 seconds
      cpu time            0.04 seconds
      

17        +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH REPORTING_FACILITY_DETAIL  
$2000;
18        +   IF   ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; 
REPORTING_FACILITY_KEY=ORGANIZATION_KEY; REPORTING_FACILITY_QEC =ORGANIZATION_QUICK_CODE; 
REPORTING_FACILITY_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN CITY_STATE_ZIP 
=PROPCASE
19        +(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF 
LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || TRIM
20        +(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM(ORGANIZATION_LOCAL_ID))>0 THEN 
REPORTING_FACILITY_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN REPORTING_FACILITY_DETAIL =TRIM(REPORTING_FACILITY_DETAIL) 
||'<br>' ||
21        + PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN 
REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) ||'<br>' 
||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0
22        + then REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 then 
220                                         The SAS System             22:41 Saturday, January 6, 2024

REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM
23        +(CITY_STATE_ZIP) ; IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 then REPORTING_FACILITY_DETAIL= TRIM
24        +(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| ', ext. ' || TRIM
25        +(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br> ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN
26        +(TRIM(REPORTING_FACILITY_DETAIL))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME 
ORGANIZATION_STREET_ADDRESS_1 ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY
27        + ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP 
ORGANIZATION_CITY ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE ORG_AS_REPORTER_KEY;  
RUN;

NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 3996 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 94.22 percent. 
      Compressed is 33 pages; un-compressed would require 571 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

27        +
PROC SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY
28        +;RUN;

NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 3996 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 94.22 percent. 
      Compressed is 33 pages; un-compressed would require 571 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

28        +       DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 3996 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 3996 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 3996 observations and 10 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 96.32 percent. 
      Compressed is 49 pages; un-compressed would require 1332 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

847       + PROC SQL;
847       +           CREATE TABLE PROVIDER_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
221                                         The SAS System             22:41 Saturday, January 6, 2024

user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
848       + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' 
and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND
849       + PART_TYPE_CD IS NOT NULL AND RDB_TABLE_NM ='D_PROVIDER' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PROVIDER_METADATA created, with 3 rows and 3 columns.

849       +                                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      

849       +                                                                                     DATA 
PROVIDER_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PROVIDER_METADATA;    SORT_KEY+1;  OUTPUT;      
 RUN;

NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 4 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

849       +
PROC SORT DATA=PROVIDER_METADATA NODUPKEY; BY SORT_KEY
850       +;RUN;

NOTE: There were 4 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

850       +     ;
850       +       PROC SQL;
850       +                 CREATE TABLE PROVIDER  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.PROVIDER because compression overhead would increase 
      the size of the data set.
NOTE: Table WORK.PROVIDER created, with 0 rows and 1 columns.
850       +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
222                                         The SAS System             22:41 Saturday, January 6, 2024


850       +                                                                        DATA 
PROVIDER_METADATA;   SET PROVIDER_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF FIRST.SORT_KEY 
THEN  IF part_type_cd= 'CASupervisorOfPHC' THEN
851       + PART_TYPE_CD='SUPRVSR_OF_CASE_ASSGNMENT_KEY';  IF part_type_cd= 'ClosureInvestgrOfPHC' 
THEN PART_TYPE_CD='CLOSED_BY_KEY';  IF part_type_cd= 'DispoFldFupInvestgrOfPHC' THEN 
PART_TYPE_CD='DISPOSITIONED_BY_KEY';  IF part_type_cd= 'FldFupInvestgrOfPHC' THEN
852       + PART_TYPE_CD='INVSTGTR_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupProvOfPHC' THEN 
PART_TYPE_CD='PROVIDER_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupSupervisorOfPHC' THEN 
PART_TYPE_CD='SUPRVSR_OF_FLD_FOLLOW_UP_KEY';  IF part_type_cd=
853       + 'InitFldFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_ASGNED_FLD_FOLLOW_UP_KEY';  IF 
part_type_cd= 'InitFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_FOLLOW_UP_INVSTGTR_KEY';  IF 
part_type_cd= 'InitInterviewerOfPHC' THEN
854       + PART_TYPE_CD='INIT_ASGNED_INTERVIEWER_KEY';  IF part_type_cd= 'InterviewerOfPHC' THEN 
PART_TYPE_CD='INTERVIEWER_ASSIGNED_KEY';  IF part_type_cd= 'InvestgrOfPHC' THEN 
PART_TYPE_CD='INVESTIGATOR_KEY';  IF part_type_cd= 'PerAsProviderOfDelivery' THEN
855       + PART_TYPE_CD='DELIVERING_MD_KEY';  IF part_type_cd= 'PerAsProviderOfOBGYN' THEN 
PART_TYPE_CD='MOTHER_OB_GYN_KEY';  IF part_type_cd= 'PerAsProvideroOfPediatrics' THEN 
PART_TYPE_CD='PEDIATRICIAN_KEY';  IF part_type_cd= 'PerAsReporterOfPHC' THEN
856       + PART_TYPE_CD='PERSON_AS_REPORTER_KEY';  IF part_type_cd= 'PhysicianOfPHC' THEN 
PART_TYPE_CD='PHYSICIAN_KEY';  IF part_type_cd= 'SurvInvestgrOfPHC' THEN 
PART_TYPE_CD='SURVEILLANCE_INVESTIGATOR_KEY';  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
857       + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
858       + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY'; KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY'; DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, INDEX
859       +(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL'; QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC'; UID = USER_DEFINED_COLUMN_NM; call 
execute('%POPULATE_PROVIDER('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||  KEY||','||
860       + DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      859:222   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 9 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
2         + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
223                                         The SAS System             22:41 Saturday, January 6, 2024

3         + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
INVESTIGATOR_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON
4         + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . INVESTIGATOR_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 81.52 percent. 
      Compressed is 39 pages; un-compressed would require 211 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 3996 rows and 20 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.06 seconds
      

4         +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
5         + PHC_INV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  PHC_INV_KEY=PROVIDER_KEY;  PHC_INV_QEC =PROVIDER_QUICK_CODE;  
PHC_INV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
6         + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
7         +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
8         +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
9         + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
10        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
11        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
12        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN PHC_INV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHC_INV_DETAIL 
=TRIM(PHC_INV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
13        + PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
14        +(TRIM(CITY_STATE_ZIP))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHC_INV_DETAIL= 
TRIM(PHC_INV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
15        +(PROVIDER_PHONE_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| ', ext. ' || TRIM
16        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
224                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHC_INV_DETAIL))>0 then
17        + PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
18        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE INVESTIGATOR_KEY;  RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 92.31 percent. 
      Compressed is 44 pages; un-compressed would require 572 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

18        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 92.31 percent. 
      Compressed is 44 pages; un-compressed would require 572 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

18        +
  DATA     
19        + PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 92.31 percent. 
      Compressed is 44 pages; un-compressed would require 572 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

20        + PROC SQL;
20        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
21        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
22        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
225                                         The SAS System             22:41 Saturday, January 6, 2024

PHYSICIAN_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON
23        + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PHYSICIAN_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 84.83 percent. 
      Compressed is 32 pages; un-compressed would require 211 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 3996 rows and 20 columns.

23        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.03 seconds
      

23        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH PHYS_DETAIL
24        + $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN PROVIDER_KEY=.;  
PHYS_KEY=PROVIDER_KEY;  PHYS_QEC =PROVIDER_QUICK_CODE;  PHYS_UID=PROVIDER_UID;   IF 
LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP =PROPCASE(TRIM(PROVIDER_CITY));
25        + IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE(TRIM(PROVIDER_ZIP)) ;
26        + PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF LENGTHN(TRIM(PROVIDER_NAME))>0 
AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| 
PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0
27        + AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM
28        +(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME
29        + =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN
30        +(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| 
TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE 
))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If LENGTHN(TRIM
31        +(PROVIDER_LOCAL_ID))>0 THEN PHYS_DETAIL ='<b></b>' ||TRIM(PROVIDER_LOCAL_ID);  If 
LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHYS_DETAIL =TRIM(PHYS_DETAIL) ||'<br>' || PROVIDER_NAME;  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN PHYS_DETAIL=  TRIM
32        +(PHYS_DETAIL) ||'<br>' ||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN PHYS_DETAIL=  TRIM(PHYS_DETAIL) || '<br>' || 
PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 THEN
33        + PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ;  IF 
LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || 
PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 THEN PHYS_DETAIL= TRIM
34        +(PHYS_DETAIL)|| '<br>' || TRIM(PROVIDER_PHONE_WORK) ;  IF 
LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| ', ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM
35        +(PROVIDER_PHONE_WORK))=0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| '<br> ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHYS_DETAIL))>0 
then PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>';     DROP
36        + PROVIDER_NAME PROVIDER_FIRST_NAME PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME 
226                                         The SAS System             22:41 Saturday, January 6, 2024

PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK    PROVIDER_STREET_ADDRESS_1 
PROVIDER_STREET_ADDRESS_2 PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY
37        + PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE 
PROVIDER_QUICK_CODE PHYSICIAN_KEY;  RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.36 percent. 
      Compressed is 38 pages; un-compressed would require 572 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

37        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.36 percent. 
      Compressed is 38 pages; un-compressed would require 572 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

37        +
DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY
38        + INVESTIGATION_KEY; RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 3996 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 3996 observations and 11 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 94.67 percent. 
      Compressed is 71 pages; un-compressed would require 1332 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

39        + PROC SQL;
39        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
40        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
41        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PERSON_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART INNER JOIN  NBS_RDB. F_PAGE_CASE
42        + ON SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
227                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PERSON_AS_REPORTER_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 91.47 percent. 
      Compressed is 18 pages; un-compressed would require 211 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 3996 rows and 20 columns.

42        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.39 seconds
      cpu time            0.03 seconds
      

42        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
43        + RPT_PRV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  RPT_PRV_KEY=PROVIDER_KEY;  RPT_PRV_QEC =PROVIDER_QUICK_CODE;  
RPT_PRV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
44        + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
45        +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
46        +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
47        + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
48        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
49        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
50        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN RPT_PRV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN RPT_PRV_DETAIL 
=TRIM(RPT_PRV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
51        + RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
52        +(TRIM(CITY_STATE_ZIP))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN RPT_PRV_DETAIL= 
TRIM(RPT_PRV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
53        +(PROVIDER_PHONE_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| ', ext. ' || TRIM
54        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(RPT_PRV_DETAIL))>0 then
55        + RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
228                                         The SAS System             22:41 Saturday, January 6, 2024

56        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE PERSON_AS_REPORTER_KEY;  RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 96.33 percent. 
      Compressed is 21 pages; un-compressed would require 572 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

56        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 3996 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 96.33 percent. 
      Compressed is 21 pages; un-compressed would require 572 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

57        + DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 3996 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 3996 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 3996 observations and 15 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 95.85 percent. 
      Compressed is 83 pages; un-compressed would require 1998 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

861       + PROC SQL;
861       +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
862       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
863       + DATAMART_NM='HAV_DATAMART') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and 
(code_set_group_id >0  OR data_type in ( 'Coded'
864       + ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_INIT created, with 6 rows and 5 columns.

864       +                                                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
229                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.14 seconds
      cpu time            0.06 seconds
      

864       +                                                                  PROC SQL;
864       +                                                                            CREATE TABLE 
METADATA_UNIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM, 
NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM, OTHER_VALUE_IND_CD FROM
865       + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =
866       +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL 
AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR
867       + data_type in ( 'Coded','CODED') ) AND OTHER_VALUE_IND_CD='T' ORDER BY RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_UNIT created, with 0 rows and 6 columns.

867       +                                                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

867       +
DATA METADATA_UNIT; SET METADATA_UNIT; LENGTH RDB_COLUMN_NM3 $22; LENGTH RDB_COLUMN_NM2 $30;  
RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= TRIM(RDB_COLUMN_NM3)
868       + || '_OTH';  USER_DEFINED_COLUMN_NM = TRIM(USER_DEFINED_COLUMN_NM)|| '_OTH';  
RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 RDB_COLUMN_NM3; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

868       +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

868       +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT
869       +;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 6 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 6 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
230                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

869       +                              DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5
870       + $15000;  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
871       +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
872       + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
873       + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
874       + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
875       + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 6 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 6 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

875       +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 6 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 6 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

875       +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
876       + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

231                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 6 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 30 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

876       +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      876:188   
NOTE: There were 30 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 30 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

876       +
PROC SQL;  
876       +
 CREATE TABLE METADATA_OUT as select
877       + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: Table WORK.METADATA_OUT created, with 30 rows and 4 columns.

877       +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

877       +                                                                 PROC SQL;
877       +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

877       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

877       +
PROC SQL;  
232                                         The SAS System             22:41 Saturday, January 6, 2024

877       +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 6 rows and 4 columns.

877       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

877       +
PROC SQL;  
877       +
  CREATE   
878       + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  UPCASE(METADATA_OUT1.RDB_COLUMN_NM) = 
UPCASE(METADATA_OUT.RDB_COLUMN_NM);
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: Table WORK.METADATA_OUT created, with 30 rows and 5 columns.

878       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

878       +
DATA METADATA_OUT; SET
879       + METADATA_OUT;   ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), 
comma20.);  DROP BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 30 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 30 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

879       +
PROC SQL;  
879       +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
233                                         The SAS System             22:41 Saturday, January 6, 2024

879       +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

879       +
  UPDATE   
880       + STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

880       +                                                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

880       +                                                                                   DATA 
_NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF 
COUNTSTD<2 then call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

881       + PROC SQL;
881       +             CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, 
RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 6 rows and 4 columns.

881       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

881       +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1
882       +;  OUTPUT;       RUN;

NOTE: There were 6 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 7 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

882       +                        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

234                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 7 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 6 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

882       +                                                                                       ;   
                                                                                                      
                                                     DATA
883       + DYNINVLISTING;                                                                            
                                                               SET D_INV_REPEAT_METADATA;
884       +                                                           BY SORT_KEY;
885       +                                                                                           
                         LENGTH RDB_COLUMN_NAME_LIST $15000;
886       +                 RETAIN RDB_COLUMN_NAME_LIST;
887       +                                                                          LENGTH 
RDB_COLUMN_LIST $15000;                                                                               
                                               RETAIN RDB_COLUMN_LIST;
888       +
889       +                                LENGTH RDB_COLUMN_COMMA_LIST $15000;                       
                                                                                                 
RETAIN RDB_COLUMN_COMMA_LIST;
890       +                                                                                           
                                                                                                      
                                                    IF
891       + FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN                                          
                                                                     USER_DEFINED_COLUMN_NAME = 
COMPRESS( RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
892       +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN                                                                             
                                  RDB_COLUMN_NAME = COMPRESS(
893       + RDB_COLUMN_NM);                                                                           
                                IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
(USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);
894       +                                                                                           
                                                                                      IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_LIST = (RDB_COLUMN_NAME || '
895       + ' ||  RDB_COLUMN_LIST);                                                       IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  
RDB_COLUMN_COMMA_LIST);                                          OUTPUT;     DROP
896       + datamart_nm USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 6 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 6 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
235                                         The SAS System             22:41 Saturday, January 6, 2024

      

896       +
PROC SQL;  
897       +                                                                                           
              DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 5 rows were deleted from WORK.DYNINVLISTING.

898       +      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

898       +            DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');   CALL 
SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

898       +
DATA DYNINVLISTING; SET DYNINVLISTING;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX
899       +('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN
900       +(RDB_COLUMN_NAME_LIST)-1);  CALL SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL 
SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);  CALL SYMPUTX('D_REPEAT_COMMA_NAME', 
RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

900       +
PROC SQL;  
900       +
  CREATE TABLE REPEAT_BLOCK AS   SELECT
901       + &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY, 
D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY
902       +  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB.D_INVESTIGATION_REPEAT ON  
&FACT_CASE .D_INVESTIGATION_REPEAT_KEY  =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1; ; QUIT;    PROC SQL;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.28 percent. 
236                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 18 pages; un-compressed would require 2486 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 2486 rows and 10 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.06 seconds
      

903       + DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

903       +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

903       +                                                                               PROC SORT 
DATA=REPEAT_BLOCK ; BY INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 2486 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 2486 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.28 percent. 
      Compressed is 18 pages; un-compressed would require 2486 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

903       +
PROC TRANSPOSE DATA=REPEAT_BLOCK OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY
904       + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 2486 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 14916 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 96.39 percent. 
      Compressed is 77 pages; un-compressed would require 2132 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

904       +                                                         DATA REPEAT_BLOCK_OUT; set 
REPEAT_BLOCK_OUT; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 14916 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 14916 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.50 percent. 
      Compressed is 96 pages; un-compressed would require 2131 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

237                                         The SAS System             22:41 Saturday, January 6, 2024

904       +
PROC SQL;
904       +
 CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN
905       + NBS_ODS.NBS_UI_METADATA   ON  NBS_RDB_METADATA.NBS_UI_METADATA_UID 
=NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE  BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND
906       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
907       + RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 6 rows and 2 columns.

907       +                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

907       +                                PROC SQL;
907       +                                          CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM, 
 RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID
908       + WHERE BLOCK_NM IS NOT NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND RDB_TABLE_NM
909       + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 'Coded' 
,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 6 rows and 2 columns.

909       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      

909       +
PROC SQL;  
909       +
 CREATE TABLE BLOCK_DATA_OTH AS SELECT BLOCK_NM,  RDB_COLUMN_NM FROM
910       + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
911       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND RDB_TABLE_NM 
='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 'Coded'
912       + ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
238                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 6 rows and 2 columns.

912       +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      

912       +                                                                            DATA 
BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM $30; LENGTH RDB_COLUMN_NM2 $22; 
RDB_COLUMN_NM2= RDB_COLUMN_NM; RDB_COLUMN_NM=COMPRESS(RDB_COLUMN_NM2 || '_OTH'); DROP
913       + RDB_COLUMN_NM2; RUN;

NOTE: There were 6 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 6 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

913       +                       PROC SQL;
913       +                                 CREATE TABLE BLOCK_DATA AS SELECT * FROM BLOCK_DATA_PL 
UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 12 rows and 2 columns.

913       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

913       +
PROC SQL;  
913       +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT
914       + INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM =BLOCK_DATA.BLOCK_NM  AND 
UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.33 percent. 
      Compressed is 74 pages; un-compressed would require 1585 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 11094 rows and 7 columns.

914       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.12 seconds
239                                         The SAS System             22:41 Saturday, January 6, 2024

      

914       +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT
915       + BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

915       +                                         PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; 
BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 11094 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 11094 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.33 percent. 
      Compressed is 74 pages; un-compressed would require 1585 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

915       +
DATA REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM
916       + BLOCK_NM ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  FORMAT 
ANSWER_DESCCHECK $10.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;
917       +  IF FIRST.RDB_COLUMN_NM  THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; 
ANSWER_DESC21 = '';  END;  I+1;  IF I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND 
LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN
918       + ANSWER_DESC21 =  LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ 
'|| LEFT(TRIM(col1)) ;  END;  IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ col1 I J; RUN;

NOTE: There were 11094 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 9826 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 98.94 percent. 
      Compressed is 52 pages; un-compressed would require 4914 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.06 seconds
      

918       +
DATA REPEAT_BLOCK_OUT_BASE ; SET
919       + REPEAT_BLOCK_OUT_BASE ; RDB_COLUMN_NM = _NAME_; RUN;
240                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 11094 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 11094 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.33 percent. 
      Compressed is 74 pages; un-compressed would require 1585 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

919       +                                                       DATA REPEAT_BLOCK_OUT_BASE; SET 
REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN
920       + COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 
THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 
=' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF
921       + ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
922       + 4 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF
923       + ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: There were 11094 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 11094 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 97.78 percent. 
      Compressed is 82 pages; un-compressed would require 3698 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

923       +                                                   PROC SQL;
923       +                                                             CREATE TABLE METADATA_OUT as 
select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 93.33 percent. 
      Compressed is 2 pages; un-compressed would require 30 pages.
NOTE: Table WORK.METADATA_OUT created, with 30 rows and 5 columns.

923       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

923       +
PROC SQL;  
923       +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM
924       + METADATA_OUT LEFT OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  
241                                         The SAS System             22:41 Saturday, January 6, 2024

= UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR 
=REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM =
925       + REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.07 percent. 
      Compressed is 101 pages; un-compressed would require 10918 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 10918 rows and 12 columns.

925       +                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.42 seconds
      cpu time            1.81 seconds
      

925       +                                           PROC SORT DATA=METADATA_MERGED_INIT ; BY 
INVESTIGATION_KEY;RUN;

NOTE: There were 10918 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 10918 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.07 percent. 
      Compressed is 101 pages; un-compressed would require 10918 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.15 seconds
      cpu time            0.15 seconds
      

925       +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_VARCHAR;  VAR DATA_VALUE;  ID COL1; 
    BY INVESTIGATION_KEY; RUN;

WARNING: 12 observations omitted due to missing ID values.
NOTE: There were 10918 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 2030 observations and 20 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 99.51 percent. 
      Compressed is 10 pages; un-compressed would require 2030 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

925       +
  DATA     
926       + INVESTIGATION_REPEAT_VARCHAR; SET INVESTIGATION_REPEAT_VARCHAR; DROP _NAME_; RUN;

NOTE: There were 2030 observations read from the data set WORK.INVESTIGATION_REPEAT_VARCHAR.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 2030 observations and 19 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 99.51 percent. 
      Compressed is 10 pages; un-compressed would require 2030 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
242                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

926       +                                                                                      PROC 
SQL;
926       +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM 
D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 6 rows and 2 columns.

926       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

926       +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH
927       + USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = 
COMPRESS(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 6 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 6 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

927       +
PROC SQL;  
927       +
 CREATE TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*,
928       + REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_ALL  ON UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = 
UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.31 percent. 
      Compressed is 68 pages; un-compressed would require 9826 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 9826 rows and 7 columns.

928       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.40 seconds
      cpu time            0.45 seconds
      

928       +
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

243                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 9826 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 9826 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.31 percent. 
      Compressed is 68 pages; un-compressed would require 9826 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

929       + PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_VARCHAR_ALL;  VAR 
ANSWER_DESC21;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 9826 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 2029 observations and 8 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

929       +
DATA REPEAT_BLOCK_VARCHAR_ALL; SET REPEAT_BLOCK_VARCHAR_ALL; DROP _NAME_; RUN;

NOTE: There were 2029 observations read from the data set WORK.REPEAT_BLOCK_VARCHAR_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

930       + PROC SQL;
930       +           CREATE TABLE METADATA AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
931       + NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND
932       + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and data_type in ( 'DATETIME','DATE', 
'Date','Date/Time')  and code_set_group_id is null ORDER BY
933       + RDB_COLUMN_NM;
NOTE: Table WORK.METADATA created, with 0 rows and 5 columns.

933       +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

933       +                        DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
244                                         The SAS System             22:41 Saturday, January 6, 2024

USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000
934       +;  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
935       +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
936       + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
937       + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
938       + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
939       + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

939       +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA has 0 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

939       +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
940       + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 3 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

940       +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

245                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 5 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

940       +
PROC SQL;  
940       +
 CREATE TABLE METADATA_OUT as select
941       + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 4 columns.

941       +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

941       +                                                                PROC SQL;
941       +                                                                           DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: 5 rows were deleted from WORK.METADATA_OUT.

941       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

941       +
PROC SQL;  
941       +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Table WORK.METADATA_OUT1 created, with 0 rows and 4 columns.

941       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

941       +
PROC SQL;  
941       +
246                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE
942       + METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1  FROM 
METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.

942       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

942       +
DATA METADATA_OUT; SET METADATA_OUT;
943       + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      943:57   
NOTE: There were 0 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

943       +
PROC SQL;  
943       +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
943       +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

943       +
  UPDATE STD_TESTER SET
944       + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

944       +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

944       +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

247                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

944       +
PROC SQL;  
944       +
  CREATE   
945       + TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 0 rows and 4 columns.

945       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

945       +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
946       + RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

946       +        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

946       +                                                                       ;
946       +
DATA DYNINVLISTING;
947       +                                                                                           
                                          SET D_INV_REPEAT_METADATA;
948       +                                      BY SORT_KEY;
949       +                                                                                           
    LENGTH RDB_COLUMN_NAME_LIST $15000;
950       + RETAIN RDB_COLUMN_NAME_LIST;
951       +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
248                                         The SAS System             22:41 Saturday, January 6, 2024

                     RETAIN RDB_COLUMN_LIST;
952       +
953       +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
954       +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
955       + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
956       +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
957       +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
958       +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
959       +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
960       + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

960       +
PROC SQL;  
961       +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

961       +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

962       + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
249                                         The SAS System             22:41 Saturday, January 6, 2024

      

962       +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
963       +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

963       +                                  DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
964       + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
965       +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

965       +                                                                     PROC SQL;
965       +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
966       + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
967       + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 28.57 percent. 
      Compressed is 25 pages; un-compressed would require 35 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 2486 rows and 4 columns.

967       +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.20 seconds
      cpu time            0.06 seconds
      

967       +
PROC SQL;  
967       +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: 2486 rows were deleted from WORK.REPEAT_BLOCK.

967       +
250                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

967       +
PROC SORT DATA=REPEAT_BLOCK ; BY
968       + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

968       +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: No variables to transpose.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

968       +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
969       + RDB_COLUMN_NM = _NAME_; coloumnText=ANSWER_TXT;  rename col1=dateColumn; RUN;

NOTE: Variable ANSWER_TXT is uninitialized.
WARNING: The variable col1 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

969       +                                                                                PROC SQL;
969       +                                                                                          
CREATE TABLE BLOCK_DATA AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN 
NBS_ODS.NBS_UI_METADATA   ON
970       + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE  
RDB_TABLE_NM='D_INVESTIGATION_REPEAT'  AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART')  AND PART_TYPE_CD
971       + IS NULL  AND QUESTION_GROUP_SEQ_NBR IS NOT NULL   AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL 
 AND NBS_RDB_METADATA.BLOCK_PIVOT_NBR IS NOT NULL  and data_type in ( 'DATETIME','DATE',
972       + 'Date','Date/Time') and code_set_group_id is null   ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Table WORK.BLOCK_DATA created, with 0 rows and 2 columns.
251                                         The SAS System             22:41 Saturday, January 6, 2024


972       +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

972       +
PROC SQL;  
972       +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA 
  ON  REPEAT_BLOCK_OUT.BLOCK_NM
973       + =BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= 
UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 0 rows and 7 columns.

973       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

973       +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

973       +
PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY
974       + INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

974       +                                                                      DATA 
REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESCCHECK $10.;  FORMAT
975       + ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM  
252                                         The SAS System             22:41 Saturday, January 6, 2024

THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = '';    END;   I = 0;
976       + ANSWER_DESC21 = '';    ANSWER_DESCCHECK='';  END;  I+1;  X=LENGTHN(ANSWER_DESC21);  IF I 
<= 20 THEN DO;   TEXTDATE =  PUT(dateColumn, yymmddd10.);          ANSWER_DESC(I) = TEXTDATE;   IF 
LENGTHN(TEXTDATE)< 5 THEN TEXTDATE='';   IF LENGTHN(TEXTDATE)>4
977       + AND LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN 
ANSWER_DESC21 =  LEFT(TRIM(TEXTDATE));   ELSE ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))|| ' ~ '|| 
LEFT(TRIM(TEXTDATE));  END;   IF LAST.RDB_COLUMN_NM THEN OUTPUT;   IF  LENGTHN
978       +(COMPRESS(ANSWER_DESCCHECK))<3 THEN ANSWER_DESC21='';  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ ANSWER_DESCCHECK I J; RUN;

NOTE: Variable dateColumn is uninitialized.
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

978       +
DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE ; DATA_VALUE=dateColumn; RDB_COLUMN_NM = 
_NAME_; RUN;

NOTE: Variable dateColumn is uninitialized.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

978       +
  DATA     
979       + REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF
980       + ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
981       + 3 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 3 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF
982       + ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      980:38    980:223   981:154   982:85    
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
253                                         The SAS System             22:41 Saturday, January 6, 2024


982       +
PROC SQL;  
982       +
 CREATE    
983       + TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR 
FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.

983       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

983       +
PROC SQL;  
983       +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_BASE ON UPCASE
984       +(METADATA_OUT.RDB_COLUMN_NM)  = UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND 
METADATA_OUT.ANSWER_GROUP_SEQ_NBR =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND 
METADATA_OUT.BLOCK_NM = REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable col1 already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 0 rows and 14 columns.

984       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

984       +
PROC SORT  
985       + DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_MERGED_INIT has 0 observations and 14 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

985       +                                                        PROC TRANSPOSE 
DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_DATE;  VAR dateColumn;  ID COL1;     BY 
INVESTIGATION_KEY; RUN;
254                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1 observations and 2 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

985       +
DATA INVESTIGATION_REPEAT_DATE; SET INVESTIGATION_REPEAT_DATE; DROP
986       + _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.INVESTIGATION_REPEAT_DATE because compression 
      overhead would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.INVESTIGATION_REPEAT_DATE.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

986       +                 PROC SQL;
986       +                           CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM  FROM D_INV_REPEAT_METADATA;
NOTE: Table WORK.REPEAT_ALL created, with 0 rows and 2 columns.

986       +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

986       +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL 
= COMPRESS
987       +(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

987       +                                                                       PROC SQL;
987       +                                                                                 CREATE 
TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON UPCASE
988       +(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 0 rows and 11 columns.

255                                         The SAS System             22:41 Saturday, January 6, 2024

988       +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

988       +                                                                                  PROC 
SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 0 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

988       +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_DATE_ALL;  VAR ANSWER_DESC21;  ID
989       + USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

989       +                                                              DATA REPEAT_BLOCK_DATE_ALL; 
SET REPEAT_BLOCK_DATE_ALL; DROP _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.REPEAT_BLOCK_DATE_ALL because compression overhead 
      would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.REPEAT_BLOCK_DATE_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

990       + PROC SQL;
990       +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
991       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
992       + DATAMART_NM='HAV_DATAMART') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL 
and (code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC') ) ORDER BY
993       + RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
256                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.METADATA_INIT created, with 4 rows and 5 columns.

993       +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.07 seconds
      

993       +                       PROC SQL;
993       +                                 CREATE TABLE METADATA_UNIT AS   SELECT  
INIT.DATAMART_NM,RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR,BLOCK_NM, 
MASK FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
994       + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
995       + DATAMART_NM='HAV_DATAMART') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND UNIT_TYPE_CD='CODED' AND RDB_TABLE_NM 
='D_INVESTIGATION_REPEAT'  AND DATA_TYPE IN ('Numeric','NUMERIC') AND
996       + CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL   ORDER BY RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_UNIT created, with 0 rows and 6 columns.

996       +                                                                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

996       +                                                                                 DATA 
METADATA_UNIT; SET METADATA_UNIT; LENGTH RDB_COLUMN_NM3 $21; LENGTH RDB_COLUMN_NM2 $30;  
RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= TRIM(RDB_COLUMN_NM3) || '_UNIT';
997       + USER_DEFINED_COLUMN_NM = TRIM(USER_DEFINED_COLUMN_NM)|| '_UNIT';  RDB_COLUMN_NM= 
RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 RDB_COLUMN_NM3; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

997       +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

997       +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY
998       + RDB_COLUMN_NM;  RUN;

257                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 4 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 4 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

998       +                       DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
999       +  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
1000      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
1001      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
1002      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
1003      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
1004      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 4 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 4 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1004      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 4 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 4 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1004      +
258                                         The SAS System             22:41 Saturday, January 6, 2024

PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
1005      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 4 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 20 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1005      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1005:187   
NOTE: There were 20 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 20 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1005      +
PROC SQL;  
1005      +
 CREATE TABLE METADATA_OUT as select
1006      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: Table WORK.METADATA_OUT created, with 20 rows and 4 columns.

1006      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1006      +                                                                 PROC SQL;
1006      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

1006      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
259                                         The SAS System             22:41 Saturday, January 6, 2024

      

1006      +
PROC SQL;  
1006      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 4 rows and 4 columns.

1006      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1006      +
PROC SQL;  
1006      +
  CREATE   
1007      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = 
METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: Table WORK.METADATA_OUT created, with 20 rows and 5 columns.

1007      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1007      +
DATA METADATA_OUT; SET METADATA_OUT;
1008      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 20 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 20 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1008      +
PROC SQL;  
1008      +
260                                         The SAS System             22:41 Saturday, January 6, 2024

   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1008      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1008      +
  UPDATE STD_TESTER SET
1009      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1009      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1009      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1009      +
PROC SQL;  
1010      + CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 4 rows and 4 columns.

1010      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1010      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
1011      +     RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 5 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
261                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1011      +            PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 4 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1011      +                                                                           ;
1011      +
DATA DYNINVLISTING;
1012      +                                                                                           
                                              SET D_INV_REPEAT_METADATA;
1013      +                                          BY SORT_KEY;
1014      +                                                                                           
        LENGTH RDB_COLUMN_NAME_LIST $15000;
1015      + RETAIN RDB_COLUMN_NAME_LIST;
1016      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
1017      +
1018      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
1019      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
1020      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1021      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
1022      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
1023      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
1024      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
1025      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 4 observations read from the data set WORK.D_INV_REPEAT_METADATA.
262                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 4 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1025      +
PROC SQL;  
1026      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 3 rows were deleted from WORK.DYNINVLISTING.

1026      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1027      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1027      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
1028      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1028      +                                   DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1029      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
1030      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
263                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

1030      +                                                                     PROC SQL;
1030      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
1031      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
1032      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 98.79 percent. 
      Compressed is 15 pages; un-compressed would require 1244 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 2486 rows and 8 columns.

1032      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

1032      +
PROC SQL;  
1032      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

1032      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1032      +
PROC SORT DATA=REPEAT_BLOCK ; BY
1033      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 2486 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 2486 observations and 8 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 98.79 percent. 
      Compressed is 15 pages; un-compressed would require 1244 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1033      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

264                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 2486 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 9944 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 96.27 percent. 
      Compressed is 53 pages; un-compressed would require 1421 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1033      +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
1034      + RDB_COLUMN_NM = _NAME_; run;

NOTE: There were 9944 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 9944 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.36 percent. 
      Compressed is 66 pages; un-compressed would require 1421 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

1034      +                               PROC SQL;
1034      +                                         CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  
RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE
1035      + BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='HAV_DATAMART') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM
1036      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 4 rows and 2 columns.

1036      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

1036      +
PROC SQL;  
1036      +
 CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM,  COMPRESS(RDB_COLUMN_NM || '_UNIT') AS 
RDB_COLUMN_NM FROM
1037      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1038      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='HAV_DATAMART') AND RDB_TABLE_NM 
='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in (
1039      + 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
265                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 4 rows and 2 columns.

1039      +                                                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

1039      +                                                                   PROC SQL;
1039      +                                                                             CREATE TABLE 
BLOCK_DATA_OTH AS SELECT BLOCK_NM,  TRIM(RDB_COLUMN_NM || '_OTH') AS RDB_COLUMN_NM FROM 
NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON
1040      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM 
IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='HAV_DATAMART') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and
1041      +(code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, 
BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 4 rows and 2 columns.

1041      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1041      +
DATA BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM2 $22; LENGTH RDB_COLUMN_NM $30; 
RDB_COLUMN_NM2=RDB_COLUMN_NM; RDB_COLUMN_NM = COMPRESS
WARNING: Length of character variable RDB_COLUMN_NM has already been set. 
         Use the LENGTH statement as the very first statement in the DATA STEP to declare the length 
         of a character variable.
1042      +(RDB_COLUMN_NM2|| '_OTH'); DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 4 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 4 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1042      +                                                       PROC SQL;
1042      +                                                                 CREATE TABLE BLOCK_DATA 
AS SELECT * FROM BLOCK_DATA_PL  UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM 
BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 12 rows and 2 columns.
266                                         The SAS System             22:41 Saturday, January 6, 2024


1042      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1042      +
PROC SQL;  
1042      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT
1043      + DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM 
=BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.28 percent. 
      Compressed is 58 pages; un-compressed would require 1230 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 8608 rows and 7 columns.

1043      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.11 seconds
      

1043      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE
1044      + BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1044      +                                                                                      PROC 
SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 8608 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 8608 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.28 percent. 
      Compressed is 58 pages; un-compressed would require 1230 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
267                                         The SAS System             22:41 Saturday, January 6, 2024

      

1044      +
DATA REPEAT_BLOCK_OUT_ALL; SET
1045      + REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR; 
   FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;  FORMAT ANSWER_DESCCHECK 
$10.;   ARRAY ANSWER_DESC(20) ANSWER_DESC1-ANSWER_DESC20;
1046      + ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM 
 THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; ANSWER_DESC21 = '';  END;  I+1;  IF 
I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND LENGTHN
1047      +(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN ANSWER_DESC21 =  
LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ '|| LEFT(TRIM(col1)) ;  END;  
IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20
1048      + _NAME_ _LABEL_ col1 I J;     RUN;

NOTE: There were 8608 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 7728 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 98.94 percent. 
      Compressed is 41 pages; un-compressed would require 3865 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

1048      +                                    DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE 
; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 8608 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 8608 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.28 percent. 
      Compressed is 58 pages; un-compressed would require 1230 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1048      +
DATA REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 
THEN COL2 =' ';   IF
1049      + ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR =
1050      + 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF
1051      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
1052      + 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 5 THEN COL4 =' ';    RUN;

NOTE: There were 8608 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 8608 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 97.74 percent. 
268                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 65 pages; un-compressed would require 2870 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1052      +
PROC SQL;  
1052      +
 CREATE TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM 
METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: Table WORK.METADATA_OUT created, with 20 rows and 5 columns.

1052      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1053      + PROC SQL;
1053      +           CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT 
OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  = 
UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR
1054      + =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM = 
REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.06 percent. 
      Compressed is 80 pages; un-compressed would require 8508 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 8508 rows and 12 columns.

1054      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.09 seconds
      cpu time            1.43 seconds
      

1054      +
PROC SORT DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: There were 8508 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 8508 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.06 percent. 
      Compressed is 80 pages; un-compressed would require 8508 pages.
NOTE: PROCEDURE SORT used (Total process time):
269                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.12 seconds
      cpu time            0.12 seconds
      

1054      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_NUMERIC;
1055      + VAR DATA_VALUE;  ID COL1;     BY INVESTIGATION_KEY; RUN;

WARNING: 8 observations omitted due to missing ID values.
NOTE: There were 8508 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1933 observations and 14 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 99.43 percent. 
      Compressed is 11 pages; un-compressed would require 1933 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

1055      +                                                           DATA 
INVESTIGATION_REPEAT_NUMERIC; SET INVESTIGATION_REPEAT_NUMERIC; DROP _NAME_; RUN;

NOTE: There were 1933 observations read from the data set WORK.INVESTIGATION_REPEAT_NUMERIC.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1933 observations and 13 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 99.48 percent. 
      Compressed is 10 pages; un-compressed would require 1933 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

1055      +
PROC SQL;  
1055      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM
1056      + D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 4 rows and 2 columns.

1056      +                        QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1056      +                               DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH 
USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = COMPRESS(USER_DEFINED_COLUMN_NM || 
'_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 4 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 4 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
270                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1056      +
PROC SQL;  
1056      +
 CREATE TABLE
1057      + REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON 
UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.30 percent. 
      Compressed is 54 pages; un-compressed would require 7728 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 7728 rows and 7 columns.

1057      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.32 seconds
      

1057      +
PROC SQL;  
1058      + DELETE FROM REPEAT_BLOCK_METADATA_OUT WHERE USER_DEFINED_COLUMN_NM_ALL= '_ALL';
NOTE: No rows were deleted from WORK.REPEAT_BLOCK_METADATA_OUT.

1058      +                                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1058      +                                                                                          
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 7728 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 7728 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.30 percent. 
      Compressed is 54 pages; un-compressed would require 7728 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.06 seconds
      

1058      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_NUMERIC_ALL;  VAR ANSWER_DESC21
1059      +;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 7728 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1932 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 99.48 percent. 
      Compressed is 10 pages; un-compressed would require 1932 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
271                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.06 seconds
      cpu time            0.04 seconds
      

1059      +                                                                   DATA 
REPEAT_BLOCK_NUMERIC_ALL; SET REPEAT_BLOCK_NUMERIC_ALL; DROP _NAME_; RUN;

NOTE: There were 1932 observations read from the data set WORK.REPEAT_BLOCK_NUMERIC_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1932 observations and 5 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 99.53 percent. 
      Compressed is 9 pages; un-compressed would require 1932 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

1060      + PROC SQL;
1060      +           DROP TABLE  NBS_RDB.DM_INV_HAV_DATAMART;
NOTE: Table NBS_RDB.DM_INV_HAV_DATAMART has been dropped.
1060      +                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1060      +                                                           PROC SQL;
1060      +                                                                      CREATE TABLE 
DISCRETE_ALL AS SELECT * FROM INV_SUMM_DATAMART  LEFT JOIN INVESTIGATION_DATA ON 
INVESTIGATION_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
1061      + PATIENT_DATA ON PATIENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT 
JOIN CASE_MANAGEMENT_DATA ON CASE_MANAGEMENT_DATA.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_ADMINISTRATIVE ON
1062      + D_INV_ADMINISTRATIVE.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_CLINICAL ON D_INV_CLINICAL.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_COMPLICATION ON D_INV_COMPLICATION.INVESTIGATION_KEY
1063      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_CONTACT ON 
D_INV_CONTACT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_DEATH ON 
D_INV_DEATH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_EPIDEMIOLOGY
1064      + ON D_INV_EPIDEMIOLOGY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_HIV ON D_INV_HIV.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_PATIENT_OBS ON D_INV_PATIENT_OBS.INVESTIGATION_KEY
1065      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_ISOLATE_TRACKING ON 
D_INV_ISOLATE_TRACKING.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_LAB_FINDING ON D_INV_LAB_FINDING.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
1066      +  LEFT JOIN D_INV_MEDICAL_HISTORY ON D_INV_MEDICAL_HISTORY.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_MOTHER ON D_INV_MOTHER.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_OTHER ON
1067      + D_INV_OTHER.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_PREGNANCY_BIRTH ON D_INV_PREGNANCY_BIRTH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_RESIDENCY ON D_INV_RESIDENCY.INVESTIGATION_KEY
1068      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_RISK_FACTOR ON 
D_INV_RISK_FACTOR.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_SOCIAL_HISTORY ON D_INV_SOCIAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
1069      + LEFT JOIN D_INV_SYMPTOM ON D_INV_SYMPTOM.INVESTIGATION_KEY 
272                                         The SAS System             22:41 Saturday, January 6, 2024

=INV_SUMM_DATAMART.INVESTIGATION_KEY   LEFT JOIN D_INV_TREATMENT ON D_INV_TREATMENT.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_TRAVEL ON D_INV_TRAVEL.INVESTIGATION_KEY
1070      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_UNDER_CONDITION ON 
D_INV_UNDER_CONDITION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_VACCINATION ON D_INV_VACCINATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
1071      + LEFT JOIN D_INV_STD ON D_INV_STD.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN ORGANIZATION ON ORGANIZATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT 
JOIN PROVIDER ON PROVIDER.INVESTIGATION_KEY
1072      + =INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable PATIENT_LOCAL_ID already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INTERVIEWEE_RELATIONS already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
NOTE: Compressing data set WORK.DISCRETE_ALL decreased size by 98.97 percent. 
      Compressed is 41 pages; un-compressed would require 3997 pages.
NOTE: Table WORK.DISCRETE_ALL created, with 3997 rows and 286 columns.

1072      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           7.81 seconds
      cpu time            8.29 seconds
      
273                                         The SAS System             22:41 Saturday, January 6, 2024


1072      +                                              PROC SQL;
1072      +                                                        CREATE TABLE REPEAT_ALL AS SELECT 
* FROM  INVESTIGATION_REPEAT_VARCHAR LEFT JOIN REPEAT_BLOCK_VARCHAR_ALL ON 
REPEAT_BLOCK_VARCHAR_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY
1073      + LEFT JOIN INVESTIGATION_REPEAT_NUMERIC ON INVESTIGATION_REPEAT_NUMERIC.INVESTIGATION_KEY 
=INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN INVESTIGATION_REPEAT_DATE ON 
INVESTIGATION_REPEAT_DATE.INVESTIGATION_KEY
1074      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN REPEAT_BLOCK_DATE_ALL ON 
REPEAT_BLOCK_DATE_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN 
REPEAT_BLOCK_NUMERIC_ALL ON REPEAT_BLOCK_NUMERIC_ALL.INVESTIGATION_KEY
1075      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable BINATIONAL_RPTNG_CRIT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable BINATIONAL_RPTNG_CRIT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable BINATIONAL_RPTNG_CRIT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable BINATIONAL_RPTNG_CRIT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2030 pages.
NOTE: Table WORK.REPEAT_ALL created, with 2030 rows and 25 columns.

1075      +                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.04 seconds
      cpu time            1.07 seconds
      

1075      +                                                         PROC SQL;
1075      +                                                                   CREATE TABLE 
DM_INV_HAV_DATAMART AS SELECT * FROM  DISCRETE_ALL LEFT OUTER JOIN REPEAT_ALL ON  
DISCRETE_ALL.INVESTIGATION_KEY = REPEAT_ALL.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DM_INV_HAV_DATAMART.
NOTE: Compressing data set WORK.DM_INV_HAV_DATAMART decreased size by 99.12 percent. 
      Compressed is 35 pages; un-compressed would require 3997 pages.
NOTE: Table WORK.DM_INV_HAV_DATAMART created, with 3997 rows and 310 columns.

1075      +
 QUIT;     
274                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.87 seconds
      cpu time            0.87 seconds
      

1075      +
Proc Append Force
1076      + base=nbs_rdb.DM_INV_HAV_DATAMART data=DM_INV_HAV_DATAMART;  Run;

NOTE: Appending WORK.DM_INV_HAV_DATAMART to NBS_RDB.DM_INV_HAV_DATAMART.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
WARNING: Engine ODBC does not support SORTEDBY operations.  SORTEDBY information cannot be copied.
NOTE: There were 3997 observations read from the data set WORK.DM_INV_HAV_DATAMART.
NOTE: The data set NBS_RDB.DM_INV_HAV_DATAMART has 3997 observations and 310 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           3.54 seconds
      cpu time            0.37 seconds
      
1076      +                                                                   Quit;;

1076      +                                                                           PROC SQL;
1076      +                                                                                     DROP 
TABLE DISCRETE_ALL;
NOTE: Table WORK.DISCRETE_ALL has been dropped.
1076      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1076      +
PROC SQL;  
1076      +
 DROP TABLE REPEAT_ALL;
NOTE: Table WORK.REPEAT_ALL has been dropped.
1076      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1076      +
PROC SQL;  
1076      +
 DROP TABLE DM_INV_HAV_DATAMART;
NOTE: Table WORK.DM_INV_HAV_DATAMART has been dropped.
1076      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
275                                         The SAS System             22:41 Saturday, January 6, 2024

      

1077      + PROC SQL;
1077      +             DROP TABLE NBS_RDB.SUMM_DATAMART;
NOTE: Table NBS_RDB.SUMM_DATAMART has been dropped.
1077      +                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1077      +                                                     PROC SQL;
1077      +                                                                  CREATE TABLE 
NBS_RDB.SUMM_DATAMART AS SELECT PATIENT_KEY AS PATIENT_KEY, INVESTIGATION_KEY, DISEASE_GRP_CD      
FROM NBS_RDB.INV_SUMM_DATAMART        INNER JOIN NBS_RDB.CONDITION ON
1078      + INV_SUMM_DATAMART.DISEASE_CD = CONDITION.CONDITION_CD      WHERE CONDITION.DISEASE_GRP_CD 
= (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.SUMM_DATAMART created, with 2029 rows and 3 columns.

1078      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.86 seconds
      cpu time            0.04 seconds
      

1078      +
PROC SQL;  
1078      +
  CREATE TABLE INV_METADATA AS SELECT  DISTINCT INIT.FORM_CD,
1079      + INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM FROM NBS_RDB.INIT INNER JOIN 
NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD INNER JOIN
1080      + NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='INVESTIGATION'  AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI') AND
1081      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.INV_METADATA created, with 24 rows and 5 columns.

1081      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

1081      +
DATA INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET INV_METADATA;    SORT_KEY+1;
1082      + OUTPUT;       RUN;
276                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 24 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INV_METADATA has 25 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1082      +                      PROC SORT DATA=INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 25 observations read from the data set WORK.INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INV_METADATA has 24 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1082      +                                                                            ;
1082      +                                                                              DATA 
INVLISTING;   SET INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   USER_DEFINED_COLUMN_NAME = TRIM
1083      +(RDB_COLUMN_NM) || ' AS ' ||TRIM(USER_DEFINED_COLUMN_NM)|| 
"'"||TRIM(USER_DEFINED_COLUMN_NM)||"'";   RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || 
RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 24 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INVLISTING has 24 observations and 8 variables.
NOTE: Compressing data set WORK.INVLISTING decreased size by 87.50 percent. 
      Compressed is 3 pages; un-compressed would require 24 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1083      +
PROC SQL;  
1083      +
  DELETE FROM INVLISTING WHERE SORT_KEY <
1084      +(SELECT MAX (SORT_KEY) FROM INVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 23 rows were deleted from WORK.INVLISTING.

1084      +                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

277                                         The SAS System             22:41 Saturday, January 6, 2024

1084      +                                               DATA INVLISTING; SET INVLISTING;    CALL 
SYMPUTX('INV_SEL2', '');  LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  
TRIMMED_VALUE=SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1);   CALL SYMPUTX('INV_SEL2', TRIMMED_VALUE);
1085      + RUN;

NOTE: There were 1 observations read from the data set WORK.INVLISTING.
NOTE: The data set WORK.INVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.INVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1085      +       PROC SQL;
1085      +                   CREATE TABLE INVESTIGATION_DATA AS   SELECT  &INV_SEL2, 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.INVESTIGATION  INNER JOIN NBS_RDB.SUMM_DATAMART ON  
SUMM_DATAMART.INVESTIGATION_KEY  =INVESTIGATION.INVESTIGATION_KEY WHERE
1086      + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.INVESTIGATION_DATA decreased size by 95.86 percent. 
      Compressed is 28 pages; un-compressed would require 677 pages.
NOTE: Table WORK.INVESTIGATION_DATA created, with 2029 rows and 25 columns.

1086      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.01 seconds
      

1086      +
PROC SQL;  
1086      +
   CREATE TABLE CASE_MANAGEMENT_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1087      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM NBS_RDB.INIT 
INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  INNER 
JOIN NBS_ODS.NBS_RDB_METADATA  ON
1088      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_CASE_MANAGEMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1089      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL  ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.CASE_MANAGEMENT_METADATA created, with 0 rows and 5 columns.

1089      +
   INSERT INTO CASE_MANAGEMENT_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1090      + DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_CASE_MANAGEMENT';
NOTE: 1 row was inserted into WORK.CASE_MANAGEMENT_METADATA.

1090      +                                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
278                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

1090      +                                                                    PROC SQL;
1090      +                                                                              CREATE TABLE 
INV_SUMM_DATAMART AS SELECT INV_SUMM_DATAMART.PROGRAM_JURISDICTION_OID,  
INV_SUMM_DATAMART.INVESTIGATION_KEY,  INV_SUMM_DATAMART.PATIENT_KEY,
1091      + INV_SUMM_DATAMART.PATIENT_LOCAL_ID,  INV_SUMM_DATAMART.INVESTIGATION_CREATE_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_CREATED_BY,  INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,
1092      + INV_SUMM_DATAMART.EVENT_DATE,  INV_SUMM_DATAMART.EVENT_DATE_TYPE,  
INV_SUMM_DATAMART.LABORATORY_INFORMATION,  INV_SUMM_DATAMART.EARLIEST_SPECIMEN_COLLECT_DATE,  
INV_SUMM_DATAMART.NOTIFICATION_STATUS,  INV_SUMM_DATAMART.CONFIRMATION_METHOD,
1093      + INV_SUMM_DATAMART.CONFIRMATION_DT,   INV_SUMM_DATAMART.DISEASE_CD,  
INV_SUMM_DATAMART.DISEASE,  INV_SUMM_DATAMART.NOTIFICATION_LAST_UPDATED_DATE,   
INV_SUMM_DATAMART.NOTIFICATION_LOCAL_ID,  INV_SUMM_DATAMART.PROGRAM_AREA,
1094      + INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,  INV_SUMM_DATAMART.PATIENT_COUNTY_CODE,  
INV_SUMM_DATAMART.JURISDICTION_NM  FROM NBS_RDB.INV_SUMM_DATAMART  INNER JOIN INVESTIGATION_DATA ON  
INVESTIGATION_DATA.INVESTIGATION_KEY =
1095      + INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_LAST_UPDTD_BY already exists on file WORK.INV_SUMM_DATAMART.
NOTE: Compressing data set WORK.INV_SUMM_DATAMART decreased size by 94.63 percent. 
      Compressed is 109 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.INV_SUMM_DATAMART created, with 2029 rows and 22 columns.

1095      +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           27.51 seconds
      cpu time            4.01 seconds
      

1095      +                                              PROC SQL;
1095      +                                                         CREATE TABLE PAT_METADATA AS   
SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM
1096      + NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD 
= INIT.FORM_CD INNER JOIN NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='D_PATIENT'  AND
1097      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI') AND RDB_COLUMN_NM NOT IN ('PATIENT_WORK_STREET_ADDRESS_1', 
'PATIENT_WORK_STREET_ADDRESS_2') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1098      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PAT_METADATA created, with 28 rows and 5 columns.

1098      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

279                                         The SAS System             22:41 Saturday, January 6, 2024

1098      +
DATA PAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PAT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.PAT_METADATA has 29 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1098      +
PROC SORT DATA=PAT_METADATA
1099      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 29 observations read from the data set WORK.PAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PAT_METADATA has 28 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1099      +                           ;
1099      +                             DATA LISTING;   SET PAT_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   
USER_DEFINED_COLUMN_NAME = ' AS ' ||USER_DEFINED_COLUMN_NM||
1100      + "'"||USER_DEFINED_COLUMN_NM||"'";   RDB_COLUMN_NAME_LIST = (TRIM(RDB_COLUMN_NM) || 
USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);     OUTPUT; RUN;

NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.LISTING has 28 observations and 8 variables.
NOTE: Compressing data set WORK.LISTING decreased size by 85.71 percent. 
      Compressed is 4 pages; un-compressed would require 28 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1100      +
PROC SQL;  
1100      +
  DELETE FROM LISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM LISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 27 rows were deleted from WORK.LISTING.

1100      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
280                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1100      +
 DATA      
1101      + LISTING; SET LISTING;   CALL SYMPUTX('PAT_SEL', '');  
LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  TRIMMED_VALUE=TRIM(SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1)); 
  CALL SYMPUTX('PAT_SEL', TRIMMED_VALUE); RUN;

NOTE: There were 1 observations read from the data set WORK.LISTING.
NOTE: The data set WORK.LISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.LISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1101      +
PROC SQL;  
1101      +
  CREATE TABLE PATIENT_DATA AS   SELECT
1102      + &PAT_SEL,SUMM_DATAMART.INVESTIGATION_KEY  FROM NBS_RDB.D_PATIENT INNER JOIN 
NBS_RDB.SUMM_DATAMART ON  D_PATIENT.PATIENT_KEY = SUMM_DATAMART.PATIENT_KEY; QUIT;
NOTE: Compressing data set WORK.PATIENT_DATA decreased size by 90.17 percent. 
      Compressed is 40 pages; un-compressed would require 407 pages.
NOTE: Table WORK.PATIENT_DATA created, with 2029 rows and 29 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.20 seconds
      cpu time            0.01 seconds
      

1103      + DATA CASE_MANAGEMENT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET 
CASE_MANAGEMENT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1103      +
PROC SORT DATA=CASE_MANAGEMENT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
281                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1103      +
;          
1103      +
DATA CMLISTING;   SET CASE_MANAGEMENT_METADATA;   BY
1104      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) 
|| ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1105      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CMLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1105      +
PROC SQL;  
1105      +
  DELETE FROM CMLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1106      + CMLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.CMLISTING.

1106      +             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1106      +                     DATA CMLISTING; SET CMLISTING;   CALL SYMPUTX('CM_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1,
1107      + LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= 
'D_CASE_MANAGEMENT.INVESTIGATION_KEY AS INVESTIGATION_KEY';  CALL SYMPUTX('CM_CASE', TRIMMED_VALUE);  
RUN;

NOTE: There were 1 observations read from the data set WORK.CMLISTING.
NOTE: The data set WORK.CMLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

282                                         The SAS System             22:41 Saturday, January 6, 2024

1107      +
PROC SQL;
1107      +
  CREATE TABLE CASE_MANAGEMENT_DATA AS   SELECT  &CM_CASE ,
1108      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  LEFT JOIN  
NBS_RDB.D_CASE_MANAGEMENT ON  SUMM_DATAMART.INVESTIGATION_KEY  =D_CASE_MANAGEMENT.INVESTIGATION_KEY 
WHERE SUMM_DATAMART.DISEASE_GRP_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1109      + DATAMART_NM='AL_LTBI')  AND D_CASE_MANAGEMENT.INVESTIGATION_KEY>1;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.CASE_MANAGEMENT_DATA.
NOTE: Compression was disabled for data set WORK.CASE_MANAGEMENT_DATA because compression overhead 
      would increase the size of the data set.
NOTE: Table WORK.CASE_MANAGEMENT_DATA created, with 0 rows and 1 columns.

1109      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.01 seconds
      

1111      + PROC SQL;
1111      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1111      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1111      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1111      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1111      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1112      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1112      +
PROC SQL;  
1112      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
283                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.RDB_TABLE_NM,
1113      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1114      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1115      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 15 rows and 5 columns.

1115      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1116      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_ADMINISTRATIVE'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1116      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

1116      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 16 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 17 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1116      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1117      + SORT_KEY;RUN;

NOTE: There were 17 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 16 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

284                                         The SAS System             22:41 Saturday, January 6, 2024

1117      +              ;
1117      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1118      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 16 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 16 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 87.50 percent. 
      Compressed is 2 pages; un-compressed would require 16 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1118      +
PROC SQL;  
1119      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 15 rows were deleted from WORK.DYNINVLISTING.

1119      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1119      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1120      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1121      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1120:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1121      +                                                         PROC SQL;
1121      +                                                                     CREATE TABLE 
285                                         The SAS System             22:41 Saturday, January 6, 2024

D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1122      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1123      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
1124      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1124      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

1124      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1125      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1125      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1125      +
;          
1125      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1126      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1127      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
286                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1127      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
1128      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1129      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1129      +               PROC SQL;
1129      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1129      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1129      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1129      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1130      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1131      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1131:60   2326:1    
287                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1131      +
PROC SQL;  
1131      +
  CREATE TABLE
1132      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1133      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
1134      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
1135      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1135      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1135      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1136      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1136      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
288                                         The SAS System             22:41 Saturday, January 6, 2024


1136      +                                                                           ;
1136      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1137      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
1138      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1138      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1139      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1139      +
PROC SQL;  
1140      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1140      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1140      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
289                                         The SAS System             22:41 Saturday, January 6, 2024


1140      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1141      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1142      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1142:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1142      +
PROC SQL;  
1142      +
  CREATE TABLE
1143      + D_INV_ADMINISTRATIVE AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
1144      + NBS_RDB. D_INV_ADMINISTRATIVE ON  &FACT_CASE .D_INV_ADMINISTRATIVE_KEY  
=D_INV_ADMINISTRATIVE .D_INV_ADMINISTRATIVE_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;    DATA
WARNING: Variable StateCaseNoLnkRsn1 already exists on file WORK.D_INV_ADMINISTRATIVE.
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.61 percent. 
      Compressed is 8 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.D_INV_ADMINISTRATIVE created, with 2029 rows and 15 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.92 seconds
      cpu time            0.06 seconds
      

1145      + D_INV_ADMINISTRATIVE; SET D_INV_ADMINISTRATIVE;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_ADMINISTRATIVE.
NOTE: The data set WORK.D_INV_ADMINISTRATIVE has 2029 observations and 15 variables.
290                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.61 percent. 
      Compressed is 8 pages; un-compressed would require 2029 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

1146      + PROC SQL;
1146      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1146      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1146      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1146      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1146      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1147      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1147      +
PROC SQL;  
1147      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1148      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1149      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CLINICAL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1150      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
291                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.D_INV_METADATA created, with 3 rows and 5 columns.

1150      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1151      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_CLINICAL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1151      +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.06 seconds
      

1151      +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 5 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1151      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 4 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1151      +
;  DATA    
1152      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1153      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 4 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
292                                         The SAS System             22:41 Saturday, January 6, 2024

      

1153      +
PROC SQL;  
1153      +
  DELETE FROM
1154      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 3 rows were deleted from WORK.DYNINVLISTING.

1154      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1154      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1155      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1156      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1155:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1156      +                                   PROC SQL;
1156      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1157      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1158      + RDB_TABLE_NM='D_INV_CLINICAL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
1159      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

293                                         The SAS System             22:41 Saturday, January 6, 2024

1159      +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.06 seconds
      

1159      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1159      +
PROC SORT  
1160      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1160      +                                                   ;
1160      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1161      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1161      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
294                                         The SAS System             22:41 Saturday, January 6, 2024

1162      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1163      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1163      +
PROC SQL;  
1163      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1164      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1164      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1164      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1164      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1165      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1166      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1166:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
295                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1166      +
PROC SQL;  
1166      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1167      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1168      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CLINICAL'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1169      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1170      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1170      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1170      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1170      +
PROC SORT DATA=D_INV_METADATA_UNIT
1171      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

296                                         The SAS System             22:41 Saturday, January 6, 2024

1171      +                           ;
1171      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1172      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1172      +
DATA D_INV_METADATA_UNIT; SET
1173      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1174      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1174      +
PROC SQL;  
1174      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1175      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1175      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1175      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
297                                         The SAS System             22:41 Saturday, January 6, 2024


1175      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1176      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1177      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1177:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1177      +
PROC SQL;  
1177      +
  CREATE TABLE D_INV_CLINICAL AS   SELECT
1178      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CLINICAL ON
1179      + &FACT_CASE .D_INV_CLINICAL_KEY  =D_INV_CLINICAL .D_INV_CLINICAL_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_CLINICAL; SET D_INV_CLINICAL;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 99.11 percent. 
      Compressed is 9 pages; un-compressed would require 1015 pages.
NOTE: Table WORK.D_INV_CLINICAL created, with 2029 rows and 5 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.70 seconds
      cpu time            0.03 seconds
      

1180      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_CLINICAL.
NOTE: The data set WORK.D_INV_CLINICAL has 2029 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 99.11 percent. 
298                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 9 pages; un-compressed would require 1015 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1181      + PROC SQL;
1181      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1181      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1181      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1181      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1181      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1182      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1182      +
PROC SQL;  
1182      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1183      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1184      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1185      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1185      +
299                                         The SAS System             22:41 Saturday, January 6, 2024

   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1186      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_COMPLICATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1186      +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

1186      +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1186      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1186      +
;  DATA    
1187      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1188      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1188      +
300                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
1188      +
  DELETE FROM
1189      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1189      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1189      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1190      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1191      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1190:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1191      +                                   PROC SQL;
1191      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1192      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1193      + RDB_TABLE_NM='D_INV_COMPLICATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
1194      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1194      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
301                                         The SAS System             22:41 Saturday, January 6, 2024

      

1194      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1194      +
PROC SORT  
1195      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1195      +                                                   ;
1195      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1196      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1196      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1197      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1198      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
302                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1198      +
PROC SQL;  
1198      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1199      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1199      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1199      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1199      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1200      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1201      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1201:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1201      +
PROC SQL;  
1201      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1202      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1203      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
303                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_COMPLICATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1204      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1205      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1205      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1205      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1205      +
PROC SORT DATA=D_INV_METADATA_UNIT
1206      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1206      +                           ;
1206      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1207      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
304                                         The SAS System             22:41 Saturday, January 6, 2024


1207      +
DATA D_INV_METADATA_UNIT; SET
1208      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1209      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1209      +
PROC SQL;  
1209      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1210      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1210      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1210      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1210      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1211      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1212      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1212:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
305                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1212      +
PROC SQL;  
1212      +
  CREATE TABLE D_INV_COMPLICATION AS   SELECT
1213      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_COMPLICATION ON
1214      + &FACT_CASE .D_INV_COMPLICATION_KEY  =D_INV_COMPLICATION .D_INV_COMPLICATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_COMPLICATION; SET D_INV_COMPLICATION;  DROP
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_COMPLICATION created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

1215      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_COMPLICATION.
NOTE: The data set WORK.D_INV_COMPLICATION has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1216      + PROC SQL;
1216      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1216      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

306                                         The SAS System             22:41 Saturday, January 6, 2024

1216      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1216      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1216      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1217      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1217      +
PROC SQL;  
1217      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1218      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1219      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CONTACT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1220      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1220      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1221      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_CONTACT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1221      +                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.01 seconds
      

1221      +                                                                       DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
307                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1221      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1221      +
;  DATA    
1222      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1223      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1223      +
PROC SQL;  
1223      +
  DELETE FROM
1224      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1224      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1224      +                                                                                  DATA 
308                                         The SAS System             22:41 Saturday, January 6, 2024

DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1225      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1226      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1225:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1226      +                                   PROC SQL;
1226      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1227      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1228      + RDB_TABLE_NM='D_INV_CONTACT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
1229      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1229      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1229      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1229      +
PROC SORT  
309                                         The SAS System             22:41 Saturday, January 6, 2024

1230      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1230      +                                                   ;
1230      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1231      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1231      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1232      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1233      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1233      +
PROC SQL;  
1233      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1234      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1234      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
310                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1234      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1234      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1235      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1236      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1236:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1236      +
PROC SQL;  
1236      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1237      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1238      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CONTACT'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1239      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1240      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1240      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      
311                                         The SAS System             22:41 Saturday, January 6, 2024


1240      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1240      +
PROC SORT DATA=D_INV_METADATA_UNIT
1241      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1241      +                           ;
1241      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1242      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1242      +
DATA D_INV_METADATA_UNIT; SET
1243      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1244      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
312                                         The SAS System             22:41 Saturday, January 6, 2024

      

1244      +
PROC SQL;  
1244      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1245      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1245      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1245      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1245      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1246      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1247      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1247:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1247      +
PROC SQL;  
1247      +
  CREATE TABLE D_INV_CONTACT AS   SELECT
1248      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CONTACT ON
1249      + &FACT_CASE .D_INV_CONTACT_KEY  =D_INV_CONTACT .D_INV_CONTACT_KEY  WHERE 
313                                         The SAS System             22:41 Saturday, January 6, 2024

SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_CONTACT; SET D_INV_CONTACT;  DROP _TEMA001 _TEMA002 _TEMA003
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_CONTACT created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

1250      + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_CONTACT.
NOTE: The data set WORK.D_INV_CONTACT has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1251      + PROC SQL;
1251      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1251      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1251      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1251      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1251      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1252      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;
314                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1252      +
PROC SQL;  
1252      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1253      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1254      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_DEATH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1255      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1255      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1256      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_DEATH'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1256      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

1256      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1256      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
315                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1256      +
;          
1256      +
DATA DYNINVLISTING
1257      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1258      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1258      +
PROC SQL;  
1258      +
  DELETE FROM
1259      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1259      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1259      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1260      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1261      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1260:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
316                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1261      +                                   PROC SQL;
1261      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1262      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1263      + RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
1264      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1264      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1264      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1264      +
PROC SORT DATA=D_INV_METADATA_OTH
1265      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1265      +                           ;
1265      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
317                                         The SAS System             22:41 Saturday, January 6, 2024

UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
1266      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1266      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1267      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1268      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1268      +
PROC SQL;  
1268      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1269      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1269      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1269      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1269      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1270      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
318                                         The SAS System             22:41 Saturday, January 6, 2024

TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1271      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1270:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1271      +
PROC SQL;  
1271      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1272      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1273      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1274      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
1275      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1275      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1275      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1275      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
319                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1275      +
;   DATA   
1276      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
1277      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1277      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
1278      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1279      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1279      +
PROC SQL;  
1279      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1280      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1280      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1280      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
320                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1280      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1281      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1282      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1281:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1282      +
PROC SQL;  
1282      +
  CREATE TABLE D_INV_DEATH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
1283      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_DEATH ON  &FACT_CASE .D_INV_DEATH_KEY  =D_INV_DEATH
1284      + .D_INV_DEATH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_DEATH created, with 2029 rows and 2 columns.

1284      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.06 seconds
      

1284      +
;          
1284      +
DATA D_INV_DEATH; SET D_INV_DEATH;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
321                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_DEATH.
NOTE: The data set WORK.D_INV_DEATH has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1285      + PROC SQL;
1285      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1285      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1285      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1285      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1285      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1286      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1286      +
PROC SQL;  
1286      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1287      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1288      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
322                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1289      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

1289      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1290      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1290      +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.01 seconds
      

1290      +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1290      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1290      +
;  DATA    
1291      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1292      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
323                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1292      +
PROC SQL;  
1292      +
  DELETE FROM
1293      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

1293      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1293      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1294      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1295      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1294:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1295      +                                   PROC SQL;
1295      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1296      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1297      + RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
324                                         The SAS System             22:41 Saturday, January 6, 2024

1298      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1298      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1298      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1298      +
PROC SORT  
1299      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1299      +                                                   ;
1299      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1300      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1300      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1301      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
325                                         The SAS System             22:41 Saturday, January 6, 2024

COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1302      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1302      +
PROC SQL;  
1302      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1303      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1303      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1303      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1303      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1304      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1305      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1305:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
326                                         The SAS System             22:41 Saturday, January 6, 2024


1305      +
PROC SQL;  
1305      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1306      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1307      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1308      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1309      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1309      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

1309      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1309      +
PROC SORT DATA=D_INV_METADATA_UNIT
1310      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1310      +                           ;
1310      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1311      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
327                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1311      +
DATA D_INV_METADATA_UNIT; SET
1312      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1313      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1313      +
PROC SQL;  
1313      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1314      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1314      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1314      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1314      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1315      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
328                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1316      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1316:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1316      +
PROC SQL;  
1316      +
  CREATE TABLE D_INV_EPIDEMIOLOGY AS   SELECT
1317      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_EPIDEMIOLOGY ON
1318      + &FACT_CASE .D_INV_EPIDEMIOLOGY_KEY  =D_INV_EPIDEMIOLOGY .D_INV_EPIDEMIOLOGY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_EPIDEMIOLOGY; SET D_INV_EPIDEMIOLOGY;  DROP
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 98.43 percent. 
      Compressed is 4 pages; un-compressed would require 254 pages.
NOTE: Table WORK.D_INV_EPIDEMIOLOGY created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.92 seconds
      cpu time            0.04 seconds
      

1319      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_EPIDEMIOLOGY.
NOTE: The data set WORK.D_INV_EPIDEMIOLOGY has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 98.43 percent. 
      Compressed is 4 pages; un-compressed would require 254 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

329                                         The SAS System             22:41 Saturday, January 6, 2024

1320      + PROC SQL;
1320      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1320      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1320      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1320      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1320      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1321      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1321      +
PROC SQL;  
1321      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1322      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1323      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_HIV'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL
1324      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1324      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1325      + DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_HIV'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1325      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
330                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.14 seconds
      cpu time            0.07 seconds
      

1325      +                                                             DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1325      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1325      +
;          
1325      +
DATA DYNINVLISTING;   SET
1326      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
1327      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1327      +
PROC SQL;  
1327      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
1328      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
331                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1328      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1328      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
1329      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1329:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1330      + PROC SQL;
1330      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
1331      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_HIV'    AND
1332      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1333      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1333      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1333      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
332                                         The SAS System             22:41 Saturday, January 6, 2024

OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1333      +
PROC SORT DATA=D_INV_METADATA_OTH
1334      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1334      +                           ;
1334      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
1335      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1335      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1336      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1337      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1337      +
PROC SQL;  
1337      +
333                                         The SAS System             22:41 Saturday, January 6, 2024

  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1338      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1338      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1338      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1338      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1339      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1340      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1339:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1340      +
PROC SQL;  
1340      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1341      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1342      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_HIV'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1343      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
1344      + NBS_RDB_METADATA.RDB_COLUMN_NM;
334                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1344      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1344      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1344      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1344      +
;          
1344      +
DATA D_INV_METADATA_UNIT; LENGTH
1345      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
1346      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1346      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
1347      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
1348      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;
335                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1348      +
PROC SQL;  
1348      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1349      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1349      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1349      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1350      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
1351      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1350:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1351      +
PROC SQL;  
1351      +
  CREATE TABLE D_INV_HIV AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
336                                         The SAS System             22:41 Saturday, January 6, 2024

1352      + NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_HIV ON  
&FACT_CASE .D_INV_HIV_KEY  =D_INV_HIV .D_INV_HIV_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD =
1353      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.D_INV_HIV increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_HIV created, with 2029 rows and 2 columns.

1353      +                                                                    ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

1353      +                                                                          ;
1353      +                                                                               DATA 
D_INV_HIV; SET D_INV_HIV;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_HIV.
NOTE: The data set WORK.D_INV_HIV has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_HIV increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1354      + PROC SQL;
1354      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1354      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1354      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1354      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
337                                         The SAS System             22:41 Saturday, January 6, 2024

      

1354      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1355      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1355      +
PROC SQL;  
1355      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1356      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1357      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1358      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1358      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1359      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_PATIENT_OBS'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1359      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

1359      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1359      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;
338                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1359      +
;  DATA    
1360      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1361      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1361      +
PROC SQL;  
1361      +
  DELETE FROM
1362      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1362      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1362      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1363      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1364      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1363:200   2326:1     
339                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1364      +                                   PROC SQL;
1364      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1365      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1366      + RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
1367      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1367      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1367      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1367      +
PROC SORT  
1368      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
340                                         The SAS System             22:41 Saturday, January 6, 2024


1368      +                                                   ;
1368      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1369      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1369      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1370      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1371      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1371      +
PROC SQL;  
1371      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1372      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1372      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1372      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
341                                         The SAS System             22:41 Saturday, January 6, 2024

      

1372      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1373      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1374      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1374:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1374      +
PROC SQL;  
1374      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1375      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1376      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1377      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1378      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1378      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1378      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
342                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1378      +
PROC SORT DATA=D_INV_METADATA_UNIT
1379      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1379      +                           ;
1379      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1380      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1380      +
DATA D_INV_METADATA_UNIT; SET
1381      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1382      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1382      +
PROC SQL;  
1382      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1383      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
343                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1383      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1383      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1383      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1384      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1385      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1385:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1385      +
PROC SQL;  
1385      +
  CREATE TABLE D_INV_PATIENT_OBS AS   SELECT
1386      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_PATIENT_OBS ON
1387      + &FACT_CASE .D_INV_PATIENT_OBS_KEY  =D_INV_PATIENT_OBS .D_INV_PATIENT_OBS_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_PATIENT_OBS; SET D_INV_PATIENT_OBS;  DROP
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_PATIENT_OBS created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
344                                         The SAS System             22:41 Saturday, January 6, 2024

      

1388      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_PATIENT_OBS.
NOTE: The data set WORK.D_INV_PATIENT_OBS has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1390      + PROC SQL;
1390      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1390      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1390      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1390      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1390      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1391      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1391      +
PROC SQL;  
345                                         The SAS System             22:41 Saturday, January 6, 2024

1391      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1392      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1393      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1394      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1394      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1395      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_ISOLATE_TRACKING 
'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1395      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

1395      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1395      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1396      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

346                                         The SAS System             22:41 Saturday, January 6, 2024

1396      +              ;
1396      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1397      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1397      +
PROC SQL;  
1398      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1398      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1398      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1399      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1400      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1399:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1400      +                                                         PROC SQL;
1400      +                                                                     CREATE TABLE 
347                                         The SAS System             22:41 Saturday, January 6, 2024

D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1401      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1402      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
1403      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1403      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1403      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1404      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1404      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1404      +
;          
1404      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1405      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1406      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
348                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1406      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
1407      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1408      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1408      +               PROC SQL;
1408      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1408      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1408      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1408      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1409      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1410      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1410:60   2326:1    
349                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1410      +
PROC SQL;  
1410      +
  CREATE TABLE
1411      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1412      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=
1413      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
1414      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1414      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

1414      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1415      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1415      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
350                                         The SAS System             22:41 Saturday, January 6, 2024


1415      +                                                                           ;
1415      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1416      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
1417      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1417      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1418      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1418      +
PROC SQL;  
1419      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1419      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1419      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
351                                         The SAS System             22:41 Saturday, January 6, 2024


1419      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1420      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1421      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1421:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1421      +
PROC SQL;  
1421      +
  CREATE TABLE
1422      + D_INV_ISOLATE_TRACKING AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER
1423      + JOIN  NBS_RDB. D_INV_ISOLATE_TRACKING ON  &FACT_CASE .D_INV_ISOLATE_TRACKING_KEY  
=D_INV_ISOLATE_TRACKING .D_INV_ISOLATE_TRACKING_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_ISOLATE_TRACKING created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.03 seconds
      

1424      + DATA D_INV_ISOLATE_TRACKING; SET D_INV_ISOLATE_TRACKING;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_ISOLATE_TRACKING.
NOTE: The data set WORK.D_INV_ISOLATE_TRACKING has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 44.44 percent. 
352                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1425      + PROC SQL;
1425      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1425      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1425      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1425      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1425      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1426      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1426      +
PROC SQL;  
1426      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1427      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1428      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1429      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1429      +
353                                         The SAS System             22:41 Saturday, January 6, 2024

   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1430      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_LAB_FINDING'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1430      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

1430      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1430      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1430      +
;  DATA    
1431      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1432      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1432      +
354                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
1432      +
  DELETE FROM
1433      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1433      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1433      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1434      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1435      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1434:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1435      +                                   PROC SQL;
1435      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1436      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1437      + RDB_TABLE_NM='D_INV_LAB_FINDING'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
1438      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1438      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.07 seconds
355                                         The SAS System             22:41 Saturday, January 6, 2024

      

1438      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1438      +
PROC SORT  
1439      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1439      +                                                   ;
1439      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1440      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1440      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1441      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1442      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
356                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1442      +
PROC SQL;  
1442      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1443      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1443      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1443      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1443      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1444      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1445      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1445:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1445      +
PROC SQL;  
1445      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1446      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1447      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
357                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_LAB_FINDING'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1448      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1449      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1449      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1449      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1449      +
PROC SORT DATA=D_INV_METADATA_UNIT
1450      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1450      +                           ;
1450      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1451      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
358                                         The SAS System             22:41 Saturday, January 6, 2024


1451      +
DATA D_INV_METADATA_UNIT; SET
1452      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1453      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1453      +
PROC SQL;  
1453      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1454      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1454      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1454      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1454      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1455      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1456      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1456:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
359                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1456      +
PROC SQL;  
1456      +
  CREATE TABLE D_INV_LAB_FINDING AS   SELECT
1457      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_LAB_FINDING ON
1458      + &FACT_CASE .D_INV_LAB_FINDING_KEY  =D_INV_LAB_FINDING .D_INV_LAB_FINDING_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_LAB_FINDING; SET D_INV_LAB_FINDING;  DROP
NOTE: Compressing data set WORK.D_INV_LAB_FINDING increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_LAB_FINDING created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

1459      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_LAB_FINDING.
NOTE: The data set WORK.D_INV_LAB_FINDING has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_LAB_FINDING increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1460      + PROC SQL;
1460      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1460      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

360                                         The SAS System             22:41 Saturday, January 6, 2024

1460      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1460      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1460      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1461      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1461      +
PROC SQL;  
1461      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1462      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1463      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1464      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 5 rows and 5 columns.

1464      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1465      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_MEDICAL_HISTORY' 
 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1465      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

1465      +
361                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 6 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1465      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1466      + SORT_KEY;RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 6 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1466      +              ;
1466      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1467      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 6 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 6 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1467      +
PROC SQL;  
1468      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 5 rows were deleted from WORK.DYNINVLISTING.

1468      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
362                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1468      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1469      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1470      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1469:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1470      +                                                         PROC SQL;
1470      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1471      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1472      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
1473      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1473      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

1473      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1474      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
363                                         The SAS System             22:41 Saturday, January 6, 2024

      

1474      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1474      +
;          
1474      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1475      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1476      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1476      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
1477      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1478      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1478      +               PROC SQL;
1478      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1478      +
364                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1478      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1478      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1479      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1480      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1480:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1480      +
PROC SQL;  
1480      +
  CREATE TABLE
1481      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1482      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
1483      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
1484      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1484      +
 QUIT;     
365                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1484      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1485      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1485      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1485      +                                                                           ;
1485      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1486      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
1487      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1487      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1488      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
366                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

1488      +
PROC SQL;  
1489      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1489      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1489      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1489      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1490      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1491      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1491:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1491      +
PROC SQL;  
1491      +
  CREATE TABLE
1492      + D_INV_MEDICAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
367                                         The SAS System             22:41 Saturday, January 6, 2024

1493      +  NBS_RDB. D_INV_MEDICAL_HISTORY ON  &FACT_CASE .D_INV_MEDICAL_HISTORY_KEY  
=D_INV_MEDICAL_HISTORY .D_INV_MEDICAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 99.41 percent. 
      Compressed is 6 pages; un-compressed would require 1016 pages.
NOTE: Table WORK.D_INV_MEDICAL_HISTORY created, with 2029 rows and 6 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.04 seconds
      

1494      + D_INV_MEDICAL_HISTORY; SET D_INV_MEDICAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_MEDICAL_HISTORY.
NOTE: The data set WORK.D_INV_MEDICAL_HISTORY has 2029 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 99.41 percent. 
      Compressed is 6 pages; un-compressed would require 1016 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1495      + PROC SQL;
1495      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1495      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1495      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1495      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1495      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
368                                         The SAS System             22:41 Saturday, January 6, 2024

1496      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1496      +
PROC SQL;  
1496      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1497      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1498      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1499      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1499      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1500      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_MOTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1500      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.07 seconds
      

1500      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1500      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
369                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1500      +
;  DATA    
1501      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1502      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1502      +
PROC SQL;  
1502      +
  DELETE FROM
1503      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1503      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1503      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1504      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1505      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1504:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
370                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1505      +                                   PROC SQL;
1505      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1506      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1507      + RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
1508      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1508      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1508      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1508      +
PROC SORT DATA=D_INV_METADATA_OTH
1509      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1509      +                           ;
1509      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
371                                         The SAS System             22:41 Saturday, January 6, 2024

UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
1510      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1510      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1511      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1512      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1512      +
PROC SQL;  
1512      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1513      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1513      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1513      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1513      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1514      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
372                                         The SAS System             22:41 Saturday, January 6, 2024

TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1515      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1514:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1515      +
PROC SQL;  
1515      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1516      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1517      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1518      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
1519      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1519      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1519      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1519      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
373                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1519      +
;   DATA   
1520      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
1521      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1521      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
1522      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1523      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1523      +
PROC SQL;  
1523      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1524      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1524      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1524      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
374                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1524      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1525      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1526      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1525:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1526      +
PROC SQL;  
1526      +
  CREATE TABLE D_INV_MOTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
1527      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_MOTHER ON  &FACT_CASE .D_INV_MOTHER_KEY  =D_INV_MOTHER
1528      + .D_INV_MOTHER_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_MOTHER created, with 2029 rows and 2 columns.

1528      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.01 seconds
      

1528      +
;          
1528      +
DATA D_INV_MOTHER; SET D_INV_MOTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
1529      + RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
375                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_MOTHER.
NOTE: The data set WORK.D_INV_MOTHER has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1530      + PROC SQL;
1530      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1530      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1530      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1530      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1530      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1531      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1531      +
PROC SQL;  
1531      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1532      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1533      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
376                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_TABLE_NM='D_INV_OTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1534      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1534      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1535      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_OTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1535      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.07 seconds
      

1535      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1535      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1535      +
;          
1535      +
DATA DYNINVLISTING
1536      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1537      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

377                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1537      +
PROC SQL;  
1537      +
  DELETE FROM
1538      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1538      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1538      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1539      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1540      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1539:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1540      +                                   PROC SQL;
1540      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1541      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1542      + RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
378                                         The SAS System             22:41 Saturday, January 6, 2024

OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
1543      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1543      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

1543      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1543      +
PROC SORT DATA=D_INV_METADATA_OTH
1544      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1544      +                           ;
1544      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
1545      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1545      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1546      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
379                                         The SAS System             22:41 Saturday, January 6, 2024

||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1547      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1547      +
PROC SQL;  
1547      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1548      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1548      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1548      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1548      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1549      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1550      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1549:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1550      +
380                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
1550      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1551      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1552      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1553      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
1554      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1554      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1554      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1554      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1554      +
;   DATA   
1555      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
1556      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
381                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1556      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
1557      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1558      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1558      +
PROC SQL;  
1558      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1559      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1559      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1559      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1559      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1560      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1561      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1560:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
382                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1561      +
PROC SQL;  
1561      +
  CREATE TABLE D_INV_OTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
1562      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_OTHER ON  &FACT_CASE .D_INV_OTHER_KEY  =D_INV_OTHER
1563      + .D_INV_OTHER_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.D_INV_OTHER increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_OTHER created, with 2029 rows and 2 columns.

1563      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.06 seconds
      

1563      +
;          
1563      +
DATA D_INV_OTHER; SET D_INV_OTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_OTHER.
NOTE: The data set WORK.D_INV_OTHER has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_OTHER increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1564      + PROC SQL;
1564      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
383                                         The SAS System             22:41 Saturday, January 6, 2024

      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1564      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1564      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1564      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1564      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1565      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1565      +
PROC SQL;  
1565      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1566      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1567      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1568      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1568      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1569      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH' 
 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1569      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
384                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

1569      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1569      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1570      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1570      +              ;
1570      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1571      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1571      +
PROC SQL;  
1572      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

385                                         The SAS System             22:41 Saturday, January 6, 2024

1572      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1572      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1573      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1574      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1573:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1574      +                                                         PROC SQL;
1574      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1575      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1576      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
1577      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1577      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

1577      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1578      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
386                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1578      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1578      +
;          
1578      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1579      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1580      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1580      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
1581      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1582      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1582      +               PROC SQL;
1582      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
387                                         The SAS System             22:41 Saturday, January 6, 2024

         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1582      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1582      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1582      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1583      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1584      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1584:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1584      +
PROC SQL;  
1584      +
  CREATE TABLE
1585      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1586      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
1587      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
1588      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
388                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1588      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1588      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1589      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1589      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1589      +                                                                           ;
1589      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1590      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
1591      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1591      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1592      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;
389                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1592      +
PROC SQL;  
1593      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1593      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1593      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1593      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1594      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1595      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1595:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1595      +
PROC SQL;  
1595      +
390                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE
1596      + D_INV_PREGNANCY_BIRTH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
1597      +  NBS_RDB. D_INV_PREGNANCY_BIRTH ON  &FACT_CASE .D_INV_PREGNANCY_BIRTH_KEY  
=D_INV_PREGNANCY_BIRTH .D_INV_PREGNANCY_BIRTH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_PREGNANCY_BIRTH created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

1598      + D_INV_PREGNANCY_BIRTH; SET D_INV_PREGNANCY_BIRTH;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_PREGNANCY_BIRTH.
NOTE: The data set WORK.D_INV_PREGNANCY_BIRTH has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1599      + PROC SQL;
1599      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1599      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1599      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1599      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
391                                         The SAS System             22:41 Saturday, January 6, 2024

      

1599      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1600      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1600      +
PROC SQL;  
1600      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1601      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1602      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1603      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1603      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1604      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_RESIDENCY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1604      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

1604      +                                                                         DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1604      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;
392                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1604      +
;  DATA    
1605      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1606      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1606      +
PROC SQL;  
1606      +
  DELETE FROM
1607      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1607      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1607      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1608      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1609      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1608:200   2326:1     
393                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1609      +                                   PROC SQL;
1609      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1610      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1611      + RDB_TABLE_NM='D_INV_RESIDENCY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
1612      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1612      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1612      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1612      +
PROC SORT  
1613      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
394                                         The SAS System             22:41 Saturday, January 6, 2024


1613      +                                                   ;
1613      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1614      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1614      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1615      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1616      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1616      +
PROC SQL;  
1616      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1617      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1617      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1617      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
395                                         The SAS System             22:41 Saturday, January 6, 2024

      

1617      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1618      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1619      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1619:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1619      +
PROC SQL;  
1619      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1620      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1621      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RESIDENCY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1622      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1623      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1623      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

1623      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
396                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1623      +
PROC SORT DATA=D_INV_METADATA_UNIT
1624      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1624      +                           ;
1624      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1625      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1625      +
DATA D_INV_METADATA_UNIT; SET
1626      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1627      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1627      +
PROC SQL;  
1627      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1628      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
397                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1628      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1628      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1628      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1629      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1630      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1630:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1630      +
PROC SQL;  
1630      +
  CREATE TABLE D_INV_RESIDENCY AS   SELECT
1631      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RESIDENCY ON
1632      + &FACT_CASE .D_INV_RESIDENCY_KEY  =D_INV_RESIDENCY .D_INV_RESIDENCY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_RESIDENCY; SET D_INV_RESIDENCY;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_RESIDENCY created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
398                                         The SAS System             22:41 Saturday, January 6, 2024

      

1633      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_RESIDENCY.
NOTE: The data set WORK.D_INV_RESIDENCY has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1634      + PROC SQL;
1634      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1634      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1634      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1634      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1634      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1635      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1635      +
PROC SQL;  
399                                         The SAS System             22:41 Saturday, January 6, 2024

1635      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1636      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1637      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1638      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 18 rows and 5 columns.

1638      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1639      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_RISK_FACTOR'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1639      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

1639      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 19 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 20 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1639      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 20 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 19 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1639      +
;  DATA    
400                                         The SAS System             22:41 Saturday, January 6, 2024

1640      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1641      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 19 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 19 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 84.21 percent. 
      Compressed is 3 pages; un-compressed would require 19 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1641      +
PROC SQL;  
1641      +
  DELETE FROM
1642      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 18 rows were deleted from WORK.DYNINVLISTING.

1642      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1642      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1643      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1644      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1643:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1644      +                                   PROC SQL;
1644      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
401                                         The SAS System             22:41 Saturday, January 6, 2024

DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1645      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1646      + RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
1647      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1647      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1647      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1647      +
PROC SORT  
1648      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1648      +                                                   ;
1648      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1649      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
402                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1649      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1650      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1651      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1651      +
PROC SQL;  
1651      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1652      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1652      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1652      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1652      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1653      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1654      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1654:9   2326:1   
403                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1654      +
PROC SQL;  
1654      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1655      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1656      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1657      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1658      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1658      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1658      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1658      +
PROC SORT DATA=D_INV_METADATA_UNIT
1659      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
404                                         The SAS System             22:41 Saturday, January 6, 2024

      

1659      +                           ;
1659      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1660      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1660      +
DATA D_INV_METADATA_UNIT; SET
1661      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1662      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1662      +
PROC SQL;  
1662      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1663      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1663      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1663      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
405                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1663      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1664      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1665      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1665:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1665      +
PROC SQL;  
1665      +
  CREATE TABLE D_INV_RISK_FACTOR AS   SELECT
1666      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RISK_FACTOR ON
1667      + &FACT_CASE .D_INV_RISK_FACTOR_KEY  =D_INV_RISK_FACTOR .D_INV_RISK_FACTOR_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_RISK_FACTOR; SET D_INV_RISK_FACTOR;  DROP
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.D_INV_RISK_FACTOR created, with 2029 rows and 19 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.65 seconds
      cpu time            0.01 seconds
      

1668      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_RISK_FACTOR.
406                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_RISK_FACTOR has 2029 observations and 19 variables.
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

1670      + PROC SQL;
1670      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1670      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1670      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1670      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1670      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1671      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1671      +
PROC SQL;  
1671      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1672      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1673      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1674      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.
407                                         The SAS System             22:41 Saturday, January 6, 2024


1674      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1675      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1675      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

1675      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1675      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1676      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1676      +              ;
1676      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1677      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
408                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1677      +
PROC SQL;  
1678      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1678      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1678      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1679      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1680      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1679:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1680      +                                                         PROC SQL;
1680      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1681      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1682      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
1683      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1683      +
409                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

1683      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1684      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1684      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1684      +
;          
1684      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1685      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1686      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1686      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
1687      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1688      + OUTPUT; RUN;

410                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1688      +               PROC SQL;
1688      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1688      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1688      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1688      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1689      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1690      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1690:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1690      +
PROC SQL;  
1690      +
  CREATE TABLE
411                                         The SAS System             22:41 Saturday, January 6, 2024

1691      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1692      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
1693      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
1694      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1694      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

1694      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1695      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1695      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1695      +                                                                           ;
1695      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1696      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
1697      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
412                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1697      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1698      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1698      +
PROC SQL;  
1699      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1699      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1699      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1699      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1700      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1701      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1701:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
413                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1701      +
PROC SQL;  
1701      +
  CREATE TABLE
1702      + D_INV_SOCIAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
1703      + NBS_RDB. D_INV_SOCIAL_HISTORY ON  &FACT_CASE .D_INV_SOCIAL_HISTORY_KEY  
=D_INV_SOCIAL_HISTORY .D_INV_SOCIAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_SOCIAL_HISTORY created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      

1704      + D_INV_SOCIAL_HISTORY; SET D_INV_SOCIAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_SOCIAL_HISTORY.
NOTE: The data set WORK.D_INV_SOCIAL_HISTORY has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1705      + PROC SQL;
1705      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1705      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
414                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was inserted into WORK.STD_TESTER.

1705      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1705      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1705      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1706      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1706      +
PROC SQL;  
1706      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1707      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1708      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SYMPTOM'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1709      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1709      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1710      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_SYMPTOM'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1710      +                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

1710      +                                                                       DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

415                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1710      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1710      +
;  DATA    
1711      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1712      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1712      +
PROC SQL;  
1712      +
  DELETE FROM
1713      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1713      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
416                                         The SAS System             22:41 Saturday, January 6, 2024


1713      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1714      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1715      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1714:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1715      +                                   PROC SQL;
1715      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1716      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1717      + RDB_TABLE_NM='D_INV_SYMPTOM'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
1718      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1718      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1718      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

417                                         The SAS System             22:41 Saturday, January 6, 2024

1718      +
PROC SORT
1719      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1719      +                                                   ;
1719      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1720      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1720      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1721      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1722      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1722      +
PROC SQL;  
1722      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1723      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1723      +                                     QUIT;
418                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1723      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1723      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1724      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1725      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1725:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1725      +
PROC SQL;  
1725      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1726      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1727      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_SYMPTOM'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1728      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1729      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1729      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
419                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

1729      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1729      +
PROC SORT DATA=D_INV_METADATA_UNIT
1730      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1730      +                           ;
1730      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1731      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1731      +
DATA D_INV_METADATA_UNIT; SET
1732      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1733      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
420                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

1733      +
PROC SQL;  
1733      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1734      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1734      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1734      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1734      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1735      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1736      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1736:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1736      +
PROC SQL;  
1736      +
  CREATE TABLE D_INV_SYMPTOM AS   SELECT
1737      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
421                                         The SAS System             22:41 Saturday, January 6, 2024

=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_SYMPTOM ON
1738      + &FACT_CASE .D_INV_SYMPTOM_KEY  =D_INV_SYMPTOM .D_INV_SYMPTOM_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_SYMPTOM; SET D_INV_SYMPTOM;  DROP _TEMA001 _TEMA002 _TEMA003
NOTE: Compressing data set WORK.D_INV_SYMPTOM increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_SYMPTOM created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.00 seconds
      

1739      + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_SYMPTOM.
NOTE: The data set WORK.D_INV_SYMPTOM has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SYMPTOM increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1740      + PROC SQL;
1740      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1740      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1740      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1740      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1740      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
422                                         The SAS System             22:41 Saturday, January 6, 2024

1741      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1741      +
PROC SQL;  
1741      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1742      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1743      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1744      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 15 rows and 5 columns.

1744      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1745      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_TREATMENT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1745      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.04 seconds
      

1745      +                                                                         DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 16 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 17 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1745      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 17 observations read from the data set WORK.D_INV_METADATA.
423                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 16 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1745      +
;  DATA    
1746      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1747      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 16 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 16 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 87.50 percent. 
      Compressed is 2 pages; un-compressed would require 16 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1747      +
PROC SQL;  
1747      +
  DELETE FROM
1748      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 15 rows were deleted from WORK.DYNINVLISTING.

1748      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1748      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1749      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1750      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1749:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
424                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1750      +                                   PROC SQL;
1750      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1751      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1752      + RDB_TABLE_NM='D_INV_TREATMENT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
1753      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

1753      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1753      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1753      +
PROC SORT  
1754      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
425                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1754      +                                                   ;
1754      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1755      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1755      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1756      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1757      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1757      +
PROC SQL;  
1757      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1758      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1758      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
426                                         The SAS System             22:41 Saturday, January 6, 2024

      

1758      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1758      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1759      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1760      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1760:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1760      +
PROC SQL;  
1760      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1761      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1762      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_TREATMENT'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1763      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1764      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1764      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
427                                         The SAS System             22:41 Saturday, January 6, 2024

      

1764      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1764      +
PROC SORT DATA=D_INV_METADATA_UNIT
1765      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1765      +                           ;
1765      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1766      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1766      +
DATA D_INV_METADATA_UNIT; SET
1767      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1768      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
428                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

1768      +
PROC SQL;  
1768      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1769      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1769      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1769      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1769      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1770      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1771      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1771:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1771      +
PROC SQL;  
1771      +
  CREATE TABLE D_INV_TREATMENT AS   SELECT
1772      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_TREATMENT ON
429                                         The SAS System             22:41 Saturday, January 6, 2024

1773      + &FACT_CASE .D_INV_TREATMENT_KEY  =D_INV_TREATMENT .D_INV_TREATMENT_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_TREATMENT; SET D_INV_TREATMENT;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_TREATMENT decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.D_INV_TREATMENT created, with 2029 rows and 17 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.04 seconds
      

1774      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_TREATMENT.
NOTE: The data set WORK.D_INV_TREATMENT has 2029 observations and 17 variables.
NOTE: Compressing data set WORK.D_INV_TREATMENT decreased size by 99.56 percent. 
      Compressed is 9 pages; un-compressed would require 2029 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

1775      + PROC SQL;
1775      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1775      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1775      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1775      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1775      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1776      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
430                                         The SAS System             22:41 Saturday, January 6, 2024

'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1776      +
PROC SQL;  
1776      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1777      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1778      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
1779      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1779      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1780      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_TRAVEL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1780      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.06 seconds
      

1780      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1780      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
431                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1780      +
;  DATA    
1781      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1782      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1782      +
PROC SQL;  
1782      +
  DELETE FROM
1783      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1783      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1783      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1784      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1785      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1784:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
432                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1785      +                                   PROC SQL;
1785      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1786      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1787      + RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
1788      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1788      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

1788      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1788      +
PROC SORT DATA=D_INV_METADATA_OTH
1789      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1789      +                           ;
1789      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
433                                         The SAS System             22:41 Saturday, January 6, 2024

1790      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1790      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1791      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1792      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1792      +
PROC SQL;  
1792      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1793      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1793      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1793      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1793      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1794      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
434                                         The SAS System             22:41 Saturday, January 6, 2024

1795      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1794:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1795      +
PROC SQL;  
1795      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1796      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1797      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1798      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
1799      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1799      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

1799      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1799      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
435                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1799      +
;   DATA   
1800      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
1801      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1801      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
1802      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1803      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1803      +
PROC SQL;  
1803      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1804      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1804      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1804      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
436                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1804      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1805      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1806      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1805:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1806      +
PROC SQL;  
1806      +
  CREATE TABLE D_INV_TRAVEL AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
1807      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_TRAVEL ON  &FACT_CASE .D_INV_TRAVEL_KEY  =D_INV_TRAVEL
1808      + .D_INV_TRAVEL_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI');
NOTE: Compressing data set WORK.D_INV_TRAVEL increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_TRAVEL created, with 2029 rows and 2 columns.

1808      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

1808      +
;          
1808      +
DATA D_INV_TRAVEL; SET D_INV_TRAVEL;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
1809      + RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
437                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_TRAVEL.
NOTE: The data set WORK.D_INV_TRAVEL has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_TRAVEL increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1810      + PROC SQL;
1810      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1810      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1810      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1810      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1810      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1811      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1811      +
PROC SQL;  
1811      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1812      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1813      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
438                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND
1814      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1814      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
1815      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_UNDER_CONDITION' 
 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1815      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

1815      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1815      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
1816      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1816      +              ;
1816      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
1817      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

439                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1817      +
PROC SQL;  
1818      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1818      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1818      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1819      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
1820      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1819:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1820      +                                                         PROC SQL;
1820      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
1821      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
1822      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
440                                         The SAS System             22:41 Saturday, January 6, 2024

1823      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1823      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1823      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
1824      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1824      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1824      +
;          
1824      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
1825      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
1826      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1826      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
441                                         The SAS System             22:41 Saturday, January 6, 2024

1827      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
1828      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1828      +               PROC SQL;
1828      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1828      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1828      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1828      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
1829      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
1830      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1830:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
442                                         The SAS System             22:41 Saturday, January 6, 2024


1830      +
PROC SQL;  
1830      +
  CREATE TABLE
1831      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1832      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
1833      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
1834      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1834      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1834      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
1835      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1835      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1835      +                                                                           ;
1835      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
1836      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
443                                         The SAS System             22:41 Saturday, January 6, 2024

1837      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1837      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
1838      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1838      +
PROC SQL;  
1839      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1839      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1839      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1839      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
1840      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
1841      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
444                                         The SAS System             22:41 Saturday, January 6, 2024

SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1841:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1841      +
PROC SQL;  
1841      +
  CREATE TABLE
1842      + D_INV_UNDER_CONDITION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
1843      +  NBS_RDB. D_INV_UNDER_CONDITION ON  &FACT_CASE .D_INV_UNDER_CONDITION_KEY  
=D_INV_UNDER_CONDITION .D_INV_UNDER_CONDITION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_UNDER_CONDITION created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

1844      + D_INV_UNDER_CONDITION; SET D_INV_UNDER_CONDITION;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_UNDER_CONDITION.
NOTE: The data set WORK.D_INV_UNDER_CONDITION has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1845      + PROC SQL;
1845      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
445                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1845      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1845      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1845      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1845      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1846      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1846      +
PROC SQL;  
1846      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1847      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1848      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1849      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1849      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
1850      + WHERE DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_VACCINATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1850      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.03 seconds
446                                         The SAS System             22:41 Saturday, January 6, 2024

      

1850      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1850      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1850      +
;  DATA    
1851      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
1852      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1852      +
PROC SQL;  
1852      +
  DELETE FROM
1853      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

447                                         The SAS System             22:41 Saturday, January 6, 2024

1853      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1853      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1854      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
1855      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1854:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1855      +                                   PROC SQL;
1855      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
1856      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
1857      + RDB_TABLE_NM='D_INV_VACCINATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
1858      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1858      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1858      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
448                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1858      +
PROC SORT  
1859      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1859      +                                                   ;
1859      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
1860      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1860      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
1861      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
1862      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1862      +
PROC SQL;  
1862      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
1863      + (SORT_KEY) FROM DYNINVLISTING_OTH);
449                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1863      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1863      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1863      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
1864      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
1865      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1865:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1865      +
PROC SQL;  
1865      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
1866      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
1867      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_VACCINATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1868      + DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1869      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.
450                                         The SAS System             22:41 Saturday, January 6, 2024


1869      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

1869      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1869      +
PROC SORT DATA=D_INV_METADATA_UNIT
1870      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1870      +                           ;
1870      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
1871      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1871      +
DATA D_INV_METADATA_UNIT; SET
1872      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1873      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
451                                         The SAS System             22:41 Saturday, January 6, 2024

OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1873      +
PROC SQL;  
1873      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
1874      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1874      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1874      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1874      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
1875      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
1876      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1876:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1876      +
452                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
1876      +
  CREATE TABLE D_INV_VACCINATION AS   SELECT
1877      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_VACCINATION ON
1878      + &FACT_CASE .D_INV_VACCINATION_KEY  =D_INV_VACCINATION .D_INV_VACCINATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI'); 
;QUIT;;    DATA D_INV_VACCINATION; SET D_INV_VACCINATION;  DROP
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_VACCINATION created, with 2029 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

1879      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_VACCINATION.
NOTE: The data set WORK.D_INV_VACCINATION has 2029 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1880      + PROC SQL;
1880      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1880      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1880      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1880      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
453                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1880      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
1881      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1881      +
PROC SQL;  
1881      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
1882      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
1883      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_STD'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL
1884      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

1884      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
1885      + DATAMART_NM='AL_LTBI'),  RDB_TABLE_NM='D_INV_STD'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

1885      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

1885      +                                                             DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1885      +
454                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1885      +
;          
1885      +
DATA DYNINVLISTING;   SET
1886      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
1887      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1887      +
PROC SQL;  
1887      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
1888      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

1888      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1888      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
1889      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

455                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1889:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1890      + PROC SQL;
1890      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
1891      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_STD'    AND
1892      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1893      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

1893      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      

1893      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1893      +
PROC SORT DATA=D_INV_METADATA_OTH
1894      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
456                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

1894      +                           ;
1894      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
1895      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1895      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
1896      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
1897      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1897      +
PROC SQL;  
1897      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
1898      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

1898      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1898      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
457                                         The SAS System             22:41 Saturday, January 6, 2024

      

1898      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
1899      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
1900      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1899:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1900      +
PROC SQL;  
1900      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
1901      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
1902      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_STD'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND QUESTION_GROUP_SEQ_NBR
1903      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
1904      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

1904      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1904      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
458                                         The SAS System             22:41 Saturday, January 6, 2024


1904      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1904      +
;          
1904      +
DATA D_INV_METADATA_UNIT; LENGTH
1905      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
1906      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1906      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
1907      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
1908      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1908      +
PROC SQL;  
1908      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

1909      + QUIT;
459                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1909      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1909      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
1910      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
1911      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1910:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1911      +
PROC SQL;  
1911      +
       CREATE TABLE D_INV_STD AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
1912      + NBS_RDB.SUMM_DATAMART;
NOTE: Compressing data set WORK.D_INV_STD increased size by 44.44 percent. 
      Compressed is 13 pages; un-compressed would require 9 pages.
NOTE: Table WORK.D_INV_STD created, with 2029 rows and 2 columns.

1912      +                        ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

1912      +                              ;
1912      +                                   DATA D_INV_STD; SET D_INV_STD;  DROP _TEMA001 _TEMA002 
_TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

NOTE: Compression was disabled for data set WORK.D_INV_STD because compression overhead would 
      increase the size of the data set.
460                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2029 observations read from the data set WORK.D_INV_STD.
NOTE: The data set WORK.D_INV_STD has 2029 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1913      + PROC SQL;
1913      +           CREATE TABLE ORGANIZATION_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
1914      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
1915      + IS NOT NULL AND RDB_TABLE_NM ='D_ORGANIZATION' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.ORGANIZATION_METADATA created, with 1 rows and 3 columns.

1915      +                                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

1915      +                                                                            DATA 
ORGANIZATION_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET ORGANIZATION_METADATA;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1915      +
PROC SORT DATA=ORGANIZATION_METADATA NODUPKEY; BY
1916      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGANIZATION_METADATA has 1 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
461                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1916      +              ;
1916      +                PROC SQL;
1916      +                          CREATE TABLE ORGANIZATION  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.ORGANIZATION because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.ORGANIZATION created, with 0 rows and 1 columns.
1916      +                                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1916      +                                                                                     DATA 
ORGANIZATION_METADATA;   SET ORGANIZATION_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF 
FIRST.SORT_KEY THEN  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
1917      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
1918      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY';    KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY';  DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1,
1919      + INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL';  QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 
1, INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC';  UID= USER_DEFINED_COLUMN_NM;  call 
execute('%POPULATE_ORGANIZATION('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||
1920      + KEY||','||  DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1919:234   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 1 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 1 observations and 9 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
2         + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
3         + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
ORG_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
462                                         The SAS System             22:41 Saturday, January 6, 2024

INNER JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
4         + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
ORG_AS_REPORTER_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 76.47 percent. 
      Compressed is 16 pages; un-compressed would require 68 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 2029 rows and 15 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.04 seconds
      

4         +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH REPORTING_FACILITY_DETAIL  
$2000;
5         +   IF   ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; 
REPORTING_FACILITY_KEY=ORGANIZATION_KEY; REPORTING_FACILITY_QEC =ORGANIZATION_QUICK_CODE; 
REPORTING_FACILITY_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN CITY_STATE_ZIP 
=PROPCASE
6         +(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF 
LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || TRIM
7         +(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM(ORGANIZATION_LOCAL_ID))>0 THEN 
REPORTING_FACILITY_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN REPORTING_FACILITY_DETAIL =TRIM(REPORTING_FACILITY_DETAIL) 
||'<br>' ||
8         + PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN 
REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) ||'<br>' 
||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0
9         + then REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM
10        +(CITY_STATE_ZIP) ; IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 then REPORTING_FACILITY_DETAIL= TRIM
11        +(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| ', ext. ' || TRIM
12        +(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br> ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN
13        +(TRIM(REPORTING_FACILITY_DETAIL))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME 
ORGANIZATION_STREET_ADDRESS_1 ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY
14        + ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP 
ORGANIZATION_CITY ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE ORG_AS_REPORTER_KEY;  
RUN;

NOTE: There were 2029 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 2029 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 94.14 percent. 
      Compressed is 17 pages; un-compressed would require 290 pages.
463                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

14        +
PROC SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY
15        +;RUN;

NOTE: There were 2029 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 2029 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 94.14 percent. 
      Compressed is 17 pages; un-compressed would require 290 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

15        +       DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 2029 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 2029 observations and 6 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 94.14 percent. 
      Compressed is 17 pages; un-compressed would require 290 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1921      + PROC SQL;
1921      +           CREATE TABLE PROVIDER_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
1922      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
1923      + IS NOT NULL AND RDB_TABLE_NM ='D_PROVIDER' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PROVIDER_METADATA created, with 3 rows and 3 columns.

1923      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

1923      +                                                                        DATA 
PROVIDER_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PROVIDER_METADATA;    SORT_KEY+1;  OUTPUT;      
 RUN;

NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
464                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.PROVIDER_METADATA has 4 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1923      +
PROC SORT DATA=PROVIDER_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 4 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1923      +
; PROC     
1924      + SQL;
1924      +      CREATE TABLE PROVIDER  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.PROVIDER because compression overhead would increase 
      the size of the data set.
NOTE: Table WORK.PROVIDER created, with 0 rows and 1 columns.
1924      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1924      +                                                             DATA PROVIDER_METADATA;   SET 
PROVIDER_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF FIRST.SORT_KEY THEN  IF part_type_cd= 
'CASupervisorOfPHC' THEN
1925      + PART_TYPE_CD='SUPRVSR_OF_CASE_ASSGNMENT_KEY';  IF part_type_cd= 'ClosureInvestgrOfPHC' 
THEN PART_TYPE_CD='CLOSED_BY_KEY';  IF part_type_cd= 'DispoFldFupInvestgrOfPHC' THEN 
PART_TYPE_CD='DISPOSITIONED_BY_KEY';  IF part_type_cd= 'FldFupInvestgrOfPHC' THEN
1926      + PART_TYPE_CD='INVSTGTR_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupProvOfPHC' THEN 
PART_TYPE_CD='PROVIDER_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupSupervisorOfPHC' THEN 
PART_TYPE_CD='SUPRVSR_OF_FLD_FOLLOW_UP_KEY';  IF part_type_cd=
1927      + 'InitFldFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_ASGNED_FLD_FOLLOW_UP_KEY';  IF 
part_type_cd= 'InitFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_FOLLOW_UP_INVSTGTR_KEY';  IF 
part_type_cd= 'InitInterviewerOfPHC' THEN
1928      + PART_TYPE_CD='INIT_ASGNED_INTERVIEWER_KEY';  IF part_type_cd= 'InterviewerOfPHC' THEN 
PART_TYPE_CD='INTERVIEWER_ASSIGNED_KEY';  IF part_type_cd= 'InvestgrOfPHC' THEN 
PART_TYPE_CD='INVESTIGATOR_KEY';  IF part_type_cd= 'PerAsProviderOfDelivery' THEN
1929      + PART_TYPE_CD='DELIVERING_MD_KEY';  IF part_type_cd= 'PerAsProviderOfOBGYN' THEN 
PART_TYPE_CD='MOTHER_OB_GYN_KEY';  IF part_type_cd= 'PerAsProvideroOfPediatrics' THEN 
PART_TYPE_CD='PEDIATRICIAN_KEY';  IF part_type_cd= 'PerAsReporterOfPHC' THEN
1930      + PART_TYPE_CD='PERSON_AS_REPORTER_KEY';  IF part_type_cd= 'PhysicianOfPHC' THEN 
PART_TYPE_CD='PHYSICIAN_KEY';  IF part_type_cd= 'SurvInvestgrOfPHC' THEN 
465                                         The SAS System             22:41 Saturday, January 6, 2024

PART_TYPE_CD='SURVEILLANCE_INVESTIGATOR_KEY';  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
1931      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
1932      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY'; KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY'; DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, INDEX
1933      +(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL'; QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC'; UID = USER_DEFINED_COLUMN_NM; call 
execute('%POPULATE_PROVIDER('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||  KEY||','||
1934      + DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      1933:222   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 9 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
2         + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
3         + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
INVESTIGATOR_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON
4         + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . INVESTIGATOR_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 85.98 percent. 
      Compressed is 15 pages; un-compressed would require 107 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 2029 rows and 20 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.03 seconds
      

4         +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
5         + PHC_INV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  PHC_INV_KEY=PROVIDER_KEY;  PHC_INV_QEC =PROVIDER_QUICK_CODE;  
466                                         The SAS System             22:41 Saturday, January 6, 2024

PHC_INV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
6         + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
7         +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
8         +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
9         + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
10        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
11        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
12        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN PHC_INV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHC_INV_DETAIL 
=TRIM(PHC_INV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
13        + PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
14        +(TRIM(CITY_STATE_ZIP))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHC_INV_DETAIL= 
TRIM(PHC_INV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
15        +(PROVIDER_PHONE_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| ', ext. ' || TRIM
16        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHC_INV_DETAIL))>0 then
17        + PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
18        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE INVESTIGATOR_KEY;  RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.81 percent. 
      Compressed is 18 pages; un-compressed would require 291 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

18        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
467                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.81 percent. 
      Compressed is 18 pages; un-compressed would require 291 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

18        +
  DATA     
19        + PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 93.81 percent. 
      Compressed is 18 pages; un-compressed would require 291 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

20        + PROC SQL;
20        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
21        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
22        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PHYSICIAN_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON
23        + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PHYSICIAN_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 85.05 percent. 
      Compressed is 16 pages; un-compressed would require 107 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 2029 rows and 20 columns.

23        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

23        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH PHYS_DETAIL
24        + $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN PROVIDER_KEY=.;  
PHYS_KEY=PROVIDER_KEY;  PHYS_QEC =PROVIDER_QUICK_CODE;  PHYS_UID=PROVIDER_UID;   IF 
LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP =PROPCASE(TRIM(PROVIDER_CITY));
25        + IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
468                                         The SAS System             22:41 Saturday, January 6, 2024

PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE(TRIM(PROVIDER_ZIP)) ;
26        + PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF LENGTHN(TRIM(PROVIDER_NAME))>0 
AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| 
PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0
27        + AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM
28        +(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME
29        + =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN
30        +(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| 
TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE 
))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If LENGTHN(TRIM
31        +(PROVIDER_LOCAL_ID))>0 THEN PHYS_DETAIL ='<b></b>' ||TRIM(PROVIDER_LOCAL_ID);  If 
LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHYS_DETAIL =TRIM(PHYS_DETAIL) ||'<br>' || PROVIDER_NAME;  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN PHYS_DETAIL=  TRIM
32        +(PHYS_DETAIL) ||'<br>' ||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN PHYS_DETAIL=  TRIM(PHYS_DETAIL) || '<br>' || 
PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 THEN
33        + PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ;  IF 
LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || 
PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 THEN PHYS_DETAIL= TRIM
34        +(PHYS_DETAIL)|| '<br>' || TRIM(PROVIDER_PHONE_WORK) ;  IF 
LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| ', ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM
35        +(PROVIDER_PHONE_WORK))=0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| '<br> ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHYS_DETAIL))>0 
then PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>';     DROP
36        + PROVIDER_NAME PROVIDER_FIRST_NAME PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME 
PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK    PROVIDER_STREET_ADDRESS_1 
PROVIDER_STREET_ADDRESS_2 PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY
37        + PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE 
PROVIDER_QUICK_CODE PHYSICIAN_KEY;  RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.47 percent. 
      Compressed is 19 pages; un-compressed would require 291 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

37        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.47 percent. 
469                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 19 pages; un-compressed would require 291 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

37        +
DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY
38        + INVESTIGATION_KEY; RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 2029 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 2029 observations and 11 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 95.42 percent. 
      Compressed is 31 pages; un-compressed would require 677 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

39        + PROC SQL;
39        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
40        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
41        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PERSON_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART INNER JOIN  NBS_RDB. F_PAGE_CASE
42        + ON SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PERSON_AS_REPORTER_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 89.72 percent. 
      Compressed is 11 pages; un-compressed would require 107 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 2029 rows and 20 columns.

42        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

42        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
43        + RPT_PRV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  RPT_PRV_KEY=PROVIDER_KEY;  RPT_PRV_QEC =PROVIDER_QUICK_CODE;  
RPT_PRV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
44        + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
45        +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
470                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
46        +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
47        + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
48        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
49        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
50        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN RPT_PRV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN RPT_PRV_DETAIL 
=TRIM(RPT_PRV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
51        + RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
52        +(TRIM(CITY_STATE_ZIP))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN RPT_PRV_DETAIL= 
TRIM(RPT_PRV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
53        +(PROVIDER_PHONE_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| ', ext. ' || TRIM
54        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(RPT_PRV_DETAIL))>0 then
55        + RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
56        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE PERSON_AS_REPORTER_KEY;  RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 95.53 percent. 
      Compressed is 13 pages; un-compressed would require 291 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

56        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 2029 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 95.53 percent. 
      Compressed is 13 pages; un-compressed would require 291 pages.
NOTE: PROCEDURE SORT used (Total process time):
471                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

57        + DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 2029 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 2029 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 2029 observations and 15 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 96.26 percent. 
      Compressed is 38 pages; un-compressed would require 1015 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1935      + PROC SQL;
1935      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
1936      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')
1937      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and 
(code_set_group_id >0  OR data_type in ( 'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
1938      + RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_INIT created, with 21 rows and 5 columns.

1938      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

1938      +                        PROC SQL;
1938      +                                  CREATE TABLE METADATA_UNIT AS   SELECT  
INIT.DATAMART_NM, RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM, 
OTHER_VALUE_IND_CD FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN
1939      + NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE
1940      + WHERE DATAMART_NM='AL_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and 
(code_set_group_id >0  OR data_type in ( 'Coded','CODED') ) AND
1941      + OTHER_VALUE_IND_CD='T' ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_UNIT created, with 2 rows and 6 columns.

1941      +                                                QUIT;
472                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

1941      +                                                       DATA METADATA_UNIT; SET 
METADATA_UNIT; LENGTH RDB_COLUMN_NM3 $22; LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  
RDB_COLUMN_NM2= TRIM(RDB_COLUMN_NM3) || '_OTH';  USER_DEFINED_COLUMN_NM =
1942      + TRIM(USER_DEFINED_COLUMN_NM)|| '_OTH';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP 
RDB_COLUMN_NM2 RDB_COLUMN_NM3; RUN;

NOTE: There were 2 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 2 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1942      +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: There were 2 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 2 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1942      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 2 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 21 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 23 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1942      +
  DATA     
1943      + METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
1944      + USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
1945      +(USER_DEFINED_COLUMN_NM|| '_4'); 
473                                         The SAS System             22:41 Saturday, January 6, 2024

USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
1946      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
1947      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
1948      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
1949      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 23 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 23 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 91.30 percent. 
      Compressed is 2 pages; un-compressed would require 23 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1949      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 23 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 23 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 91.30 percent. 
      Compressed is 2 pages; un-compressed would require 23 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1949      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
1950      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 23 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 115 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1950      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
474                                         The SAS System             22:41 Saturday, January 6, 2024

      1950:188   
NOTE: There were 115 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 115 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1950      +
PROC SQL;  
1950      +
 CREATE TABLE METADATA_OUT as select
1951      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: Table WORK.METADATA_OUT created, with 115 rows and 4 columns.

1951      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1951      +                                                                 PROC SQL;
1951      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

1951      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1951      +
PROC SQL;  
1951      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 91.30 percent. 
      Compressed is 2 pages; un-compressed would require 23 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 23 rows and 4 columns.

1951      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

475                                         The SAS System             22:41 Saturday, January 6, 2024

1951      +
PROC SQL;
1951      +
  CREATE   
1952      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  UPCASE(METADATA_OUT1.RDB_COLUMN_NM) = 
UPCASE(METADATA_OUT.RDB_COLUMN_NM);
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: Table WORK.METADATA_OUT created, with 115 rows and 5 columns.

1952      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1952      +
DATA METADATA_OUT; SET
1953      + METADATA_OUT;   ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), 
comma20.);  DROP BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 115 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 115 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1953      +
PROC SQL;  
1953      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
1953      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

1953      +
  UPDATE   
1954      + STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

1954      +                                                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
476                                         The SAS System             22:41 Saturday, January 6, 2024

      

1954      +                                                                                   DATA 
_NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF 
COUNTSTD<2 then call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1955      + PROC SQL;
1955      +             CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, 
RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 23 rows and 4 columns.

1955      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1955      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1
1956      +;  OUTPUT;       RUN;

NOTE: There were 23 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 24 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1956      +                        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 24 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 23 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1956      +                                                                                       ;   
                                                                                                      
                                                     DATA
477                                         The SAS System             22:41 Saturday, January 6, 2024

1957      + DYNINVLISTING;                                                                            
                                                               SET D_INV_REPEAT_METADATA;
1958      +                                                           BY SORT_KEY;
1959      +                                                                                           
                         LENGTH RDB_COLUMN_NAME_LIST $15000;
1960      +                 RETAIN RDB_COLUMN_NAME_LIST;
1961      +                                                                          LENGTH 
RDB_COLUMN_LIST $15000;                                                                               
                                               RETAIN RDB_COLUMN_LIST;
1962      +
1963      +                                LENGTH RDB_COLUMN_COMMA_LIST $15000;                       
                                                                                                 
RETAIN RDB_COLUMN_COMMA_LIST;
1964      +                                                                                           
                                                                                                      
                                                    IF
1965      + FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN                                          
                                                                     USER_DEFINED_COLUMN_NAME = 
COMPRESS( RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
1966      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN                                                                             
                                  RDB_COLUMN_NAME = COMPRESS(
1967      + RDB_COLUMN_NM);                                                                           
                                IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
(USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);
1968      +                                                                                           
                                                                                      IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_LIST = (RDB_COLUMN_NAME || '
1969      + ' ||  RDB_COLUMN_LIST);                                                       IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  
RDB_COLUMN_COMMA_LIST);                                          OUTPUT;     DROP
1970      + datamart_nm USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 23 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 23 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 91.30 percent. 
      Compressed is 2 pages; un-compressed would require 23 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1970      +
PROC SQL;  
1971      +                                                                                           
              DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 22 rows were deleted from WORK.DYNINVLISTING.

1972      +      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
478                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

1972      +            DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');   CALL 
SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1972      +
DATA DYNINVLISTING; SET DYNINVLISTING;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX
1973      +('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN
1974      +(RDB_COLUMN_NAME_LIST)-1);  CALL SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL 
SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);  CALL SYMPUTX('D_REPEAT_COMMA_NAME', 
RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

1974      +
PROC SQL;  
1974      +
  CREATE TABLE REPEAT_BLOCK AS   SELECT
1975      + &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY, 
D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY
1976      +  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB.D_INVESTIGATION_REPEAT ON  
&FACT_CASE .D_INVESTIGATION_REPEAT_KEY  =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1; ; QUIT;    PROC SQL;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.67 percent. 
      Compressed is 30 pages; un-compressed would require 8957 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 8957 rows and 27 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.36 seconds
      cpu time            0.18 seconds
      

1977      + DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

1977      +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
479                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

1977      +                                                                               PROC SORT 
DATA=REPEAT_BLOCK ; BY INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 8957 observations and 27 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.67 percent. 
      Compressed is 30 pages; un-compressed would require 8957 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.59 seconds
      cpu time            0.59 seconds
      

1977      +
PROC TRANSPOSE DATA=REPEAT_BLOCK OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY
1978      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 206011 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 96.74 percent. 
      Compressed is 960 pages; un-compressed would require 29431 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.26 seconds
      cpu time            0.26 seconds
      

1978      +                                                         DATA REPEAT_BLOCK_OUT; set 
REPEAT_BLOCK_OUT; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 206011 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 206011 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.86 percent. 
      Compressed is 1219 pages; un-compressed would require 29431 pages.
NOTE: DATA statement used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds
      

1978      +
PROC SQL;  
1978      +
 CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN
1979      + NBS_ODS.NBS_UI_METADATA   ON  NBS_RDB_METADATA.NBS_UI_METADATA_UID 
=NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE  BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND
1980      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
1981      + RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
480                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 21 rows and 2 columns.

1981      +                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

1981      +                                PROC SQL;
1981      +                                          CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM, 
 RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID
1982      + WHERE BLOCK_NM IS NOT NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND RDB_TABLE_NM
1983      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 'Coded' 
,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 21 rows and 2 columns.

1983      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

1983      +
PROC SQL;  
1983      +
 CREATE TABLE BLOCK_DATA_OTH AS SELECT BLOCK_NM,  RDB_COLUMN_NM FROM
1984      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
1985      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT' 
 and (code_set_group_id >0  OR data_type in ( 'Coded'
1986      + ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 21 rows and 2 columns.

1986      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

1986      +                                                                            DATA 
BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM $30; LENGTH RDB_COLUMN_NM2 $22; 
RDB_COLUMN_NM2= RDB_COLUMN_NM; RDB_COLUMN_NM=COMPRESS(RDB_COLUMN_NM2 || '_OTH'); DROP
1987      + RDB_COLUMN_NM2; RUN;
481                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 21 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 21 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1987      +                       PROC SQL;
1987      +                                 CREATE TABLE BLOCK_DATA AS SELECT * FROM BLOCK_DATA_PL 
UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 42 rows and 2 columns.

1987      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1987      +
PROC SQL;  
1987      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT
1988      + INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM =BLOCK_DATA.BLOCK_NM  AND 
UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.56 percent. 
      Compressed is 155 pages; un-compressed would require 3494 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 24454 rows and 7 columns.

1988      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.40 seconds
      

1988      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT
1989      + BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
482                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

1989      +                                         PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; 
BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 24454 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 24454 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.56 percent. 
      Compressed is 155 pages; un-compressed would require 3494 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

1989      +
DATA REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM
1990      + BLOCK_NM ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  FORMAT 
ANSWER_DESCCHECK $10.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;
1991      +  IF FIRST.RDB_COLUMN_NM  THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; 
ANSWER_DESC21 = '';  END;  I+1;  IF I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND 
LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN
1992      + ANSWER_DESC21 =  LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ 
'|| LEFT(TRIM(col1)) ;  END;  IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ col1 I J; RUN;

NOTE: There were 24454 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 21392 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 99.02 percent. 
      Compressed is 105 pages; un-compressed would require 10697 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
      

1992      +
DATA REPEAT_BLOCK_OUT_BASE ; SET
1993      + REPEAT_BLOCK_OUT_BASE ; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 24454 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 24454 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.56 percent. 
      Compressed is 155 pages; un-compressed would require 3494 pages.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

1993      +                                                       DATA REPEAT_BLOCK_OUT_BASE; SET 
REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN
483                                         The SAS System             22:41 Saturday, January 6, 2024

1994      + COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 
THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 
=' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF
1995      + ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
1996      + 4 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF
1997      + ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: There were 24454 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 24454 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 97.93 percent. 
      Compressed is 169 pages; un-compressed would require 8152 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      

1997      +                                                   PROC SQL;
1997      +                                                             CREATE TABLE METADATA_OUT as 
select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.26 percent. 
      Compressed is 2 pages; un-compressed would require 115 pages.
NOTE: Table WORK.METADATA_OUT created, with 115 rows and 5 columns.

1997      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1997      +
PROC SQL;  
1997      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM
1998      + METADATA_OUT LEFT OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  
= UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR 
=REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM =
1999      + REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.10 percent. 
      Compressed is 220 pages; un-compressed would require 24456 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 24456 rows and 12 columns.

1999      +                                  QUIT;
484                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           3.07 seconds
      cpu time            3.82 seconds
      

1999      +                                           PROC SORT DATA=METADATA_MERGED_INIT ; BY 
INVESTIGATION_KEY;RUN;

NOTE: There were 24456 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 24456 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.10 percent. 
      Compressed is 220 pages; un-compressed would require 24456 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.65 seconds
      cpu time            0.65 seconds
      

1999      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_VARCHAR;  VAR DATA_VALUE;  ID COL1; 
    BY INVESTIGATION_KEY; RUN;

WARNING: 46 observations omitted due to missing ID values.
NOTE: There were 24456 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 1756 observations and 71 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.15 seconds
      cpu time            0.15 seconds
      

1999      +
  DATA     
2000      + INVESTIGATION_REPEAT_VARCHAR; SET INVESTIGATION_REPEAT_VARCHAR; DROP _NAME_; RUN;

NOTE: There were 1756 observations read from the data set WORK.INVESTIGATION_REPEAT_VARCHAR.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 1756 observations and 70 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

2000      +                                                                                      PROC 
SQL;
2000      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM 
D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 23 rows and 2 columns.

2000      +
485                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2000      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH
2001      + USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = 
COMPRESS(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 23 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 23 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2001      +
PROC SQL;  
2001      +
 CREATE TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*,
2002      + REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_ALL  ON UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = 
UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.34 percent. 
      Compressed is 141 pages; un-compressed would require 21392 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 21392 rows and 7 columns.

2002      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.86 seconds
      cpu time            0.85 seconds
      

2002      +
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 21392 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 21392 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.34 percent. 
      Compressed is 141 pages; un-compressed would require 21392 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
      

2003      + PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_VARCHAR_ALL;  VAR 
ANSWER_DESC21;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 21392 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
486                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 1755 observations and 25 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1755 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.17 seconds
      cpu time            0.15 seconds
      

2003      +
DATA REPEAT_BLOCK_VARCHAR_ALL; SET REPEAT_BLOCK_VARCHAR_ALL; DROP _NAME_; RUN;

NOTE: There were 1755 observations read from the data set WORK.REPEAT_BLOCK_VARCHAR_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 1755 observations and 24 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1755 pages.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.12 seconds
      

2005      + PROC SQL;
2005      +           CREATE TABLE METADATA AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2006      + NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND
2007      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and data_type in ( 'DATETIME','DATE', 
'Date','Date/Time')  and code_set_group_id is null ORDER BY
2008      + RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA created, with 9 rows and 5 columns.

2008      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

2008      +                        DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000
2009      +;  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
2010      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
2011      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
487                                         The SAS System             22:41 Saturday, January 6, 2024

2012      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
2013      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
2014      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 9 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 9 observations and 10 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2014      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 9 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 9 observations and 10 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2014      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
2015      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 9 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 45 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2015      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2015:187   
NOTE: There were 45 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 45 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: DATA statement used (Total process time):
488                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

2015      +
PROC SQL;  
2015      +
 CREATE TABLE METADATA_OUT as select
2016      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: Table WORK.METADATA_OUT created, with 45 rows and 4 columns.

2016      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2016      +                                                                PROC SQL;
2016      +                                                                           DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

2016      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2016      +
PROC SQL;  
2016      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 9 rows and 4 columns.

2016      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2016      +
PROC SQL;  
2016      +
  CREATE TABLE
2017      + METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1  FROM 
METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = METADATA_OUT.RDB_COLUMN_NM;
489                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: Table WORK.METADATA_OUT created, with 45 rows and 5 columns.

2017      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2017      +
DATA METADATA_OUT; SET METADATA_OUT;
2018      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 45 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 45 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2018      +
PROC SQL;  
2018      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2018      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2018      +
  UPDATE STD_TESTER SET
2019      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2019      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2019      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
490                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2019      +
PROC SQL;  
2019      +
  CREATE   
2020      + TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 9 rows and 4 columns.

2020      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2020      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
2021      + RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 10 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2021      +        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 9 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2021      +                                                                       ;
2021      +
DATA DYNINVLISTING;
2022      +                                                                                           
                                          SET D_INV_REPEAT_METADATA;
2023      +                                      BY SORT_KEY;
491                                         The SAS System             22:41 Saturday, January 6, 2024

2024      +                                                                                           
    LENGTH RDB_COLUMN_NAME_LIST $15000;
2025      + RETAIN RDB_COLUMN_NAME_LIST;
2026      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
2027      +
2028      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
2029      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
2030      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2031      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
2032      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
2033      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
2034      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
2035      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 9 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 9 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2035      +
PROC SQL;  
2036      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 8 rows were deleted from WORK.DYNINVLISTING.

2036      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
492                                         The SAS System             22:41 Saturday, January 6, 2024


2037      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2037      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
2038      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2038      +                                  DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2039      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
2040      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2040      +                                                                     PROC SQL;
2040      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
2041      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
2042      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 34.97 percent. 
      Compressed is 93 pages; un-compressed would require 143 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 8957 rows and 13 columns.

2042      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.04 seconds
493                                         The SAS System             22:41 Saturday, January 6, 2024

      

2042      +
PROC SQL;  
2042      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

2042      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2042      +
PROC SORT DATA=REPEAT_BLOCK ; BY
2043      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 8957 observations and 13 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 34.97 percent. 
      Compressed is 93 pages; un-compressed would require 143 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2043      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 80613 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 35.96 percent. 
      Compressed is 771 pages; un-compressed would require 1204 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

2043      +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
2044      + RDB_COLUMN_NM = _NAME_; coloumnText=ANSWER_TXT;  rename col1=dateColumn; RUN;

NOTE: Variable ANSWER_TXT is uninitialized.
NOTE: There were 80613 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 80613 observations and 9 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 31.75 percent. 
      Compressed is 1079 pages; un-compressed would require 1581 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      
494                                         The SAS System             22:41 Saturday, January 6, 2024


2044      +                                                                                PROC SQL;
2044      +                                                                                          
CREATE TABLE BLOCK_DATA AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN 
NBS_ODS.NBS_UI_METADATA   ON
2045      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE  
RDB_TABLE_NM='D_INVESTIGATION_REPEAT'  AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')  AND PART_TYPE_CD IS
2046      + NULL  AND QUESTION_GROUP_SEQ_NBR IS NOT NULL   AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL 
 AND NBS_RDB_METADATA.BLOCK_PIVOT_NBR IS NOT NULL  and data_type in ( 'DATETIME','DATE',
2047      + 'Date','Date/Time') and code_set_group_id is null   ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 9 rows and 2 columns.

2047      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

2047      +
PROC SQL;  
2047      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA 
  ON  REPEAT_BLOCK_OUT.BLOCK_NM
2048      + =BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= 
UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 31.25 percent. 
      Compressed is 132 pages; un-compressed would require 192 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 9768 rows and 9 columns.

2048      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
      

2048      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

495                                         The SAS System             22:41 Saturday, January 6, 2024

2048      +
PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY
2049      + INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 9768 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 9768 observations and 9 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 31.25 percent. 
      Compressed is 132 pages; un-compressed would require 192 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2049      +                                                                      DATA 
REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESCCHECK $10.;  FORMAT
2050      + ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM  
THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = '';    END;   I = 0;
2051      + ANSWER_DESC21 = '';    ANSWER_DESCCHECK='';  END;  I+1;  X=LENGTHN(ANSWER_DESC21);  IF I 
<= 20 THEN DO;   TEXTDATE =  PUT(dateColumn, yymmddd10.);          ANSWER_DESC(I) = TEXTDATE;   IF 
LENGTHN(TEXTDATE)< 5 THEN TEXTDATE='';   IF LENGTHN(TEXTDATE)>4
2052      + AND LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN 
ANSWER_DESC21 =  LEFT(TRIM(TEXTDATE));   ELSE ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))|| ' ~ '|| 
LEFT(TRIM(TEXTDATE));  END;   IF LAST.RDB_COLUMN_NM THEN OUTPUT;   IF  LENGTHN
2053      +(COMPRESS(ANSWER_DESCCHECK))<3 THEN ANSWER_DESC21='';  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ ANSWER_DESCCHECK I J; RUN;

NOTE: There were 9768 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 8716 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 98.76 percent. 
      Compressed is 54 pages; un-compressed would require 4359 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

2053      +
DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE ; DATA_VALUE=dateColumn; RDB_COLUMN_NM = 
_NAME_; RUN;

NOTE: There were 9768 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 9768 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 32.35 percent. 
      Compressed is 138 pages; un-compressed would require 204 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2053      +
  DATA     
2054      + REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF 
496                                         The SAS System             22:41 Saturday, January 6, 2024

ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF
2055      + ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
2056      + 3 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 3 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF
2057      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      2055:38    2055:223   2056:154   2057:85    
NOTE: There were 9768 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 9768 observations and 15 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 32.39 percent. 
      Compressed is 144 pages; un-compressed would require 213 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2057      +
PROC SQL;  
2057      +
 CREATE    
2058      + TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR 
FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.56 percent. 
      Compressed is 2 pages; un-compressed would require 45 pages.
NOTE: Table WORK.METADATA_OUT created, with 45 rows and 5 columns.

2058      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2058      +
PROC SQL;  
2058      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_BASE ON UPCASE
2059      +(METADATA_OUT.RDB_COLUMN_NM)  = UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND 
METADATA_OUT.ANSWER_GROUP_SEQ_NBR =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND 
METADATA_OUT.BLOCK_NM = REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
497                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable col1 already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.98 percent. 
      Compressed is 100 pages; un-compressed would require 9769 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 9769 rows and 15 columns.

2059      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.89 seconds
      cpu time            1.18 seconds
      

2059      +
PROC SORT  
2060      + DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: There were 9769 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 9769 observations and 15 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.98 percent. 
      Compressed is 100 pages; un-compressed would require 9769 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

2060      +                                                        PROC TRANSPOSE 
DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_DATE;  VAR dateColumn;  ID COL1;     BY 
INVESTIGATION_KEY; RUN;

WARNING: 18 observations omitted due to missing ID values.
NOTE: There were 9769 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1754 observations and 29 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE decreased size by 25.71 percent. 
      Compressed is 26 pages; un-compressed would require 35 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

2060      +
DATA INVESTIGATION_REPEAT_DATE; SET INVESTIGATION_REPEAT_DATE; DROP
2061      + _NAME_; RUN;

NOTE: There were 1754 observations read from the data set WORK.INVESTIGATION_REPEAT_DATE.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1754 observations and 28 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE decreased size by 27.27 percent. 
      Compressed is 24 pages; un-compressed would require 33 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2061      +                 PROC SQL;
2061      +                           CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, 
498                                         The SAS System             22:41 Saturday, January 6, 2024

USER_DEFINED_COLUMN_NM  FROM D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 9 rows and 2 columns.

2061      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2061      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL 
= COMPRESS
2062      +(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 9 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 9 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2062      +                                                                       PROC SQL;
2062      +                                                                                 CREATE 
TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON UPCASE
2063      +(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.22 percent. 
      Compressed is 68 pages; un-compressed would require 8716 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 8716 rows and 11 columns.

2063      +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.37 seconds
      

2063      +                                                                                  PROC 
SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 8716 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 8716 observations and 11 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.22 percent. 
      Compressed is 68 pages; un-compressed would require 8716 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

2063      +
499                                         The SAS System             22:41 Saturday, January 6, 2024

PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_DATE_ALL;  VAR ANSWER_DESC21;  ID
2064      + USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 8716 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1753 observations and 11 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL decreased size by 99.60 percent. 
      Compressed is 7 pages; un-compressed would require 1753 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.07 seconds
      cpu time            0.06 seconds
      

2064      +                                                              DATA REPEAT_BLOCK_DATE_ALL; 
SET REPEAT_BLOCK_DATE_ALL; DROP _NAME_; RUN;

NOTE: There were 1753 observations read from the data set WORK.REPEAT_BLOCK_DATE_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1753 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1753 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      

2065      + PROC SQL;
2065      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
2066      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')
2067      + AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL and (code_set_group_id >0  OR data_type 
in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_INIT created, with 20 rows and 5 columns.

2067      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.07 seconds
      

2067      +
  PROC     
2068      + SQL;
2068      +      CREATE TABLE METADATA_UNIT AS   SELECT  INIT.DATAMART_NM,RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR,BLOCK_NM, MASK FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
2069      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI')
500                                         The SAS System             22:41 Saturday, January 6, 2024

2070      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND UNIT_TYPE_CD='CODED' AND RDB_TABLE_NM 
='D_INVESTIGATION_REPEAT'  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND 
MASK
2071      + IS NOT NULL   ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_UNIT created, with 1 rows and 6 columns.

2071      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2071      +                                              DATA METADATA_UNIT; SET METADATA_UNIT; 
LENGTH RDB_COLUMN_NM3 $21; LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= 
TRIM(RDB_COLUMN_NM3) || '_UNIT';  USER_DEFINED_COLUMN_NM = TRIM
2072      +(USER_DEFINED_COLUMN_NM)|| '_UNIT';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 
RDB_COLUMN_NM3; RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 1 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2072      +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 1 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2072      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 20 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 21 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
501                                         The SAS System             22:41 Saturday, January 6, 2024


2072      +
  DATA     
2073      + METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
2074      + USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
2075      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
2076      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
2077      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
2078      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
2079      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 21 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 21 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2079      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 21 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 21 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2079      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
2080      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 21 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 105 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
502                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2080      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2080:187   
NOTE: There were 105 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 105 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2080      +
PROC SQL;  
2080      +
 CREATE TABLE METADATA_OUT as select
2081      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: Table WORK.METADATA_OUT created, with 105 rows and 4 columns.

2081      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2081      +                                                                 PROC SQL;
2081      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

2081      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2081      +
PROC SQL;  
2081      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 90.48 percent. 
503                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 21 rows and 4 columns.

2081      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2081      +
PROC SQL;  
2081      +
  CREATE   
2082      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = 
METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: Table WORK.METADATA_OUT created, with 105 rows and 5 columns.

2082      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.06 seconds
      

2082      +
DATA METADATA_OUT; SET METADATA_OUT;
2083      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 105 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 105 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2083      +
PROC SQL;  
2083      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2083      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.
504                                         The SAS System             22:41 Saturday, January 6, 2024


2083      +
  UPDATE STD_TESTER SET
2084      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2084      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2084      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2084      +
PROC SQL;  
2085      + CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 21 rows and 4 columns.

2085      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2085      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
2086      +     RUN;

NOTE: There were 21 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 22 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2086      +            PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 22 observations read from the data set WORK.D_INV_REPEAT_METADATA.
505                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 21 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2086      +                                                                           ;
2086      +
DATA DYNINVLISTING;
2087      +                                                                                           
                                              SET D_INV_REPEAT_METADATA;
2088      +                                          BY SORT_KEY;
2089      +                                                                                           
        LENGTH RDB_COLUMN_NAME_LIST $15000;
2090      + RETAIN RDB_COLUMN_NAME_LIST;
2091      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
2092      +
2093      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
2094      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
2095      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2096      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
2097      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
2098      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
2099      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
2100      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 21 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 21 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
506                                         The SAS System             22:41 Saturday, January 6, 2024


2100      +
PROC SQL;  
2101      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 20 rows were deleted from WORK.DYNINVLISTING.

2101      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2102      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2102      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
2103      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2103      +                                   DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2104      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
2105      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2105      +                                                                     PROC SQL;
2105      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
507                                         The SAS System             22:41 Saturday, January 6, 2024

D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
2106      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
2107      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.67 percent. 
      Compressed is 30 pages; un-compressed would require 8957 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 8957 rows and 25 columns.

2107      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.17 seconds
      

2107      +
PROC SQL;  
2107      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

2107      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2107      +
PROC SORT DATA=REPEAT_BLOCK ; BY
2108      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 8957 observations and 25 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 99.67 percent. 
      Compressed is 30 pages; un-compressed would require 8957 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.54 seconds
      cpu time            0.53 seconds
      

2108      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;   DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;

NOTE: There were 8957 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 188097 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 96.72 percent. 
      Compressed is 881 pages; un-compressed would require 26872 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.23 seconds
      cpu time            0.23 seconds
508                                         The SAS System             22:41 Saturday, January 6, 2024

      

2109      + RDB_COLUMN_NM = _NAME_; run;

NOTE: There were 188097 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 188097 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.84 percent. 
      Compressed is 1118 pages; un-compressed would require 26872 pages.
NOTE: DATA statement used (Total process time):
      real time           0.26 seconds
      cpu time            0.25 seconds
      

2109      +                               PROC SQL;
2109      +                                         CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  
RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE
2110      + BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='AL_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM
2111      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 20 rows and 2 columns.

2111      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2111      +
PROC SQL;  
2111      +
 CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM,  COMPRESS(RDB_COLUMN_NM || '_UNIT') AS 
RDB_COLUMN_NM FROM
2112      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2113      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT' 
 and (code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC'
2114      +) ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 20 rows and 2 columns.

2114      +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      
509                                         The SAS System             22:41 Saturday, January 6, 2024


2114      +                                               PROC SQL;
2114      +                                                         CREATE TABLE BLOCK_DATA_OTH AS 
SELECT BLOCK_NM,  TRIM(RDB_COLUMN_NM || '_OTH') AS RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN NBS_ODS.NBS_UI_METADATA   ON
2115      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM 
IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and
2116      +(code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, 
BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 20 rows and 2 columns.

2116      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.01 seconds
      

2116      +
DATA BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM2 $22; LENGTH RDB_COLUMN_NM $30; 
RDB_COLUMN_NM2=RDB_COLUMN_NM; RDB_COLUMN_NM = COMPRESS
WARNING: Length of character variable RDB_COLUMN_NM has already been set. 
         Use the LENGTH statement as the very first statement in the DATA STEP to declare the length 
         of a character variable.
2117      +(RDB_COLUMN_NM2|| '_OTH'); DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 20 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 20 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2117      +                                                       PROC SQL;
2117      +                                                                 CREATE TABLE BLOCK_DATA 
AS SELECT * FROM BLOCK_DATA_PL  UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM 
BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.BLOCK_DATA created, with 60 rows and 2 columns.

2117      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2117      +
510                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
2117      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT
2118      + DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM 
=BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.54 percent. 
      Compressed is 132 pages; un-compressed would require 2961 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 20725 rows and 7 columns.

2118      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.34 seconds
      

2118      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE
2119      + BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2119      +                                                                                      PROC 
SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 20725 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 20725 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.54 percent. 
      Compressed is 132 pages; un-compressed would require 2961 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

2119      +
DATA REPEAT_BLOCK_OUT_ALL; SET
2120      + REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR; 
   FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;  FORMAT ANSWER_DESCCHECK 
$10.;   ARRAY ANSWER_DESC(20) ANSWER_DESC1-ANSWER_DESC20;
2121      + ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM 
 THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; ANSWER_DESC21 = '';  END;  I+1;  IF 
511                                         The SAS System             22:41 Saturday, January 6, 2024

I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND LENGTHN
2122      +(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN ANSWER_DESC21 =  
LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ '|| LEFT(TRIM(col1)) ;  END;  
IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20
2123      + _NAME_ _LABEL_ col1 I J;     RUN;

NOTE: There were 20725 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 18353 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 99.02 percent. 
      Compressed is 90 pages; un-compressed would require 9178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
      

2123      +                                    DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE 
; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 20725 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 20725 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.54 percent. 
      Compressed is 132 pages; un-compressed would require 2961 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

2123      +
DATA REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 
THEN COL2 =' ';   IF
2124      + ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR =
2125      + 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF
2126      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
2127      + 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 5 THEN COL4 =' ';    RUN;

NOTE: There were 20725 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 20725 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 97.93 percent. 
      Compressed is 143 pages; un-compressed would require 6909 pages.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      

2127      +
PROC SQL;  
2127      +
512                                         The SAS System             22:41 Saturday, January 6, 2024

 CREATE TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM 
METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.10 percent. 
      Compressed is 2 pages; un-compressed would require 105 pages.
NOTE: Table WORK.METADATA_OUT created, with 105 rows and 5 columns.

2127      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2128      + PROC SQL;
2128      +           CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT 
OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  = 
UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR
2129      + =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM = 
REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.10 percent. 
      Compressed is 186 pages; un-compressed would require 20727 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 20727 rows and 12 columns.

2129      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.57 seconds
      cpu time            3.26 seconds
      

2129      +
PROC SORT DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: There were 20727 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 20727 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 99.10 percent. 
      Compressed is 186 pages; un-compressed would require 20727 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.57 seconds
      cpu time            0.54 seconds
      

2129      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_NUMERIC;
2130      + VAR DATA_VALUE;  ID COL1;     BY INVESTIGATION_KEY; RUN;

WARNING: 42 observations omitted due to missing ID values.
513                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 20727 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1756 observations and 65 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.14 seconds
      cpu time            0.14 seconds
      

2130      +                                                           DATA 
INVESTIGATION_REPEAT_NUMERIC; SET INVESTIGATION_REPEAT_NUMERIC; DROP _NAME_; RUN;

NOTE: There were 1756 observations read from the data set WORK.INVESTIGATION_REPEAT_NUMERIC.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1756 observations and 64 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: DATA statement used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

2130      +
PROC SQL;  
2130      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM
2131      + D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 21 rows and 2 columns.

2131      +                        QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2131      +                               DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH 
USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = COMPRESS(USER_DEFINED_COLUMN_NM || 
'_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 21 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 21 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 66.67 percent. 
      Compressed is 2 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2131      +
PROC SQL;  
2131      +
 CREATE TABLE
2132      + REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
514                                         The SAS System             22:41 Saturday, January 6, 2024

REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON 
UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.34 percent. 
      Compressed is 121 pages; un-compressed would require 18354 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 18354 rows and 7 columns.

2132      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.73 seconds
      cpu time            0.76 seconds
      

2132      +
PROC SQL;  
2133      + DELETE FROM REPEAT_BLOCK_METADATA_OUT WHERE USER_DEFINED_COLUMN_NM_ALL= '_ALL';
NOTE: No rows were deleted from WORK.REPEAT_BLOCK_METADATA_OUT.

2133      +                                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2133      +                                                                                          
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 18354 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 18354 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 99.34 percent. 
      Compressed is 121 pages; un-compressed would require 18354 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.18 seconds
      cpu time            0.18 seconds
      

2133      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_NUMERIC_ALL;  VAR ANSWER_DESC21
2134      +;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 18354 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1756 observations and 23 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.15 seconds
      cpu time            0.14 seconds
      

2134      +                                                                   DATA 
REPEAT_BLOCK_NUMERIC_ALL; SET REPEAT_BLOCK_NUMERIC_ALL; DROP _NAME_; RUN;

NOTE: There were 1756 observations read from the data set WORK.REPEAT_BLOCK_NUMERIC_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1756 observations and 22 variables.
515                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.12 seconds
      

2135      + PROC SQL;
2135      +           DROP TABLE  NBS_RDB.DM_INV_AL_LTBI;
NOTE: Table NBS_RDB.DM_INV_AL_LTBI has been dropped.
2135      +                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2135      +                                                      PROC SQL;
2135      +                                                                 CREATE TABLE DISCRETE_ALL 
AS SELECT * FROM INV_SUMM_DATAMART  LEFT JOIN INVESTIGATION_DATA ON 
INVESTIGATION_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN PATIENT_DATA
2136      + ON PATIENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
CASE_MANAGEMENT_DATA ON CASE_MANAGEMENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_ADMINISTRATIVE ON D_INV_ADMINISTRATIVE.INVESTIGATION_KEY
2137      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_CLINICAL ON 
D_INV_CLINICAL.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_COMPLICATION ON 
D_INV_COMPLICATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
2138      + D_INV_CONTACT ON D_INV_CONTACT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_DEATH ON D_INV_DEATH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_EPIDEMIOLOGY ON D_INV_EPIDEMIOLOGY.INVESTIGATION_KEY
2139      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_HIV ON D_INV_HIV.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PATIENT_OBS ON 
D_INV_PATIENT_OBS.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
2140      + D_INV_ISOLATE_TRACKING ON D_INV_ISOLATE_TRACKING.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_LAB_FINDING ON 
D_INV_LAB_FINDING.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY  LEFT JOIN 
D_INV_MEDICAL_HISTORY ON
2141      + D_INV_MEDICAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_MOTHER ON D_INV_MOTHER.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_OTHER ON D_INV_OTHER.INVESTIGATION_KEY
2142      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PREGNANCY_BIRTH ON 
D_INV_PREGNANCY_BIRTH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_RESIDENCY ON D_INV_RESIDENCY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT
2143      + JOIN D_INV_RISK_FACTOR ON D_INV_RISK_FACTOR.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SOCIAL_HISTORY ON 
D_INV_SOCIAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SYMPTOM ON
2144      + D_INV_SYMPTOM.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY   LEFT JOIN 
D_INV_TREATMENT ON D_INV_TREATMENT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_TRAVEL ON D_INV_TRAVEL.INVESTIGATION_KEY
2145      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_UNDER_CONDITION ON 
D_INV_UNDER_CONDITION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_VACCINATION ON D_INV_VACCINATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
2146      + LEFT JOIN D_INV_STD ON D_INV_STD.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN ORGANIZATION ON ORGANIZATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT 
JOIN PROVIDER ON PROVIDER.INVESTIGATION_KEY
516                                         The SAS System             22:41 Saturday, January 6, 2024

2147      + =INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable PATIENT_LOCAL_ID already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
NOTE: Compressing data set WORK.DISCRETE_ALL decreased size by 98.37 percent. 
      Compressed is 33 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.DISCRETE_ALL created, with 2029 rows and 151 columns.

2147      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.59 seconds
      cpu time            1.65 seconds
      
517                                         The SAS System             22:41 Saturday, January 6, 2024


2147      +                                              PROC SQL;
2147      +                                                        CREATE TABLE REPEAT_ALL AS SELECT 
* FROM  INVESTIGATION_REPEAT_VARCHAR LEFT JOIN REPEAT_BLOCK_VARCHAR_ALL ON 
REPEAT_BLOCK_VARCHAR_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY
2148      + LEFT JOIN INVESTIGATION_REPEAT_NUMERIC ON INVESTIGATION_REPEAT_NUMERIC.INVESTIGATION_KEY 
=INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN INVESTIGATION_REPEAT_DATE ON 
INVESTIGATION_REPEAT_DATE.INVESTIGATION_KEY
2149      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN REPEAT_BLOCK_DATE_ALL ON 
REPEAT_BLOCK_DATE_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN 
REPEAT_BLOCK_NUMERIC_ALL ON REPEAT_BLOCK_NUMERIC_ALL.INVESTIGATION_KEY
2150      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherCavity_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherMiliary_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherResult_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherCavity_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherMiliary_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherResult_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXRayRslt_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayCavity_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayMiliary_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable IGRAResult_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultRptLabTyp_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultureResult_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumSmearResult_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TSTResult_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedFreq_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedFreq_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedLTBITherapy_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedLTBITherapy_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ReasonMedStopped_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ReasonMedStopped_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable IGRAResult_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXRayRslt_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXRayRslt_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayCavity_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayCavity_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayMiliary_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayMiliary_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_RESULT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_TYPE_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_RESULT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_TYPE_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultRptLabTyp_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultRptLabTyp_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultureResult_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultureResult_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumSmearResult_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumSmearResult_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedFreq_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedLTBITherapy_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ReasonMedStopped_3 already exists on file WORK.REPEAT_ALL.
518                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable IGRAResult_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_RESULT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_TYPE_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TSTResult_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherCavity_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherMiliary_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherResult_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TSTResult_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherCavity_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherMiliary_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestCTOtherResult_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayCavity_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXrayMiliary_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ChestXRayRslt_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable IGRAResult_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultRptLabTyp_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumCultureResult_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable SputumSmearResult_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable TSTResult_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedFreq_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MedLTBITherapy_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ReasonMedStopped_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_RESULT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable LAB_TEST_TYPE_ALL already exists on file WORK.REPEAT_ALL.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 99.66 percent. 
      Compressed is 6 pages; un-compressed would require 1756 pages.
NOTE: Table WORK.REPEAT_ALL created, with 1756 rows and 149 columns.

2150      +                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.87 seconds
      cpu time            6.34 seconds
      

2150      +                                                         PROC SQL;
2150      +                                                                   CREATE TABLE 
DM_INV_AL_LTBI AS SELECT * FROM  DISCRETE_ALL LEFT OUTER JOIN REPEAT_ALL ON  
DISCRETE_ALL.INVESTIGATION_KEY = REPEAT_ALL.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DM_INV_AL_LTBI.
NOTE: Compressing data set WORK.DM_INV_AL_LTBI decreased size by 99.36 percent. 
      Compressed is 13 pages; un-compressed would require 2029 pages.
NOTE: Table WORK.DM_INV_AL_LTBI created, with 2029 rows and 299 columns.

2150      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.76 seconds
      cpu time            0.76 seconds
      

2150      +
519                                         The SAS System             22:41 Saturday, January 6, 2024

Proc Append Force
2151      + base=nbs_rdb.DM_INV_AL_LTBI data=DM_INV_AL_LTBI;  Run;

NOTE: Appending WORK.DM_INV_AL_LTBI to NBS_RDB.DM_INV_AL_LTBI.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
WARNING: Engine ODBC does not support SORTEDBY operations.  SORTEDBY information cannot be copied.
NOTE: There were 2029 observations read from the data set WORK.DM_INV_AL_LTBI.
NOTE: The data set NBS_RDB.DM_INV_AL_LTBI has 2029 observations and 299 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           1.70 seconds
      cpu time            0.34 seconds
      
2151      +                                                         Quit;;

2151      +                                                                 PROC SQL;
2151      +                                                                           DROP TABLE 
DISCRETE_ALL;
NOTE: Table WORK.DISCRETE_ALL has been dropped.
2151      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2151      +
PROC SQL;  
2151      +
 DROP TABLE REPEAT_ALL;
NOTE: Table WORK.REPEAT_ALL has been dropped.
2151      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2151      +
PROC SQL;  
2151      +
 DROP TABLE DM_INV_AL_LTBI;
NOTE: Table WORK.DM_INV_AL_LTBI has been dropped.
2151      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2152      + PROC SQL;
2152      +             DROP TABLE NBS_RDB.SUMM_DATAMART;
NOTE: Table NBS_RDB.SUMM_DATAMART has been dropped.
2152      +                                               QUIT;
520                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2152      +                                                     PROC SQL;
2152      +                                                                  CREATE TABLE 
NBS_RDB.SUMM_DATAMART AS SELECT PATIENT_KEY AS PATIENT_KEY, INVESTIGATION_KEY, DISEASE_GRP_CD      
FROM NBS_RDB.INV_SUMM_DATAMART        INNER JOIN NBS_RDB.CONDITION ON
2153      + INV_SUMM_DATAMART.DISEASE_CD = CONDITION.CONDITION_CD      WHERE CONDITION.DISEASE_GRP_CD 
= (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.SUMM_DATAMART created, with 1419 rows and 3 columns.

2153      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.42 seconds
      cpu time            0.03 seconds
      

2153      +
PROC SQL;  
2153      +
  CREATE TABLE INV_METADATA AS SELECT  DISTINCT INIT.FORM_CD,
2154      + INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM FROM NBS_RDB.INIT INNER JOIN 
NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD INNER JOIN
2155      + NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='INVESTIGATION'  AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC') AND
2156      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.INV_METADATA created, with 46 rows and 5 columns.

2156      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

2156      +
DATA INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET INV_METADATA;    SORT_KEY+1;
2157      + OUTPUT;       RUN;

NOTE: There were 46 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INV_METADATA has 47 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
521                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2157      +                      PROC SORT DATA=INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 47 observations read from the data set WORK.INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INV_METADATA has 46 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2157      +                                                                            ;
2157      +                                                                              DATA 
INVLISTING;   SET INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   USER_DEFINED_COLUMN_NAME = TRIM
2158      +(RDB_COLUMN_NM) || ' AS ' ||TRIM(USER_DEFINED_COLUMN_NM)|| 
"'"||TRIM(USER_DEFINED_COLUMN_NM)||"'";   RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || 
RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 46 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INVLISTING has 46 observations and 8 variables.
NOTE: Compressing data set WORK.INVLISTING decreased size by 84.78 percent. 
      Compressed is 7 pages; un-compressed would require 46 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2158      +
PROC SQL;  
2158      +
  DELETE FROM INVLISTING WHERE SORT_KEY <
2159      +(SELECT MAX (SORT_KEY) FROM INVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 45 rows were deleted from WORK.INVLISTING.

2159      +                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2159      +                                               DATA INVLISTING; SET INVLISTING;    CALL 
SYMPUTX('INV_SEL2', '');  LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  
TRIMMED_VALUE=SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1);   CALL SYMPUTX('INV_SEL2', TRIMMED_VALUE);
2160      + RUN;

NOTE: There were 1 observations read from the data set WORK.INVLISTING.
522                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.INVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.INVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2160      +       PROC SQL;
2160      +                   CREATE TABLE INVESTIGATION_DATA AS   SELECT  &INV_SEL2, 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.INVESTIGATION  INNER JOIN NBS_RDB.SUMM_DATAMART ON  
SUMM_DATAMART.INVESTIGATION_KEY  =INVESTIGATION.INVESTIGATION_KEY WHERE
2161      + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.INVESTIGATION_DATA decreased size by 97.33 percent. 
      Compressed is 19 pages; un-compressed would require 711 pages.
NOTE: Table WORK.INVESTIGATION_DATA created, with 1419 rows and 47 columns.

2161      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2161      +
PROC SQL;  
2161      +
   CREATE TABLE CASE_MANAGEMENT_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2162      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM NBS_RDB.INIT 
INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  INNER 
JOIN NBS_ODS.NBS_RDB_METADATA  ON
2163      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_CASE_MANAGEMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2164      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL  ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.CASE_MANAGEMENT_METADATA created, with 0 rows and 5 columns.

2164      +
   INSERT INTO CASE_MANAGEMENT_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2165      + DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_CASE_MANAGEMENT';
NOTE: 1 row was inserted into WORK.CASE_MANAGEMENT_METADATA.

2165      +                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.07 seconds
      

2165      +                                                                   PROC SQL;
2165      +                                                                             CREATE TABLE 
INV_SUMM_DATAMART AS SELECT INV_SUMM_DATAMART.PROGRAM_JURISDICTION_OID,  
523                                         The SAS System             22:41 Saturday, January 6, 2024

INV_SUMM_DATAMART.INVESTIGATION_KEY,  INV_SUMM_DATAMART.PATIENT_KEY,
2166      + INV_SUMM_DATAMART.PATIENT_LOCAL_ID,  INV_SUMM_DATAMART.INVESTIGATION_CREATE_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_CREATED_BY,  INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,
2167      + INV_SUMM_DATAMART.EVENT_DATE,  INV_SUMM_DATAMART.EVENT_DATE_TYPE,  
INV_SUMM_DATAMART.LABORATORY_INFORMATION,  INV_SUMM_DATAMART.EARLIEST_SPECIMEN_COLLECT_DATE,  
INV_SUMM_DATAMART.NOTIFICATION_STATUS,  INV_SUMM_DATAMART.CONFIRMATION_METHOD,
2168      + INV_SUMM_DATAMART.CONFIRMATION_DT,   INV_SUMM_DATAMART.DISEASE_CD,  
INV_SUMM_DATAMART.DISEASE,  INV_SUMM_DATAMART.NOTIFICATION_LAST_UPDATED_DATE,   
INV_SUMM_DATAMART.NOTIFICATION_LOCAL_ID,  INV_SUMM_DATAMART.PROGRAM_AREA,
2169      + INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,  INV_SUMM_DATAMART.PATIENT_COUNTY_CODE,  
INV_SUMM_DATAMART.JURISDICTION_NM  FROM NBS_RDB.INV_SUMM_DATAMART  INNER JOIN INVESTIGATION_DATA ON  
INVESTIGATION_DATA.INVESTIGATION_KEY =
2170      + INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_LAST_UPDTD_BY already exists on file WORK.INV_SUMM_DATAMART.
NOTE: Compressing data set WORK.INV_SUMM_DATAMART decreased size by 98.45 percent. 
      Compressed is 22 pages; un-compressed would require 1419 pages.
NOTE: Table WORK.INV_SUMM_DATAMART created, with 1419 rows and 22 columns.

2170      +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           27.61 seconds
      cpu time            15.92 seconds
      

2170      +                                              PROC SQL;
2170      +                                                         CREATE TABLE PAT_METADATA AS   
SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM
2171      + NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD 
= INIT.FORM_CD INNER JOIN NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='D_PATIENT'  AND
2172      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC') AND RDB_COLUMN_NM NOT IN ('PATIENT_WORK_STREET_ADDRESS_1', 
'PATIENT_WORK_STREET_ADDRESS_2') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2173      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PAT_METADATA created, with 28 rows and 5 columns.

2173      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2173      +
DATA PAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PAT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.PAT_METADATA has 29 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
524                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2173      +
PROC SORT DATA=PAT_METADATA
2174      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 29 observations read from the data set WORK.PAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PAT_METADATA has 28 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2174      +                           ;
2174      +                             DATA LISTING;   SET PAT_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   
USER_DEFINED_COLUMN_NAME = ' AS ' ||USER_DEFINED_COLUMN_NM||
2175      + "'"||USER_DEFINED_COLUMN_NM||"'";   RDB_COLUMN_NAME_LIST = (TRIM(RDB_COLUMN_NM) || 
USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);     OUTPUT; RUN;

NOTE: There were 28 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.LISTING has 28 observations and 8 variables.
NOTE: Compressing data set WORK.LISTING decreased size by 85.71 percent. 
      Compressed is 4 pages; un-compressed would require 28 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2175      +
PROC SQL;  
2175      +
  DELETE FROM LISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM LISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 27 rows were deleted from WORK.LISTING.

2175      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2175      +
 DATA      
2176      + LISTING; SET LISTING;   CALL SYMPUTX('PAT_SEL', '');  
525                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  TRIMMED_VALUE=TRIM(SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1)); 
  CALL SYMPUTX('PAT_SEL', TRIMMED_VALUE); RUN;

NOTE: There were 1 observations read from the data set WORK.LISTING.
NOTE: The data set WORK.LISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.LISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2176      +
PROC SQL;  
2176      +
  CREATE TABLE PATIENT_DATA AS   SELECT
2177      + &PAT_SEL,SUMM_DATAMART.INVESTIGATION_KEY  FROM NBS_RDB.D_PATIENT INNER JOIN 
NBS_RDB.SUMM_DATAMART ON  D_PATIENT.PATIENT_KEY = SUMM_DATAMART.PATIENT_KEY; QUIT;
NOTE: Compressing data set WORK.PATIENT_DATA decreased size by 90.53 percent. 
      Compressed is 27 pages; un-compressed would require 285 pages.
NOTE: Table WORK.PATIENT_DATA created, with 1418 rows and 29 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.00 seconds
      

2178      + DATA CASE_MANAGEMENT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET 
CASE_MANAGEMENT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2178      +
PROC SORT DATA=CASE_MANAGEMENT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2178      +
;          
526                                         The SAS System             22:41 Saturday, January 6, 2024

2178      +
DATA CMLISTING;   SET CASE_MANAGEMENT_METADATA;   BY
2179      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) 
|| ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2180      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CMLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2180      +
PROC SQL;  
2180      +
  DELETE FROM CMLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2181      + CMLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.CMLISTING.

2181      +             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2181      +                     DATA CMLISTING; SET CMLISTING;   CALL SYMPUTX('CM_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1,
2182      + LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= 
'D_CASE_MANAGEMENT.INVESTIGATION_KEY AS INVESTIGATION_KEY';  CALL SYMPUTX('CM_CASE', TRIMMED_VALUE);  
RUN;

NOTE: There were 1 observations read from the data set WORK.CMLISTING.
NOTE: The data set WORK.CMLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2182      +
PROC SQL;  
2182      +
  CREATE TABLE CASE_MANAGEMENT_DATA AS   SELECT  &CM_CASE ,
2183      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  LEFT JOIN  
NBS_RDB.D_CASE_MANAGEMENT ON  SUMM_DATAMART.INVESTIGATION_KEY  =D_CASE_MANAGEMENT.INVESTIGATION_KEY 
527                                         The SAS System             22:41 Saturday, January 6, 2024

WHERE SUMM_DATAMART.DISEASE_GRP_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2184      + DATAMART_NM='AL_NIC')  AND D_CASE_MANAGEMENT.INVESTIGATION_KEY>1;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.CASE_MANAGEMENT_DATA.
NOTE: Compression was disabled for data set WORK.CASE_MANAGEMENT_DATA because compression overhead 
      would increase the size of the data set.
NOTE: Table WORK.CASE_MANAGEMENT_DATA created, with 0 rows and 1 columns.

2184      +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.04 seconds
      

2185      + PROC SQL;
2185      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2185      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2185      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2185      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2185      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2186      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2186      +
PROC SQL;  
2186      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2187      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2188      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
528                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2189      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 8 rows and 5 columns.

2189      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2190      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_ADMINISTRATIVE'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2190      +                                                                                           
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.06 seconds
      

2190      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 10 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2190      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2191      + SORT_KEY;RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 9 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2191      +              ;
2191      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2192      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;
529                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 9 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 9 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2192      +
PROC SQL;  
2193      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 8 rows were deleted from WORK.DYNINVLISTING.

2193      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2193      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2194      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2195      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2194:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2195      +                                                         PROC SQL;
2195      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2196      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2197      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
530                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2198      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

2198      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2198      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2199      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2199      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2199      +
;          
2199      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2200      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2201      + RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
531                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2201      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2202      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2203      + OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2203      +               PROC SQL;
2203      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2203      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2203      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2203      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2204      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2205      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;
532                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2205:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2205      +
PROC SQL;  
2205      +
  CREATE TABLE
2206      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2207      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
2208      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
2209      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2209      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

2209      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2210      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2210      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
533                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2210      +                                                                           ;
2210      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2211      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2212      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2212      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2213      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2213      +
PROC SQL;  
2214      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2214      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2214      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;
534                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2214      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2215      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2216      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2216:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2216      +
PROC SQL;  
2216      +
  CREATE TABLE
2217      + D_INV_ADMINISTRATIVE AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
2218      + NBS_RDB. D_INV_ADMINISTRATIVE ON  &FACT_CASE .D_INV_ADMINISTRATIVE_KEY  
=D_INV_ADMINISTRATIVE .D_INV_ADMINISTRATIVE_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.51 percent. 
      Compressed is 7 pages; un-compressed would require 1418 pages.
NOTE: Table WORK.D_INV_ADMINISTRATIVE created, with 1418 rows and 10 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.78 seconds
      cpu time            0.03 seconds
      

2219      + D_INV_ADMINISTRATIVE; SET D_INV_ADMINISTRATIVE;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
535                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_ADMINISTRATIVE.
NOTE: The data set WORK.D_INV_ADMINISTRATIVE has 1418 observations and 10 variables.
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 99.51 percent. 
      Compressed is 7 pages; un-compressed would require 1418 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2220      + PROC SQL;
2220      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2220      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2220      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2220      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2220      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2221      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2221      +
PROC SQL;  
2221      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2222      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2223      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CLINICAL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2224      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
536                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2224      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2225      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_CLINICAL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2225      +                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

2225      +                                                                       DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2225      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2225      +
;  DATA    
2226      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2227      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
537                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

2227      +
PROC SQL;  
2227      +
  DELETE FROM
2228      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2228      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2228      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2229      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2230      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2229:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2230      +                                   PROC SQL;
2230      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2231      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2232      + RDB_TABLE_NM='D_INV_CLINICAL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
2233      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

538                                         The SAS System             22:41 Saturday, January 6, 2024

2233      +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2233      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      

2233      +
PROC SORT  
2234      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2234      +                                                   ;
2234      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2235      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2235      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2236      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2237      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;
539                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2237      +
PROC SQL;  
2237      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2238      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2238      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2238      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2238      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2239      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2240      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2240:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2240      +
PROC SQL;  
2240      +
540                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2241      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2242      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CLINICAL'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2243      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2244      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2244      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.00 seconds
      

2244      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2244      +
PROC SORT DATA=D_INV_METADATA_UNIT
2245      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2245      +                           ;
2245      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2246      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
541                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2246      +
DATA D_INV_METADATA_UNIT; SET
2247      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2248      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2248      +
PROC SQL;  
2248      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2249      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2249      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2249      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2249      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2250      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2251      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;
542                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2251:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2251      +
PROC SQL;  
2251      +
  CREATE TABLE D_INV_CLINICAL AS   SELECT
2252      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CLINICAL ON
2253      + &FACT_CASE .D_INV_CLINICAL_KEY  =D_INV_CLINICAL .D_INV_CLINICAL_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_CLINICAL; SET D_INV_CLINICAL;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_CLINICAL increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_CLINICAL created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.01 seconds
      

2254      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_CLINICAL.
NOTE: The data set WORK.D_INV_CLINICAL has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_CLINICAL increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2255      + PROC SQL;
2255      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
543                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2255      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2255      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2255      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2255      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2256      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2256      +
PROC SQL;  
2256      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2257      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2258      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2259      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2259      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2260      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_COMPLICATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2260      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

544                                         The SAS System             22:41 Saturday, January 6, 2024

2260      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2260      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2260      +
;  DATA    
2261      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2262      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2262      +
PROC SQL;  
2262      +
  DELETE FROM
2263      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2263      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
545                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

2263      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2264      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2265      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2264:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2265      +                                   PROC SQL;
2265      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2266      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2267      + RDB_TABLE_NM='D_INV_COMPLICATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2268      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2268      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

2268      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
546                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2268      +
PROC SORT  
2269      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2269      +                                                   ;
2269      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2270      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2270      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2271      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2272      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2272      +
PROC SQL;  
2272      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2273      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
547                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2273      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2273      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2273      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2274      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2275      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2275:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2275      +
PROC SQL;  
2275      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2276      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2277      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_COMPLICATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2278      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2279      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2279      +
548                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

2279      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2279      +
PROC SORT DATA=D_INV_METADATA_UNIT
2280      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2280      +                           ;
2280      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2281      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2281      +
DATA D_INV_METADATA_UNIT; SET
2282      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2283      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

549                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2283      +
PROC SQL;  
2283      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2284      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2284      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2284      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2284      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2285      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2286      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2286:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2286      +
PROC SQL;  
2286      +
550                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE D_INV_COMPLICATION AS   SELECT
2287      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_COMPLICATION ON
2288      + &FACT_CASE .D_INV_COMPLICATION_KEY  =D_INV_COMPLICATION .D_INV_COMPLICATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_COMPLICATION; SET D_INV_COMPLICATION;  DROP
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_COMPLICATION created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

2289      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_COMPLICATION.
NOTE: The data set WORK.D_INV_COMPLICATION has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2291      + PROC SQL;
2291      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2291      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2291      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2291      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
551                                         The SAS System             22:41 Saturday, January 6, 2024


2291      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2292      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2292      +
PROC SQL;  
2292      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2293      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2294      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CONTACT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2295      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2295      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2296      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_CONTACT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2296      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

2296      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2296      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

552                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2296      +
;  DATA    
2297      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2298      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2298      +
PROC SQL;  
2298      +
  DELETE FROM
2299      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2299      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2299      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2300      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2301      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2300:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
553                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2301      +                                   PROC SQL;
2301      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2302      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2303      + RDB_TABLE_NM='D_INV_CONTACT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
2304      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2304      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2304      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2304      +
PROC SORT DATA=D_INV_METADATA_OTH
2305      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

554                                         The SAS System             22:41 Saturday, January 6, 2024

2305      +                           ;
2305      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2306      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2306      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2307      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2308      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2308      +
PROC SQL;  
2308      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2309      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2309      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2309      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2309      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
555                                         The SAS System             22:41 Saturday, January 6, 2024

SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2310      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2311      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2310:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2311      +
PROC SQL;  
2311      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2312      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2313      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_CONTACT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2314      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
2315      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2315      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2315      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2315      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

556                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2315      +
;   DATA   
2316      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
2317      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2317      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
2318      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2319      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2319      +
PROC SQL;  
2319      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2320      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2320      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

557                                         The SAS System             22:41 Saturday, January 6, 2024

2320      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2320      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2321      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2322      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2321:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2322      +
PROC SQL;  
2322      +
  CREATE TABLE D_INV_CONTACT AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
2323      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_CONTACT ON  &FACT_CASE .D_INV_CONTACT_KEY  =D_INV_CONTACT
2324      + .D_INV_CONTACT_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_CONTACT created, with 1418 rows and 2 columns.

2324      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

2324      +
;          
2324      +
DATA D_INV_CONTACT; SET D_INV_CONTACT;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
2325      + RUN;

558                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_CONTACT.
NOTE: The data set WORK.D_INV_CONTACT has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2326      + PROC SQL;
2326      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2326      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2326      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2326      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2326      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2327      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2327      +
PROC SQL;  
2327      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2328      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
559                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2329      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_DEATH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL
2330      +  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2330      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2331      + DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_DEATH'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2331      +                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

2331      +                                                              DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2331      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2331      +
;          
2331      +
DATA DYNINVLISTING;   SET
2332      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
2333      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
560                                         The SAS System             22:41 Saturday, January 6, 2024

THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2333      +
PROC SQL;  
2333      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
2334      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2334      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2334      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
2335      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2335:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2336      + PROC SQL;
2336      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
2337      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
561                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_DEATH'    AND
2338      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2339      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2339      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2339      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2339      +
PROC SORT DATA=D_INV_METADATA_OTH
2340      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2340      +                           ;
2340      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2341      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2341      +
562                                         The SAS System             22:41 Saturday, January 6, 2024

DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2342      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2343      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2343      +
PROC SQL;  
2343      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2344      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2344      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2344      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2344      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2345      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2346      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2345:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
563                                         The SAS System             22:41 Saturday, January 6, 2024

      

2346      +
PROC SQL;  
2346      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2347      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2348      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2349      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
2350      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2350      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2350      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2350      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2350      +
;          
2350      +
DATA D_INV_METADATA_UNIT; LENGTH
2351      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
2352      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
564                                         The SAS System             22:41 Saturday, January 6, 2024

|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2352      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
2353      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
2354      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2354      +
PROC SQL;  
2354      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2355      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2355      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2355      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2356      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
2357      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;
565                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2356:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2357      +
PROC SQL;  
2357      +
  CREATE TABLE D_INV_DEATH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
2358      + NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_DEATH ON  
&FACT_CASE .D_INV_DEATH_KEY  =D_INV_DEATH .D_INV_DEATH_KEY  WHERE
2359      + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_DEATH created, with 1418 rows and 2 columns.

2359      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.03 seconds
      

2359      +
;          
2359      +
DATA D_INV_DEATH; SET D_INV_DEATH;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_DEATH.
NOTE: The data set WORK.D_INV_DEATH has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
566                                         The SAS System             22:41 Saturday, January 6, 2024

      

2360      + PROC SQL;
2360      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2360      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2360      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2360      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2360      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2361      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2361      +
PROC SQL;  
2361      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2362      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2363      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2364      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 4 rows and 5 columns.

2364      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2365      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'  ;
567                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2365      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.01 seconds
      

2365      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 6 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2365      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 6 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 5 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2365      +
;  DATA    
2366      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2367      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 5 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2367      +
PROC SQL;  
2367      +
568                                         The SAS System             22:41 Saturday, January 6, 2024

  DELETE FROM
2368      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 4 rows were deleted from WORK.DYNINVLISTING.

2368      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2368      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2369      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2370      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2369:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2370      +                                   PROC SQL;
2370      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2371      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2372      + RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2373      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2373      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

569                                         The SAS System             22:41 Saturday, January 6, 2024

2373      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2373      +
PROC SORT  
2374      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2374      +                                                   ;
2374      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2375      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2375      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2376      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2377      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
570                                         The SAS System             22:41 Saturday, January 6, 2024


2377      +
PROC SQL;  
2377      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2378      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2378      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2378      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2378      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2379      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2380      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2380:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2380      +
PROC SQL;  
2380      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2381      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2382      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
571                                         The SAS System             22:41 Saturday, January 6, 2024

2383      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2384      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2384      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

2384      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2384      +
PROC SORT DATA=D_INV_METADATA_UNIT
2385      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2385      +                           ;
2385      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2386      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2386      +
572                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT; SET
2387      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2388      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2388      +
PROC SQL;  
2388      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2389      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2389      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2389      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2389      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2390      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2391      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2391:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
573                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2391      +
PROC SQL;  
2391      +
  CREATE TABLE D_INV_EPIDEMIOLOGY AS   SELECT
2392      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_EPIDEMIOLOGY ON
2393      + &FACT_CASE .D_INV_EPIDEMIOLOGY_KEY  =D_INV_EPIDEMIOLOGY .D_INV_EPIDEMIOLOGY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_EPIDEMIOLOGY; SET D_INV_EPIDEMIOLOGY;  DROP
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 99.30 percent. 
      Compressed is 5 pages; un-compressed would require 710 pages.
NOTE: Table WORK.D_INV_EPIDEMIOLOGY created, with 1418 rows and 5 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           1.11 seconds
      cpu time            0.01 seconds
      

2394      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_EPIDEMIOLOGY.
NOTE: The data set WORK.D_INV_EPIDEMIOLOGY has 1418 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 99.30 percent. 
      Compressed is 5 pages; un-compressed would require 710 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2395      + PROC SQL;
2395      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2395      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2395      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
574                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was updated in WORK.STD_TESTER.

2395      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2395      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2396      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2396      +
PROC SQL;  
2396      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2397      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2398      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_HIV'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL
2399      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 18 rows and 5 columns.

2399      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2400      + DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_HIV'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2400      +                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.01 seconds
      

2400      +                                                            DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 19 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 20 observations and 6 variables.
575                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2400      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 20 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 19 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2400      +
;          
2400      +
DATA DYNINVLISTING;   SET
2401      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
2402      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 19 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 19 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 89.47 percent. 
      Compressed is 2 pages; un-compressed would require 19 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2402      +
PROC SQL;  
2402      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
2403      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 18 rows were deleted from WORK.DYNINVLISTING.

2403      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
576                                         The SAS System             22:41 Saturday, January 6, 2024


2403      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
2404      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2404:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2405      + PROC SQL;
2405      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
2406      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_HIV'    AND
2407      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2408      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2408      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2408      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

577                                         The SAS System             22:41 Saturday, January 6, 2024

2408      +
PROC SORT DATA=D_INV_METADATA_OTH
2409      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2409      +                           ;
2409      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2410      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2410      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2411      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2412      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2412      +
PROC SQL;  
2412      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2413      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2413      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
578                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2413      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2413      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2414      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2415      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2414:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2415      +
PROC SQL;  
2415      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2416      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2417      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_HIV'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2418      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
2419      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2419      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2419      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
579                                         The SAS System             22:41 Saturday, January 6, 2024

OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2419      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2419      +
;          
2419      +
DATA D_INV_METADATA_UNIT; LENGTH
2420      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
2421      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2421      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
2422      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
2423      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2423      +
580                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
2423      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2424      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2424      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2424      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2425      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
2426      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2425:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2426      +
PROC SQL;  
2426      +
  CREATE TABLE D_INV_HIV AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
2427      + NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_HIV ON  
&FACT_CASE .D_INV_HIV_KEY  =D_INV_HIV .D_INV_HIV_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD =
2428      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_HIV decreased size by 99.15 percent. 
      Compressed is 12 pages; un-compressed would require 1418 pages.
NOTE: Table WORK.D_INV_HIV created, with 1418 rows and 19 columns.

2428      +                                                                   ;QUIT;
581                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.56 seconds
      cpu time            0.06 seconds
      

2428      +                                                                         ;
2428      +                                                                              DATA 
D_INV_HIV; SET D_INV_HIV;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_HIV.
NOTE: The data set WORK.D_INV_HIV has 1418 observations and 19 variables.
NOTE: Compressing data set WORK.D_INV_HIV decreased size by 99.15 percent. 
      Compressed is 12 pages; un-compressed would require 1418 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2429      + PROC SQL;
2429      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2429      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2429      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2429      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2429      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2430      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
582                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2430      +
PROC SQL;  
2430      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2431      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2432      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2433      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2433      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2434      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_PATIENT_OBS'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2434      +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

2434      +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2434      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
583                                         The SAS System             22:41 Saturday, January 6, 2024

      

2434      +
;  DATA    
2435      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2436      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2436      +
PROC SQL;  
2436      +
  DELETE FROM
2437      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2437      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2437      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2438      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2439      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2438:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
584                                         The SAS System             22:41 Saturday, January 6, 2024

      

2439      +                                   PROC SQL;
2439      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2440      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2441      + RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2442      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2442      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

2442      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2442      +
PROC SORT  
2443      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2443      +                                                   ;
2443      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2444      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

585                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2444      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2445      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2446      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2446      +
PROC SQL;  
2446      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2447      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2447      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2447      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2447      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2448      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2449      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
586                                         The SAS System             22:41 Saturday, January 6, 2024

TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2449:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2449      +
PROC SQL;  
2449      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2450      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2451      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2452      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2453      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2453      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2453      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2453      +
PROC SORT DATA=D_INV_METADATA_UNIT
2454      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
587                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2454      +                           ;
2454      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2455      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2455      +
DATA D_INV_METADATA_UNIT; SET
2456      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2457      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2457      +
PROC SQL;  
2457      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2458      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2458      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2458      +                                                                    DATA _NULL_;  CALL 
588                                         The SAS System             22:41 Saturday, January 6, 2024

SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2458      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2459      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2460      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2460:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2460      +
PROC SQL;  
2460      +
  CREATE TABLE D_INV_PATIENT_OBS AS   SELECT
2461      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_PATIENT_OBS ON
2462      + &FACT_CASE .D_INV_PATIENT_OBS_KEY  =D_INV_PATIENT_OBS .D_INV_PATIENT_OBS_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_PATIENT_OBS; SET D_INV_PATIENT_OBS;  DROP _TEMA001
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_PATIENT_OBS created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.06 seconds
      

2463      + _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
589                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_PATIENT_OBS.
NOTE: The data set WORK.D_INV_PATIENT_OBS has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2464      + PROC SQL;
2464      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2464      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2464      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2464      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2464      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2465      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2465      +
PROC SQL;  
2465      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2466      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2467      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
590                                         The SAS System             22:41 Saturday, January 6, 2024

2468      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

2468      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2469      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_ISOLATE_TRACKING 
'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2469      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.22 seconds
      cpu time            0.06 seconds
      

2469      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2469      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2470      + SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2470      +              ;
2470      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2471      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;
591                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2471      +
PROC SQL;  
2472      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

2472      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2472      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2473      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2474      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2473:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2474      +                                                         PROC SQL;
2474      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2475      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2476      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
592                                         The SAS System             22:41 Saturday, January 6, 2024

FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2477      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2477      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

2477      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2478      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2478      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2478      +
;          
2478      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2479      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2480      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2480      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
593                                         The SAS System             22:41 Saturday, January 6, 2024

MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2481      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2482      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2482      +               PROC SQL;
2482      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2482      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2482      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2482      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2483      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2484      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2484:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
594                                         The SAS System             22:41 Saturday, January 6, 2024

      

2484      +
PROC SQL;  
2484      +
  CREATE TABLE
2485      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2486      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=
2487      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
2488      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2488      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2488      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2489      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2489      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2489      +                                                                           ;
2489      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2490      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
595                                         The SAS System             22:41 Saturday, January 6, 2024

TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2491      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2491      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2492      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2492      +
PROC SQL;  
2493      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2493      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2493      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2493      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2494      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2495      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
596                                         The SAS System             22:41 Saturday, January 6, 2024

(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2495:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2495      +
PROC SQL;  
2495      +
  CREATE TABLE
2496      + D_INV_ISOLATE_TRACKING AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER
2497      + JOIN  NBS_RDB. D_INV_ISOLATE_TRACKING ON  &FACT_CASE .D_INV_ISOLATE_TRACKING_KEY  
=D_INV_ISOLATE_TRACKING .D_INV_ISOLATE_TRACKING_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING decreased size by 95.51 percent. 
      Compressed is 8 pages; un-compressed would require 178 pages.
NOTE: Table WORK.D_INV_ISOLATE_TRACKING created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.01 seconds
      

2498      + D_INV_ISOLATE_TRACKING; SET D_INV_ISOLATE_TRACKING;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_ISOLATE_TRACKING.
NOTE: The data set WORK.D_INV_ISOLATE_TRACKING has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING decreased size by 95.51 percent. 
      Compressed is 8 pages; un-compressed would require 178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2499      + PROC SQL;
597                                         The SAS System             22:41 Saturday, January 6, 2024

2499      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2499      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2499      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2499      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2499      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2500      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2500      +
PROC SQL;  
2500      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2501      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2502      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2503      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 2 rows and 5 columns.

2503      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2504      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_LAB_FINDING'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2504      +                                                                   QUIT;
598                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.03 seconds
      

2504      +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 4 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2504      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2504      +
;  DATA    
2505      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2506      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 3 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2506      +
PROC SQL;  
2506      +
  DELETE FROM
2507      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
599                                         The SAS System             22:41 Saturday, January 6, 2024

         is a possible data integrity problem.
NOTE: 2 rows were deleted from WORK.DYNINVLISTING.

2507      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2507      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2508      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2509      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2508:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2509      +                                   PROC SQL;
2509      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2510      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2511      + RDB_TABLE_NM='D_INV_LAB_FINDING'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2512      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2512      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2512      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;
600                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2512      +
PROC SORT  
2513      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2513      +                                                   ;
2513      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2514      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2514      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2515      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2516      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2516      +
PROC SQL;  
601                                         The SAS System             22:41 Saturday, January 6, 2024

2516      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2517      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2517      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2517      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2517      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2518      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2519      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2519:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2519      +
PROC SQL;  
2519      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2520      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2521      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_LAB_FINDING'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2522      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
602                                         The SAS System             22:41 Saturday, January 6, 2024

2523      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2523      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2523      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2523      +
PROC SORT DATA=D_INV_METADATA_UNIT
2524      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2524      +                           ;
2524      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2525      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2525      +
DATA D_INV_METADATA_UNIT; SET
2526      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
603                                         The SAS System             22:41 Saturday, January 6, 2024

USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2527      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2527      +
PROC SQL;  
2527      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2528      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2528      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2528      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2528      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2529      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2530      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2530:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
604                                         The SAS System             22:41 Saturday, January 6, 2024

      

2530      +
PROC SQL;  
2530      +
  CREATE TABLE D_INV_LAB_FINDING AS   SELECT
2531      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_LAB_FINDING ON
2532      + &FACT_CASE .D_INV_LAB_FINDING_KEY  =D_INV_LAB_FINDING .D_INV_LAB_FINDING_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_LAB_FINDING; SET D_INV_LAB_FINDING;  DROP _TEMA001
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 97.75 percent. 
      Compressed is 4 pages; un-compressed would require 178 pages.
NOTE: Table WORK.D_INV_LAB_FINDING created, with 1418 rows and 3 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

2533      + _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_LAB_FINDING.
NOTE: The data set WORK.D_INV_LAB_FINDING has 1418 observations and 3 variables.
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 97.75 percent. 
      Compressed is 4 pages; un-compressed would require 178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2534      + PROC SQL;
2534      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2534      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2534      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2534      +
605                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2534      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2535      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2535      +
PROC SQL;  
2535      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2536      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2537      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2538      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

2538      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2539      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2539      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.03 seconds
      

2539      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
606                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2539      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2540      + SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2540      +              ;
2540      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2541      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2541      +
PROC SQL;  
2542      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

2542      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2542      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
607                                         The SAS System             22:41 Saturday, January 6, 2024

 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2543      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2544      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2543:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2544      +                                                         PROC SQL;
2544      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2545      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2546      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2547      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2547      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2547      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2548      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2548      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

608                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2548      +
;          
2548      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2549      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2550      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2550      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2551      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2552      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2552      +               PROC SQL;
2552      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2552      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
609                                         The SAS System             22:41 Saturday, January 6, 2024


2552      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2552      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2553      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2554      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2554:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2554      +
PROC SQL;  
2554      +
  CREATE TABLE
2555      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2556      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
2557      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
2558      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2558      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

610                                         The SAS System             22:41 Saturday, January 6, 2024

2558      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2559      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2559      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2559      +                                                                           ;
2559      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2560      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2561      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2561      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2562      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2562      +
611                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
2563      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2563      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2563      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2563      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2564      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2565      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2565:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2565      +
PROC SQL;  
2565      +
  CREATE TABLE
2566      + D_INV_MEDICAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
2567      +  NBS_RDB. D_INV_MEDICAL_HISTORY ON  &FACT_CASE .D_INV_MEDICAL_HISTORY_KEY  
=D_INV_MEDICAL_HISTORY .D_INV_MEDICAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
612                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.D_INV_MEDICAL_HISTORY created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.01 seconds
      

2568      + D_INV_MEDICAL_HISTORY; SET D_INV_MEDICAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_MEDICAL_HISTORY.
NOTE: The data set WORK.D_INV_MEDICAL_HISTORY has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2570      + PROC SQL;
2570      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2570      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2570      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2570      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2570      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2571      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
613                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2571      +
PROC SQL;  
2571      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2572      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2573      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2574      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2574      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2575      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_MOTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2575      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.03 seconds
      

2575      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2575      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
614                                         The SAS System             22:41 Saturday, January 6, 2024

      

2575      +
;          
2575      +
DATA DYNINVLISTING
2576      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2577      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2577      +
PROC SQL;  
2577      +
  DELETE FROM
2578      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2578      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2578      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2579      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2580      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2579:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
615                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2580      +                                   PROC SQL;
2580      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2581      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2582      + RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
2583      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2583      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.01 seconds
      

2583      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2583      +
PROC SORT DATA=D_INV_METADATA_OTH
2584      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2584      +                           ;
2584      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2585      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;
616                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2585      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2586      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2587      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2587      +
PROC SQL;  
2587      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2588      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2588      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2588      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2588      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2589      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2590      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;
617                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2589:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2590      +
PROC SQL;  
2590      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2591      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2592      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2593      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
2594      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2594      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

2594      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2594      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
618                                         The SAS System             22:41 Saturday, January 6, 2024

      

2594      +
;   DATA   
2595      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
2596      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2596      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
2597      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2598      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2598      +
PROC SQL;  
2598      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2599      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2599      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2599      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
619                                         The SAS System             22:41 Saturday, January 6, 2024


2599      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2600      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2601      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2600:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2601      +
PROC SQL;  
2601      +
  CREATE TABLE D_INV_MOTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
2602      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_MOTHER ON  &FACT_CASE .D_INV_MOTHER_KEY  =D_INV_MOTHER
2603      + .D_INV_MOTHER_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_MOTHER created, with 1418 rows and 2 columns.

2603      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

2603      +
;          
2603      +
DATA D_INV_MOTHER; SET D_INV_MOTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN
2604      +;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
620                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_MOTHER.
NOTE: The data set WORK.D_INV_MOTHER has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2605      + PROC SQL;
2605      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2605      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2605      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2605      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2605      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2606      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2606      +
PROC SQL;  
2606      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2607      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2608      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_OTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL
2609      +  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
621                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

2609      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2610      + DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_OTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2610      +                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

2610      +                                                              DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2610      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2610      +
;          
2610      +
DATA DYNINVLISTING;   SET
2611      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
2612      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
622                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2612      +
PROC SQL;  
2612      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
2613      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

2613      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2613      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
2614      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2614:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2615      + PROC SQL;
2615      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
2616      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_OTHER'    AND
2617      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
623                                         The SAS System             22:41 Saturday, January 6, 2024

2618      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2618      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

2618      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2618      +
PROC SORT DATA=D_INV_METADATA_OTH
2619      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2619      +                           ;
2619      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2620      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2620      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2621      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
624                                         The SAS System             22:41 Saturday, January 6, 2024

2622      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2622      +
PROC SQL;  
2622      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2623      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2623      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2623      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2623      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2624      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2625      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2624:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2625      +
PROC SQL;  
625                                         The SAS System             22:41 Saturday, January 6, 2024

2625      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2626      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2627      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2628      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
2629      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2629      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2629      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2629      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2629      +
;          
2629      +
DATA D_INV_METADATA_UNIT; LENGTH
2630      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
2631      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
626                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2631      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
2632      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
2633      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2633      +
PROC SQL;  
2633      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2634      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2634      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2634      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2635      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
2636      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2635:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
627                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2636      +
PROC SQL;  
2636      +
  CREATE TABLE D_INV_OTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
2637      + NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_OTHER ON  
&FACT_CASE .D_INV_OTHER_KEY  =D_INV_OTHER .D_INV_OTHER_KEY  WHERE
2638      + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_OTHER decreased size by 98.31 percent. 
      Compressed is 3 pages; un-compressed would require 178 pages.
NOTE: Table WORK.D_INV_OTHER created, with 1418 rows and 2 columns.

2638      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.57 seconds
      cpu time            0.00 seconds
      

2638      +
;          
2638      +
DATA D_INV_OTHER; SET D_INV_OTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_OTHER.
NOTE: The data set WORK.D_INV_OTHER has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_OTHER decreased size by 98.31 percent. 
      Compressed is 3 pages; un-compressed would require 178 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2639      + PROC SQL;
2639      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
628                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2639      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2639      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2639      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2639      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2640      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2640      +
PROC SQL;  
2640      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2641      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2642      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2643      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2643      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2644      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2644      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
629                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.14 seconds
      cpu time            0.07 seconds
      

2644      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2644      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2645      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2645      +              ;
2645      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2646      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2646      +
PROC SQL;  
2647      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.
630                                         The SAS System             22:41 Saturday, January 6, 2024


2647      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2647      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2648      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2649      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2648:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2649      +                                                         PROC SQL;
2649      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2650      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2651      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2652      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2652      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

2652      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2653      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

631                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2653      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2653      +
;          
2653      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2654      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2655      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2655      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2656      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2657      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2657      +               PROC SQL;
2657      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
632                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2657      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2657      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2657      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2658      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2659      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2659:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2659      +
PROC SQL;  
2659      +
  CREATE TABLE
2660      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2661      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
2662      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
2663      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
633                                         The SAS System             22:41 Saturday, January 6, 2024

IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2663      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.01 seconds
      

2663      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2664      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2664      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2664      +                                                                           ;
2664      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2665      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2666      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2666      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2667      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
634                                         The SAS System             22:41 Saturday, January 6, 2024

|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2667      +
PROC SQL;  
2668      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2668      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2668      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2668      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2669      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2670      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2670:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2670      +
PROC SQL;  
635                                         The SAS System             22:41 Saturday, January 6, 2024

2670      +
  CREATE TABLE
2671      + D_INV_PREGNANCY_BIRTH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
2672      +  NBS_RDB. D_INV_PREGNANCY_BIRTH ON  &FACT_CASE .D_INV_PREGNANCY_BIRTH_KEY  
=D_INV_PREGNANCY_BIRTH .D_INV_PREGNANCY_BIRTH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_PREGNANCY_BIRTH created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.00 seconds
      

2673      + D_INV_PREGNANCY_BIRTH; SET D_INV_PREGNANCY_BIRTH;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_PREGNANCY_BIRTH.
NOTE: The data set WORK.D_INV_PREGNANCY_BIRTH has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2674      + PROC SQL;
2674      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2674      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2674      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2674      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
636                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2674      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2675      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2675      +
PROC SQL;  
2675      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2676      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2677      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2678      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2678      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2679      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_RESIDENCY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2679      +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

2679      +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2679      +
637                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2679      +
;  DATA    
2680      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2681      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2681      +
PROC SQL;  
2681      +
  DELETE FROM
2682      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2682      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2682      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2683      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2684      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
638                                         The SAS System             22:41 Saturday, January 6, 2024

      2683:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2684      +                                   PROC SQL;
2684      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2685      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2686      + RDB_TABLE_NM='D_INV_RESIDENCY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
2687      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2687      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2687      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2687      +
PROC SORT  
2688      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
639                                         The SAS System             22:41 Saturday, January 6, 2024

      

2688      +                                                   ;
2688      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2689      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2689      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2690      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2691      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2691      +
PROC SQL;  
2691      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2692      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2692      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2692      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
640                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2692      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2693      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2694      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2694:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2694      +
PROC SQL;  
2694      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2695      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2696      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RESIDENCY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2697      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2698      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2698      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2698      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
641                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2698      +
PROC SORT DATA=D_INV_METADATA_UNIT
2699      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2699      +                           ;
2699      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2700      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2700      +
DATA D_INV_METADATA_UNIT; SET
2701      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2702      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2702      +
PROC SQL;  
2702      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2703      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
642                                         The SAS System             22:41 Saturday, January 6, 2024

         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2703      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2703      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2703      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2704      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2705      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2705:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2705      +
PROC SQL;  
2705      +
  CREATE TABLE D_INV_RESIDENCY AS   SELECT
2706      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RESIDENCY ON
2707      + &FACT_CASE .D_INV_RESIDENCY_KEY  =D_INV_RESIDENCY .D_INV_RESIDENCY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_RESIDENCY; SET D_INV_RESIDENCY;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_RESIDENCY created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.47 seconds
643                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.04 seconds
      

2708      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_RESIDENCY.
NOTE: The data set WORK.D_INV_RESIDENCY has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2709      + PROC SQL;
2709      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2709      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2709      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2709      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2709      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2710      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2710      +
644                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
2710      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2711      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2712      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2713      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2713      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2714      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_RISK_FACTOR'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2714      +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

2714      +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2714      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2714      +
;  DATA    
2715      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
645                                         The SAS System             22:41 Saturday, January 6, 2024

 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2716      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

2716      +
PROC SQL;  
2716      +
  DELETE FROM
2717      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2717      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2717      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2718      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2719      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2718:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2719      +                                   PROC SQL;
2719      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
646                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2720      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2721      + RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2722      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2722      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

2722      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2722      +
PROC SORT  
2723      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2723      +                                                   ;
2723      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2724      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
647                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2724      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2725      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2726      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2726      +
PROC SQL;  
2726      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2727      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2727      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2727      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2727      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2728      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2729      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2729:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
648                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2729      +
PROC SQL;  
2729      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2730      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2731      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2732      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2733      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2733      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

2733      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2733      +
PROC SORT DATA=D_INV_METADATA_UNIT
2734      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
649                                         The SAS System             22:41 Saturday, January 6, 2024


2734      +                           ;
2734      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2735      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2735      +
DATA D_INV_METADATA_UNIT; SET
2736      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2737      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2737      +
PROC SQL;  
2737      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2738      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2738      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2738      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
650                                         The SAS System             22:41 Saturday, January 6, 2024

      

2738      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2739      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2740      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2740:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2740      +
PROC SQL;  
2740      +
  CREATE TABLE D_INV_RISK_FACTOR AS   SELECT
2741      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RISK_FACTOR ON
2742      + &FACT_CASE .D_INV_RISK_FACTOR_KEY  =D_INV_RISK_FACTOR .D_INV_RISK_FACTOR_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_RISK_FACTOR; SET D_INV_RISK_FACTOR;  DROP _TEMA001
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_RISK_FACTOR created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.00 seconds
      

2743      + _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_RISK_FACTOR.
NOTE: The data set WORK.D_INV_RISK_FACTOR has 1418 observations and 2 variables.
651                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_RISK_FACTOR increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2744      + PROC SQL;
2744      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2744      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2744      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2744      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2744      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2745      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2745      +
PROC SQL;  
2745      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2746      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2747      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2748      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

652                                         The SAS System             22:41 Saturday, January 6, 2024

2748      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2749      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2749      +                                                                                           
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.07 seconds
      

2749      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2749      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2750      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2750      +              ;
2750      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2751      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
653                                         The SAS System             22:41 Saturday, January 6, 2024

      

2751      +
PROC SQL;  
2752      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2752      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2752      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2753      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2754      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2753:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2754      +                                                         PROC SQL;
2754      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2755      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2756      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2757      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2757      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
654                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.10 seconds
      cpu time            0.01 seconds
      

2757      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2758      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2758      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2758      +
;          
2758      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2759      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2760      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2760      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2761      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2762      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
655                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2762      +               PROC SQL;
2762      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2762      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2762      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2762      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2763      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2764      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2764:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2764      +
PROC SQL;  
2764      +
  CREATE TABLE
2765      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
656                                         The SAS System             22:41 Saturday, January 6, 2024

   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2766      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
2767      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
2768      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2768      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

2768      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2769      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2769      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2769      +                                                                           ;
2769      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2770      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2771      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
657                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2771      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2772      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2772      +
PROC SQL;  
2773      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2773      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2773      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2773      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2774      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2775      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2775:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
658                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2775      +
PROC SQL;  
2775      +
  CREATE TABLE
2776      + D_INV_SOCIAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
2777      + NBS_RDB. D_INV_SOCIAL_HISTORY ON  &FACT_CASE .D_INV_SOCIAL_HISTORY_KEY  
=D_INV_SOCIAL_HISTORY .D_INV_SOCIAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_SOCIAL_HISTORY created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

2778      + D_INV_SOCIAL_HISTORY; SET D_INV_SOCIAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_SOCIAL_HISTORY.
NOTE: The data set WORK.D_INV_SOCIAL_HISTORY has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2779      + PROC SQL;
2779      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2779      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

659                                         The SAS System             22:41 Saturday, January 6, 2024

2779      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2779      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2779      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2780      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2780      +
PROC SQL;  
2780      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2781      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2782      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SYMPTOM'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2783      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2783      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2784      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_SYMPTOM'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2784      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

2784      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
660                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2784      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2784      +
;  DATA    
2785      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2786      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2786      +
PROC SQL;  
2786      +
  DELETE FROM
2787      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2787      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2787      +                                                                                  DATA 
661                                         The SAS System             22:41 Saturday, January 6, 2024

DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2788      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2789      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2788:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2789      +                                   PROC SQL;
2789      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2790      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2791      + RDB_TABLE_NM='D_INV_SYMPTOM'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
2792      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2792      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2792      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2792      +
PROC SORT DATA=D_INV_METADATA_OTH
662                                         The SAS System             22:41 Saturday, January 6, 2024

2793      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2793      +                           ;
2793      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2794      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2794      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2795      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2796      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2796      +
PROC SQL;  
2796      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2797      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2797      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
663                                         The SAS System             22:41 Saturday, January 6, 2024


2797      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2797      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2798      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2799      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2798:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2799      +
PROC SQL;  
2799      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2800      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2801      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SYMPTOM'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2802      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
2803      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2803      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

2803      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

664                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2803      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2803      +
;   DATA   
2804      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
2805      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2805      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
2806      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2807      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2807      +
PROC SQL;  
2807      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2808      + D_INV_METADATA_UNIT);
665                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2808      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2808      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2808      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2809      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2810      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2809:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2810      +
PROC SQL;  
2810      +
  CREATE TABLE D_INV_SYMPTOM AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
2811      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_SYMPTOM ON  &FACT_CASE .D_INV_SYMPTOM_KEY  =D_INV_SYMPTOM
2812      + .D_INV_SYMPTOM_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_SYMPTOM increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_SYMPTOM created, with 1418 rows and 2 columns.

2812      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
666                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.06 seconds
      

2812      +
;          
2812      +
DATA D_INV_SYMPTOM; SET D_INV_SYMPTOM;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
2813      + RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_SYMPTOM.
NOTE: The data set WORK.D_INV_SYMPTOM has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SYMPTOM increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2814      + PROC SQL;
2814      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2814      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2814      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2814      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2814      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2815      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
667                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2815      +
PROC SQL;  
2815      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2816      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2817      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
2818      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2818      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2819      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_TREATMENT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2819      +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.06 seconds
      

2819      +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2819      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
668                                         The SAS System             22:41 Saturday, January 6, 2024

      

2819      +
;  DATA    
2820      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2821      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2821      +
PROC SQL;  
2821      +
  DELETE FROM
2822      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2822      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2822      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2823      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2824      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2823:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
669                                         The SAS System             22:41 Saturday, January 6, 2024

      

2824      +                                   PROC SQL;
2824      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2825      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2826      + RDB_TABLE_NM='D_INV_TREATMENT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
2827      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2827      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2827      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2827      +
PROC SORT  
2828      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2828      +                                                   ;
2828      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2829      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

670                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2829      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2830      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2831      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2831      +
PROC SQL;  
2831      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2832      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2832      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2832      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2832      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2833      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2834      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
671                                         The SAS System             22:41 Saturday, January 6, 2024

TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2834:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2834      +
PROC SQL;  
2834      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2835      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2836      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_TREATMENT'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2837      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2838      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2838      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2838      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2838      +
PROC SORT DATA=D_INV_METADATA_UNIT
2839      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
672                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2839      +                           ;
2839      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2840      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2840      +
DATA D_INV_METADATA_UNIT; SET
2841      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2842      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2842      +
PROC SQL;  
2842      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2843      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2843      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2843      +                                                                    DATA _NULL_;  CALL 
673                                         The SAS System             22:41 Saturday, January 6, 2024

SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2843      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2844      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2845      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2845:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2845      +
PROC SQL;  
2845      +
  CREATE TABLE D_INV_TREATMENT AS   SELECT
2846      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_TREATMENT ON
2847      + &FACT_CASE .D_INV_TREATMENT_KEY  =D_INV_TREATMENT .D_INV_TREATMENT_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_TREATMENT; SET D_INV_TREATMENT;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_TREATMENT increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_TREATMENT created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.01 seconds
      

2848      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
674                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_TREATMENT.
NOTE: The data set WORK.D_INV_TREATMENT has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_TREATMENT increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2850      + PROC SQL;
2850      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2850      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2850      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2850      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2850      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2851      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2851      +
PROC SQL;  
2851      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2852      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2853      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS
675                                         The SAS System             22:41 Saturday, January 6, 2024

2854      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2854      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2855      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_TRAVEL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2855      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

2855      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2855      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2855      +
;          
2855      +
DATA DYNINVLISTING
2856      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2857      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
676                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2857      +
PROC SQL;  
2857      +
  DELETE FROM
2858      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2858      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2858      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2859      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2860      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2859:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2860      +                                   PROC SQL;
2860      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2861      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2862      + RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
2863      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
677                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2863      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

2863      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2863      +
PROC SORT DATA=D_INV_METADATA_OTH
2864      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2864      +                           ;
2864      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2865      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2865      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2866      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2867      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
678                                         The SAS System             22:41 Saturday, January 6, 2024

COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2867      +
PROC SQL;  
2867      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2868      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2868      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2868      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2868      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2869      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2870      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2869:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2870      +
PROC SQL;  
2870      +
679                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2871      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2872      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2873      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
2874      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2874      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2874      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2874      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2874      +
;   DATA   
2875      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
2876      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
680                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

2876      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
2877      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2878      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2878      +
PROC SQL;  
2878      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2879      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2879      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2879      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2879      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2880      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2881      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2880:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
681                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2881      +
PROC SQL;  
2881      +
  CREATE TABLE D_INV_TRAVEL AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
2882      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_TRAVEL ON  &FACT_CASE .D_INV_TRAVEL_KEY  =D_INV_TRAVEL
2883      + .D_INV_TRAVEL_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC');
NOTE: Compressing data set WORK.D_INV_TRAVEL increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_TRAVEL created, with 1418 rows and 2 columns.

2883      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      

2883      +
;          
2883      +
DATA D_INV_TRAVEL; SET D_INV_TRAVEL;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN
2884      +;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_TRAVEL.
NOTE: The data set WORK.D_INV_TRAVEL has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_TRAVEL increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2885      + PROC SQL;
2885      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
682                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2885      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2885      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2885      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2885      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2886      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2886      +
PROC SQL;  
2886      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2887      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2888      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND
2889      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2889      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
2890      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_UNDER_CONDITION'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2890      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
683                                         The SAS System             22:41 Saturday, January 6, 2024

      

2890      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2890      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
2891      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2891      +              ;
2891      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
2892      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2892      +
PROC SQL;  
2893      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2893      +                                                                                       
684                                         The SAS System             22:41 Saturday, January 6, 2024

QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2893      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2894      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
2895      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2894:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2895      +                                                         PROC SQL;
2895      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
2896      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
2897      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
2898      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2898      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.04 seconds
      

2898      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
2899      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
685                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2899      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2899      +
;          
2899      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
2900      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
2901      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2901      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
2902      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
2903      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2903      +               PROC SQL;
2903      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
686                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2903      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2903      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2903      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
2904      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
2905      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2905:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2905      +
PROC SQL;  
2905      +
  CREATE TABLE
2906      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2907      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
2908      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
2909      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.
687                                         The SAS System             22:41 Saturday, January 6, 2024


2909      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

2909      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
2910      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2910      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2910      +                                                                           ;
2910      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
2911      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
2912      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2912      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
2913      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

688                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2913      +
PROC SQL;  
2914      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2914      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2914      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2914      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
2915      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
2916      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2916:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2916      +
PROC SQL;  
2916      +
  CREATE TABLE
689                                         The SAS System             22:41 Saturday, January 6, 2024

2917      + D_INV_UNDER_CONDITION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
2918      +  NBS_RDB. D_INV_UNDER_CONDITION ON  &FACT_CASE .D_INV_UNDER_CONDITION_KEY  
=D_INV_UNDER_CONDITION .D_INV_UNDER_CONDITION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_UNDER_CONDITION created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      

2919      + D_INV_UNDER_CONDITION; SET D_INV_UNDER_CONDITION;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_UNDER_CONDITION.
NOTE: The data set WORK.D_INV_UNDER_CONDITION has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2920      + PROC SQL;
2920      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2920      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2920      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2920      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
690                                         The SAS System             22:41 Saturday, January 6, 2024


2920      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2921      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2921      +
PROC SQL;  
2921      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2922      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2923      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2924      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2924      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
2925      + WHERE DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_VACCINATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2925      +                                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.03 seconds
      

2925      +                                                                          DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2925      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

691                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2925      +
;  DATA    
2926      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
2927      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2927      +
PROC SQL;  
2927      +
  DELETE FROM
2928      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2928      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2928      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2929      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
2930      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2929:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
692                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2930      +                                   PROC SQL;
2930      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
2931      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
2932      + RDB_TABLE_NM='D_INV_VACCINATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
2933      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2933      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

2933      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2933      +
PROC SORT  
2934      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

693                                         The SAS System             22:41 Saturday, January 6, 2024

2934      +                                                   ;
2934      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
2935      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2935      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
2936      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
2937      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2937      +
PROC SQL;  
2937      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
2938      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2938      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2938      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
694                                         The SAS System             22:41 Saturday, January 6, 2024


2938      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
2939      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
2940      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2940:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2940      +
PROC SQL;  
2940      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
2941      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
2942      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_VACCINATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2943      + DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2944      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2944      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

2944      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
695                                         The SAS System             22:41 Saturday, January 6, 2024

      

2944      +
PROC SORT DATA=D_INV_METADATA_UNIT
2945      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2945      +                           ;
2945      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
2946      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2946      +
DATA D_INV_METADATA_UNIT; SET
2947      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
2948      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2948      +
PROC SQL;  
2948      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
2949      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.
696                                         The SAS System             22:41 Saturday, January 6, 2024


2949      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2949      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2949      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
2950      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
2951      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2951:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2951      +
PROC SQL;  
2951      +
  CREATE TABLE D_INV_VACCINATION AS   SELECT
2952      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_VACCINATION ON
2953      + &FACT_CASE .D_INV_VACCINATION_KEY  =D_INV_VACCINATION .D_INV_VACCINATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC'); 
;QUIT;;    DATA D_INV_VACCINATION; SET D_INV_VACCINATION;  DROP _TEMA001
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_VACCINATION created, with 1418 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.04 seconds
      
697                                         The SAS System             22:41 Saturday, January 6, 2024


2954      + _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1418 observations read from the data set WORK.D_INV_VACCINATION.
NOTE: The data set WORK.D_INV_VACCINATION has 1418 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2955      + PROC SQL;
2955      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
2955      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

2955      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

2955      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2955      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
2956      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2956      +
PROC SQL;  
2956      +
698                                         The SAS System             22:41 Saturday, January 6, 2024

  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
2957      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
2958      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_STD'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL
2959      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

2959      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
2960      + DATAMART_NM='AL_NIC'),  RDB_TABLE_NM='D_INV_STD'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

2960      +                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.01 seconds
      

2960      +                                                            DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2960      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2960      +
;          
2960      +
DATA DYNINVLISTING;   SET
2961      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
699                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
2962      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2962      +
PROC SQL;  
2962      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
2963      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

2963      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2963      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
2964      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2964:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2965      + PROC SQL;
2965      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
700                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_ODS.NBS_UI_METADATA  INNER JOIN
2966      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_STD'    AND
2967      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
2968      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

2968      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.07 seconds
      

2968      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2968      +
PROC SORT DATA=D_INV_METADATA_OTH
2969      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2969      +                           ;
2969      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
2970      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
701                                         The SAS System             22:41 Saturday, January 6, 2024

      

2970      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
2971      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
2972      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2972      +
PROC SQL;  
2972      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
2973      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

2973      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2973      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2973      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
2974      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
2975      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2974:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
702                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2975      +
PROC SQL;  
2975      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
2976      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
2977      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_STD'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND QUESTION_GROUP_SEQ_NBR
2978      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
2979      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

2979      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.01 seconds
      

2979      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2979      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2979      +
;          
2979      +
DATA D_INV_METADATA_UNIT; LENGTH
2980      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
703                                         The SAS System             22:41 Saturday, January 6, 2024

D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
2981      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2981      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
2982      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
2983      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2983      +
PROC SQL;  
2983      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

2984      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2984      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2984      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
2985      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
704                                         The SAS System             22:41 Saturday, January 6, 2024

TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
2986      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2985:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2986      +
PROC SQL;  
2986      +
       CREATE TABLE D_INV_STD AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
2987      + NBS_RDB.SUMM_DATAMART;
NOTE: Compressing data set WORK.D_INV_STD increased size by 66.67 percent. 
      Compressed is 10 pages; un-compressed would require 6 pages.
NOTE: Table WORK.D_INV_STD created, with 1419 rows and 2 columns.

2987      +                        ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2987      +                              ;
2987      +                                   DATA D_INV_STD; SET D_INV_STD;  DROP _TEMA001 _TEMA002 
_TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

NOTE: Compression was disabled for data set WORK.D_INV_STD because compression overhead would 
      increase the size of the data set.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1419 observations read from the data set WORK.D_INV_STD.
NOTE: The data set WORK.D_INV_STD has 1419 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2988      + PROC SQL;
2988      +           CREATE TABLE ORGANIZATION_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
705                                         The SAS System             22:41 Saturday, January 6, 2024

 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
2989      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
2990      + IS NOT NULL AND RDB_TABLE_NM ='D_ORGANIZATION' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.ORGANIZATION_METADATA created, with 2 rows and 3 columns.

2990      +                                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      

2990      +                                                                            DATA 
ORGANIZATION_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET ORGANIZATION_METADATA;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2990      +
PROC SORT DATA=ORGANIZATION_METADATA NODUPKEY; BY
2991      + SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2991      +              ;
2991      +                PROC SQL;
2991      +                          CREATE TABLE ORGANIZATION  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.ORGANIZATION because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.ORGANIZATION created, with 0 rows and 1 columns.
2991      +                                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

706                                         The SAS System             22:41 Saturday, January 6, 2024

2991      +                                                                                     DATA 
ORGANIZATION_METADATA;   SET ORGANIZATION_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF 
FIRST.SORT_KEY THEN  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
2992      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
2993      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY';    KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY';  DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1,
2994      + INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL';  QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 
1, INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC';  UID= USER_DEFINED_COLUMN_NM;  call 
execute('%POPULATE_ORGANIZATION('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||
2995      + KEY||','||  DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2994:234   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 9 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
2         + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
3         + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
HOSPITAL_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
4         + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
HOSPITAL_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 89.58 percent. 
      Compressed is 5 pages; un-compressed would require 48 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 1418 rows and 15 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

4         +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH HSP_DETAIL  $2000;   IF
5         + ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; HSP_KEY=ORGANIZATION_KEY; HSP_QEC 
707                                         The SAS System             22:41 Saturday, January 6, 2024

=ORGANIZATION_QUICK_CODE; HSP_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN 
CITY_STATE_ZIP =PROPCASE(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM
6         +(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || TRIM(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM
7         +(ORGANIZATION_LOCAL_ID))>0 THEN HSP_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN HSP_DETAIL =TRIM(HSP_DETAIL) ||'<br>' || 
PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN
8         + HSP_DETAIL=  TRIM(HSP_DETAIL) ||'<br>' ||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); 
IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0 then HSP_DETAIL=  TRIM(HSP_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM
9         +(CITY_STATE_ZIP))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ; 
IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || 
PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0
10        + then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
HSP_DETAIL= TRIM(HSP_DETAIL)|| ', ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK)
11        +; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br> ext. ' || 
TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(HSP_DETAIL))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)||
12        + '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME ORGANIZATION_STREET_ADDRESS_1 
ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  
ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP ORGANIZATION_CITY
13        + ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE HOSPITAL_KEY;  RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 1418 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13        +                                                                                    PROC 
SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 1418 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

13        +
DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 1418 observations and 6 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 97.54 percent. 
708                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

14        + PROC SQL;
14        +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
15        + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
16        + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
ORG_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
17        + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
ORG_AS_REPORTER_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 89.58 percent. 
      Compressed is 5 pages; un-compressed would require 48 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 1418 rows and 15 columns.

17        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.01 seconds
      

17        +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH REPORTING_FACILITY_DETAIL  
$2000;
18        +   IF   ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; 
REPORTING_FACILITY_KEY=ORGANIZATION_KEY; REPORTING_FACILITY_QEC =ORGANIZATION_QUICK_CODE; 
REPORTING_FACILITY_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN CITY_STATE_ZIP 
=PROPCASE
19        +(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF 
LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || TRIM
20        +(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM(ORGANIZATION_LOCAL_ID))>0 THEN 
REPORTING_FACILITY_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN REPORTING_FACILITY_DETAIL =TRIM(REPORTING_FACILITY_DETAIL) 
||'<br>' ||
21        + PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN 
REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) ||'<br>' 
||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0
22        + then REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM
23        +(CITY_STATE_ZIP) ; IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 then REPORTING_FACILITY_DETAIL= TRIM
24        +(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
709                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| ', ext. ' || TRIM
25        +(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br> ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN
26        +(TRIM(REPORTING_FACILITY_DETAIL))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME 
ORGANIZATION_STREET_ADDRESS_1 ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY
27        + ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP 
ORGANIZATION_CITY ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE ORG_AS_REPORTER_KEY;  
RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 1418 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

27        +
PROC SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY
28        +;RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 1418 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

28        +       DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 1418 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 1418 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 1418 observations and 10 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 98.73 percent. 
      Compressed is 6 pages; un-compressed would require 473 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2996      + PROC SQL;
2996      +           CREATE TABLE PROVIDER_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
2997      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
710                                         The SAS System             22:41 Saturday, January 6, 2024

2998      + IS NOT NULL AND RDB_TABLE_NM ='D_PROVIDER' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PROVIDER_METADATA created, with 3 rows and 3 columns.

2998      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.00 seconds
      

2998      +                                                                        DATA 
PROVIDER_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PROVIDER_METADATA;    SORT_KEY+1;  OUTPUT;      
 RUN;

NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 4 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2998      +
PROC SORT DATA=PROVIDER_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 4 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

2998      +
; PROC     
2999      + SQL;
2999      +      CREATE TABLE PROVIDER  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.PROVIDER because compression overhead would increase 
      the size of the data set.
NOTE: Table WORK.PROVIDER created, with 0 rows and 1 columns.
2999      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2999      +                                                             DATA PROVIDER_METADATA;   SET 
PROVIDER_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF FIRST.SORT_KEY THEN  IF part_type_cd= 
'CASupervisorOfPHC' THEN
3000      + PART_TYPE_CD='SUPRVSR_OF_CASE_ASSGNMENT_KEY';  IF part_type_cd= 'ClosureInvestgrOfPHC' 
711                                         The SAS System             22:41 Saturday, January 6, 2024

THEN PART_TYPE_CD='CLOSED_BY_KEY';  IF part_type_cd= 'DispoFldFupInvestgrOfPHC' THEN 
PART_TYPE_CD='DISPOSITIONED_BY_KEY';  IF part_type_cd= 'FldFupInvestgrOfPHC' THEN
3001      + PART_TYPE_CD='INVSTGTR_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupProvOfPHC' THEN 
PART_TYPE_CD='PROVIDER_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupSupervisorOfPHC' THEN 
PART_TYPE_CD='SUPRVSR_OF_FLD_FOLLOW_UP_KEY';  IF part_type_cd=
3002      + 'InitFldFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_ASGNED_FLD_FOLLOW_UP_KEY';  IF 
part_type_cd= 'InitFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_FOLLOW_UP_INVSTGTR_KEY';  IF 
part_type_cd= 'InitInterviewerOfPHC' THEN
3003      + PART_TYPE_CD='INIT_ASGNED_INTERVIEWER_KEY';  IF part_type_cd= 'InterviewerOfPHC' THEN 
PART_TYPE_CD='INTERVIEWER_ASSIGNED_KEY';  IF part_type_cd= 'InvestgrOfPHC' THEN 
PART_TYPE_CD='INVESTIGATOR_KEY';  IF part_type_cd= 'PerAsProviderOfDelivery' THEN
3004      + PART_TYPE_CD='DELIVERING_MD_KEY';  IF part_type_cd= 'PerAsProviderOfOBGYN' THEN 
PART_TYPE_CD='MOTHER_OB_GYN_KEY';  IF part_type_cd= 'PerAsProvideroOfPediatrics' THEN 
PART_TYPE_CD='PEDIATRICIAN_KEY';  IF part_type_cd= 'PerAsReporterOfPHC' THEN
3005      + PART_TYPE_CD='PERSON_AS_REPORTER_KEY';  IF part_type_cd= 'PhysicianOfPHC' THEN 
PART_TYPE_CD='PHYSICIAN_KEY';  IF part_type_cd= 'SurvInvestgrOfPHC' THEN 
PART_TYPE_CD='SURVEILLANCE_INVESTIGATOR_KEY';  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
3006      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
3007      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY'; KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY'; DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, INDEX
3008      +(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL'; QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC'; UID = USER_DEFINED_COLUMN_NM; call 
execute('%POPULATE_PROVIDER('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||  KEY||','||
3009      + DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3008:222   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 9 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
2         + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
3         + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
INVESTIGATOR_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON
4         + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
712                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . INVESTIGATOR_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 88.00 percent. 
      Compressed is 9 pages; un-compressed would require 75 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 1418 rows and 20 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

4         +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
5         + PHC_INV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  PHC_INV_KEY=PROVIDER_KEY;  PHC_INV_QEC =PROVIDER_QUICK_CODE;  
PHC_INV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
6         + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
7         +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
8         +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
9         + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
10        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
11        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
12        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN PHC_INV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHC_INV_DETAIL 
=TRIM(PHC_INV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
13        + PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
14        +(TRIM(CITY_STATE_ZIP))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHC_INV_DETAIL= 
TRIM(PHC_INV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
15        +(PROVIDER_PHONE_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| ', ext. ' || TRIM
16        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHC_INV_DETAIL))>0 then
17        + PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
713                                         The SAS System             22:41 Saturday, January 6, 2024

18        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE INVESTIGATOR_KEY;  RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 94.58 percent. 
      Compressed is 11 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

18        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 94.58 percent. 
      Compressed is 11 pages; un-compressed would require 203 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

18        +
  DATA     
19        + PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 94.58 percent. 
      Compressed is 11 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

20        + PROC SQL;
20        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
21        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
22        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PHYSICIAN_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON
23        + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PHYSICIAN_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.33 percent. 
714                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 5 pages; un-compressed would require 75 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 1418 rows and 20 columns.

23        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.01 seconds
      

23        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH PHYS_DETAIL
24        + $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN PROVIDER_KEY=.;  
PHYS_KEY=PROVIDER_KEY;  PHYS_QEC =PROVIDER_QUICK_CODE;  PHYS_UID=PROVIDER_UID;   IF 
LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP =PROPCASE(TRIM(PROVIDER_CITY));
25        + IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE(TRIM(PROVIDER_ZIP)) ;
26        + PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF LENGTHN(TRIM(PROVIDER_NAME))>0 
AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| 
PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0
27        + AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM
28        +(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME
29        + =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN
30        +(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| 
TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE 
))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If LENGTHN(TRIM
31        +(PROVIDER_LOCAL_ID))>0 THEN PHYS_DETAIL ='<b></b>' ||TRIM(PROVIDER_LOCAL_ID);  If 
LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHYS_DETAIL =TRIM(PHYS_DETAIL) ||'<br>' || PROVIDER_NAME;  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN PHYS_DETAIL=  TRIM
32        +(PHYS_DETAIL) ||'<br>' ||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN PHYS_DETAIL=  TRIM(PHYS_DETAIL) || '<br>' || 
PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 THEN
33        + PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ;  IF 
LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || 
PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 THEN PHYS_DETAIL= TRIM
34        +(PHYS_DETAIL)|| '<br>' || TRIM(PROVIDER_PHONE_WORK) ;  IF 
LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| ', ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM
35        +(PROVIDER_PHONE_WORK))=0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| '<br> ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHYS_DETAIL))>0 
then PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>';     DROP
36        + PROVIDER_NAME PROVIDER_FIRST_NAME PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME 
PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK    PROVIDER_STREET_ADDRESS_1 
PROVIDER_STREET_ADDRESS_2 PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY
37        + PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE 
PROVIDER_QUICK_CODE PHYSICIAN_KEY;  RUN;

715                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

37        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

37        +
DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY
38        + INVESTIGATION_KEY; RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 1418 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 1418 observations and 11 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 97.46 percent. 
      Compressed is 12 pages; un-compressed would require 473 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

39        + PROC SQL;
39        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
40        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
41        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PERSON_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART INNER JOIN  NBS_RDB. F_PAGE_CASE
42        + ON SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PERSON_AS_REPORTER_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 93.33 percent. 
      Compressed is 5 pages; un-compressed would require 75 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 1418 rows and 20 columns.

716                                         The SAS System             22:41 Saturday, January 6, 2024

42        +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.04 seconds
      

42        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
43        + RPT_PRV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  RPT_PRV_KEY=PROVIDER_KEY;  RPT_PRV_QEC =PROVIDER_QUICK_CODE;  
RPT_PRV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
44        + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
45        +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
46        +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
47        + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
48        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
49        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
50        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN RPT_PRV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN RPT_PRV_DETAIL 
=TRIM(RPT_PRV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
51        + RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
52        +(TRIM(CITY_STATE_ZIP))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN RPT_PRV_DETAIL= 
TRIM(RPT_PRV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
53        +(PROVIDER_PHONE_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| ', ext. ' || TRIM
54        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(RPT_PRV_DETAIL))>0 then
55        + RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
56        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE PERSON_AS_REPORTER_KEY;  RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
717                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

56        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 1418 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 97.54 percent. 
      Compressed is 5 pages; un-compressed would require 203 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

57        + DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 1418 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 1418 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 1418 observations and 15 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 98.03 percent. 
      Compressed is 14 pages; un-compressed would require 709 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3010      + PROC SQL;
3010      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
3011      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3012      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM
3013      +;
NOTE: Compressing data set WORK.METADATA_INIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_INIT created, with 1 rows and 5 columns.

3013      +  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3013      +          PROC SQL;
718                                         The SAS System             22:41 Saturday, January 6, 2024

3013      +                    CREATE TABLE METADATA_UNIT AS   SELECT  INIT.DATAMART_NM, 
RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM, OTHER_VALUE_IND_CD 
FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
3014      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3015      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded','CODED') ) AND OTHER_VALUE_IND_CD='T' ORDER BY
3016      + RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_UNIT created, with 0 rows and 6 columns.

3016      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.20 seconds
      cpu time            0.07 seconds
      

3016      +                       DATA METADATA_UNIT; SET METADATA_UNIT; LENGTH RDB_COLUMN_NM3 $22; 
LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= TRIM(RDB_COLUMN_NM3) || 
'_OTH';  USER_DEFINED_COLUMN_NM = TRIM(USER_DEFINED_COLUMN_NM)||
3017      + '_OTH';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 RDB_COLUMN_NM3; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3017      +                                                                                   PROC 
SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3017      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 1 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3017      +
719                                         The SAS System             22:41 Saturday, January 6, 2024

DATA METADATA; SET METADATA; LENGTH
3018      + USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_5 $15000;  USER_DEFINED_COLUMN_NM_1=COMPRESS
3019      +(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); 
USER_DEFINED_COLUMN_NM_4=COMPRESS(USER_DEFINED_COLUMN_NM|| '_4');
3020      + USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. 
THEN BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF 
BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0
3021      + THEN USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 
= '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN
3022      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN 
USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN
3023      + USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   IF BLOCK_PIVOT_NBR = 3 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN
3024      + USER_DEFINED_COLUMN_NM_5 = '';   RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 1 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3024      +                                          PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 1 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3024      +                                                                                          
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2 
USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4
3025      + USER_DEFINED_COLUMN_NM_5; COPY  BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 1 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
720                                         The SAS System             22:41 Saturday, January 6, 2024

      

3025      +                                                                        DATA METADATA_OUT; 
SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3025:137   
NOTE: There were 5 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3025      +
PROC SQL;  
3025      +
 CREATE TABLE METADATA_OUT as select RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 4 columns.

3025      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3026      + PROC SQL;
3026      +            DELETE * FROM METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

3026      +                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3026      +                                                                   PROC SQL;
3026      +                                                                             CREATE TABLE 
METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 1 rows and 4 columns.

3026      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
721                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3026      +
PROC SQL;  
3026      +
  CREATE TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*,
3027      + METADATA_OUT1.BLOCK_NM AS BLOCK_NM1  FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  
UPCASE(METADATA_OUT1.RDB_COLUMN_NM) = UPCASE(METADATA_OUT.RDB_COLUMN_NM);
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 5 columns.

3027      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3027      +
DATA METADATA_OUT; SET METADATA_OUT;   ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max
3028      +(1,length(COL1)),1), comma20.);  DROP BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 5 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3028      +                                                                                    PROC 
SQL;
3028      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3028      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3028      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from
3029      + CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3029      +                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
722                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3029      +                                   DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call 
symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3029      +
PROC SQL;  
3029      +
   CREATE TABLE D_INV_REPEAT_METADATA AS
3030      + SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM 
METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 1 rows and 4 columns.

3030      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3030      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 2 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3030      +
PROC SORT  
3031      + DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 1 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
723                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3031      +                                                      ;
3031      +
DATA DYNINVLISTING;
3032      +                                                                                           
                         SET D_INV_REPEAT_METADATA;
3033      +                     BY SORT_KEY;
3034      +                                                                              LENGTH 
RDB_COLUMN_NAME_LIST $15000;                                                                          
                                               RETAIN
3035      + RDB_COLUMN_NAME_LIST;
3036      +                                                   LENGTH RDB_COLUMN_LIST $15000;          
                                                                                                      
              RETAIN RDB_COLUMN_LIST;
3037      +
3038      +         LENGTH RDB_COLUMN_COMMA_LIST $15000;                                              
                                                                          RETAIN 
RDB_COLUMN_COMMA_LIST;
3039      +                                                                                           
                                                                                                      
                             IF FIRST.SORT_KEY AND NOT MISSING
3040      +(DATAMART_NM) THEN                                                                         
                                      USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3041      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
3042      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
3043      +                                                                                           
                                                         IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
3044      +                                                 IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
3045      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 1 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3045      +
PROC SQL;  
3046      +                                                                                           
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
724                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3046      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3047      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');   CALL SYMPUTX('D_REPEAT_CASE_NAME', 
'');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3047      +
DATA DYNINVLISTING; SET DYNINVLISTING;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL 
SYMPUTX('D_REPEAT_CASE_NAME', '');
3048      + CALL SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST)); 
 RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL
3049      + SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', 
RDB_COLUMN_LIST);  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3049      +
PROC SQL;  
3049      +
  CREATE TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME
3050      + ANSWER_GROUP_SEQ_NBR, D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, 
SUMM_DATAMART.INVESTIGATION_KEY, D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER 
JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE
3051      + .INVESTIGATION_KEY  INNER JOIN  NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE 
.D_INVESTIGATION_REPEAT_KEY  =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1; ; QUIT;    PROC SQL; DELETE FROM
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 96.26 percent. 
      Compressed is 21 pages; un-compressed would require 561 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 3926 rows and 5 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.03 seconds
725                                         The SAS System             22:41 Saturday, January 6, 2024

      

3052      + REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

3052      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3052      +                                                                   PROC SORT 
DATA=REPEAT_BLOCK ; BY INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 3926 observations and 5 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 96.26 percent. 
      Compressed is 21 pages; un-compressed would require 561 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3052      +
PROC TRANSPOSE DATA=REPEAT_BLOCK OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY
3053      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 3926 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.37 percent. 
      Compressed is 26 pages; un-compressed would require 562 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

3053      +                                                         DATA REPEAT_BLOCK_OUT; set 
REPEAT_BLOCK_OUT; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 3926 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 94.84 percent. 
      Compressed is 29 pages; un-compressed would require 562 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3053      +
PROC SQL;  
3053      +
 CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN
3054      + NBS_ODS.NBS_UI_METADATA   ON  NBS_RDB_METADATA.NBS_UI_METADATA_UID 
726                                         The SAS System             22:41 Saturday, January 6, 2024

=NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE  BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3055      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
3056      + RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 1 rows and 2 columns.

3056      +                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

3056      +                                PROC SQL;
3056      +                                          CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM, 
 RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID
3057      + WHERE BLOCK_NM IS NOT NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND RDB_TABLE_NM
3058      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 'Coded' 
,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 1 rows and 2 columns.

3058      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

3058      +
PROC SQL;  
3058      +
 CREATE TABLE BLOCK_DATA_OTH AS SELECT BLOCK_NM,  RDB_COLUMN_NM FROM
3059      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3060      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  
and (code_set_group_id >0  OR data_type in ( 'Coded'
3061      + ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 1 rows and 2 columns.

3061      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
727                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

3061      +                                                                            DATA 
BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM $30; LENGTH RDB_COLUMN_NM2 $22; 
RDB_COLUMN_NM2= RDB_COLUMN_NM; RDB_COLUMN_NM=COMPRESS(RDB_COLUMN_NM2 || '_OTH'); DROP
3062      + RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 1 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3062      +                       PROC SQL;
3062      +                                 CREATE TABLE BLOCK_DATA AS SELECT * FROM BLOCK_DATA_PL 
UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 2 rows and 2 columns.

3062      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3062      +
PROC SQL;  
3062      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT
3063      + INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM =BLOCK_DATA.BLOCK_NM  AND 
UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 94.84 percent. 
      Compressed is 29 pages; un-compressed would require 562 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 3926 rows and 7 columns.

3063      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

3063      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT
3064      + BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

728                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3064      +                                         PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; 
BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 3926 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 94.84 percent. 
      Compressed is 29 pages; un-compressed would require 562 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3064      +
DATA REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM
3065      + BLOCK_NM ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  FORMAT 
ANSWER_DESCCHECK $10.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;
3066      +  IF FIRST.RDB_COLUMN_NM  THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; 
ANSWER_DESC21 = '';  END;  I+1;  IF I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND 
LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN
3067      + ANSWER_DESC21 =  LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ 
'|| LEFT(TRIM(col1)) ;  END;  IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ col1 I J; RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 1266 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 97.32 percent. 
      Compressed is 17 pages; un-compressed would require 634 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3067      +
DATA REPEAT_BLOCK_OUT_BASE ; SET
3068      + REPEAT_BLOCK_OUT_BASE ; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 3926 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 94.84 percent. 
      Compressed is 29 pages; un-compressed would require 562 pages.
NOTE: DATA statement used (Total process time):
729                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

3068      +                                                       DATA REPEAT_BLOCK_OUT_BASE; SET 
REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN
3069      + COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 
THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 
=' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF
3070      + ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
3071      + 4 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF
3072      + ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: There were 3926 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 3926 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 97.40 percent. 
      Compressed is 34 pages; un-compressed would require 1309 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3072      +                                                   PROC SQL;
3072      +                                                             CREATE TABLE METADATA_OUT as 
select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 5 columns.

3072      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3072      +
PROC SQL;  
3072      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM
3073      + METADATA_OUT LEFT OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  
= UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR 
=REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM =
3074      + REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
730                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.96 percent. 
      Compressed is 27 pages; un-compressed would require 2588 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 2588 rows and 12 columns.

3074      +                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.35 seconds
      

3074      +                                           PROC SORT DATA=METADATA_MERGED_INIT ; BY 
INVESTIGATION_KEY;RUN;

NOTE: There were 2588 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 2588 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.96 percent. 
      Compressed is 27 pages; un-compressed would require 2588 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

3074      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_VARCHAR;  VAR DATA_VALUE;  ID COL1; 
    BY INVESTIGATION_KEY; RUN;

WARNING: 2 observations omitted due to missing ID values.
NOTE: There were 2588 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 1267 observations and 5 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 98.26 percent. 
      Compressed is 11 pages; un-compressed would require 634 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3074      +
  DATA     
3075      + INVESTIGATION_REPEAT_VARCHAR; SET INVESTIGATION_REPEAT_VARCHAR; DROP _NAME_; RUN;

NOTE: There were 1267 observations read from the data set WORK.INVESTIGATION_REPEAT_VARCHAR.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 1267 observations and 4 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 98.42 percent. 
      Compressed is 10 pages; un-compressed would require 634 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3075      +                                                                                      PROC 
SQL;
3075      +
731                                         The SAS System             22:41 Saturday, January 6, 2024

 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM 
D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 1 rows and 2 columns.

3075      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3075      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH
3076      + USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = 
COMPRESS(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 1 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 1 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3076      +
PROC SQL;  
3076      +
 CREATE TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*,
3077      + REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_ALL  ON UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = 
UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 98.58 percent. 
      Compressed is 18 pages; un-compressed would require 1266 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 1266 rows and 7 columns.

3077      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

3077      +
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 1266 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 1266 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 98.58 percent. 
      Compressed is 18 pages; un-compressed would require 1266 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
732                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

3078      + PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_VARCHAR_ALL;  VAR 
ANSWER_DESC21;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 1266 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 1266 observations and 3 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 97.63 percent. 
      Compressed is 15 pages; un-compressed would require 634 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

3078      +
DATA REPEAT_BLOCK_VARCHAR_ALL; SET REPEAT_BLOCK_VARCHAR_ALL; DROP _NAME_; RUN;

NOTE: There were 1266 observations read from the data set WORK.REPEAT_BLOCK_VARCHAR_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 1266 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 97.79 percent. 
      Compressed is 14 pages; un-compressed would require 634 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3079      + PROC SQL;
3079      +           CREATE TABLE METADATA AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3080      + NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3081      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and data_type in ( 'DATETIME','DATE', 
'Date','Date/Time')  and code_set_group_id is null ORDER BY
3082      + RDB_COLUMN_NM;
NOTE: Table WORK.METADATA created, with 0 rows and 5 columns.

3082      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

3082      +                        DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000
3083      +;  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
3084      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
733                                         The SAS System             22:41 Saturday, January 6, 2024

BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
3085      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
3086      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
3087      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
3088      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3088      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA has 0 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3088      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
3089      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 3 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3089      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: There were 5 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
734                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3089      +
PROC SQL;  
3089      +
 CREATE TABLE METADATA_OUT as select
3090      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 4 columns.

3090      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3090      +                                                                PROC SQL;
3090      +                                                                           DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: 5 rows were deleted from WORK.METADATA_OUT.

3090      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3090      +
PROC SQL;  
3090      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Table WORK.METADATA_OUT1 created, with 0 rows and 4 columns.

3090      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3090      +
PROC SQL;  
3090      +
  CREATE TABLE
3091      + METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1  FROM 
METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.
735                                         The SAS System             22:41 Saturday, January 6, 2024


3091      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3091      +
DATA METADATA_OUT; SET METADATA_OUT;
3092      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3092:57   
NOTE: There were 0 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3092      +
PROC SQL;  
3092      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3092      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3092      +
  UPDATE STD_TESTER SET
3093      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3093      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3093      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

736                                         The SAS System             22:41 Saturday, January 6, 2024

3093      +
PROC SQL;
3093      +
  CREATE   
3094      + TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 0 rows and 4 columns.

3094      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3094      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
3095      + RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3095      +        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3095      +                                                                       ;
3095      +
DATA DYNINVLISTING;
3096      +                                                                                           
                                          SET D_INV_REPEAT_METADATA;
3097      +                                      BY SORT_KEY;
3098      +                                                                                           
    LENGTH RDB_COLUMN_NAME_LIST $15000;
3099      + RETAIN RDB_COLUMN_NAME_LIST;
3100      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
3101      +
3102      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
3103      +                                                                                           
737                                         The SAS System             22:41 Saturday, January 6, 2024

                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
3104      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3105      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
3106      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
3107      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
3108      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
3109      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3109      +
PROC SQL;  
3110      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3110      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3111      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3111      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
3112      +('D_REPEAT_COMMA_NAME', ''); RUN;
738                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3112      +                                  DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3113      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
3114      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3114      +                                                                     PROC SQL;
3114      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
3115      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
3116      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 29.09 percent. 
      Compressed is 39 pages; un-compressed would require 55 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 3926 rows and 4 columns.

3116      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.20 seconds
      cpu time            0.00 seconds
      

3116      +
PROC SQL;  
3116      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: 3926 rows were deleted from WORK.REPEAT_BLOCK.

3116      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

739                                         The SAS System             22:41 Saturday, January 6, 2024

3116      +
PROC SORT DATA=REPEAT_BLOCK ; BY
3117      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3117      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: No variables to transpose.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3117      +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
3118      + RDB_COLUMN_NM = _NAME_; coloumnText=ANSWER_TXT;  rename col1=dateColumn; RUN;

NOTE: Variable ANSWER_TXT is uninitialized.
WARNING: The variable col1 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3118      +                                                                                PROC SQL;
3118      +                                                                                          
CREATE TABLE BLOCK_DATA AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN 
NBS_ODS.NBS_UI_METADATA   ON
3119      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE  
RDB_TABLE_NM='D_INVESTIGATION_REPEAT'  AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC')  AND PART_TYPE_CD IS NULL
3120      +  AND QUESTION_GROUP_SEQ_NBR IS NOT NULL   AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE 
'' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  AND NBS_RDB_METADATA.BLOCK_PIVOT_NBR IS 
NOT NULL  and data_type in ( 'DATETIME','DATE',
3121      + 'Date','Date/Time') and code_set_group_id is null   ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Table WORK.BLOCK_DATA created, with 0 rows and 2 columns.

3121      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
740                                         The SAS System             22:41 Saturday, January 6, 2024

      

3121      +
PROC SQL;  
3121      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA 
  ON  REPEAT_BLOCK_OUT.BLOCK_NM
3122      + =BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= 
UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 0 rows and 7 columns.

3122      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3122      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3122      +
PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY
3123      + INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3123      +                                                                      DATA 
REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESCCHECK $10.;  FORMAT
3124      + ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM  
THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = '';    END;   I = 0;
3125      + ANSWER_DESC21 = '';    ANSWER_DESCCHECK='';  END;  I+1;  X=LENGTHN(ANSWER_DESC21);  IF I 
<= 20 THEN DO;   TEXTDATE =  PUT(dateColumn, yymmddd10.);          ANSWER_DESC(I) = TEXTDATE;   IF 
LENGTHN(TEXTDATE)< 5 THEN TEXTDATE='';   IF LENGTHN(TEXTDATE)>4
3126      + AND LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN 
ANSWER_DESC21 =  LEFT(TRIM(TEXTDATE));   ELSE ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))|| ' ~ '|| 
741                                         The SAS System             22:41 Saturday, January 6, 2024

LEFT(TRIM(TEXTDATE));  END;   IF LAST.RDB_COLUMN_NM THEN OUTPUT;   IF  LENGTHN
3127      +(COMPRESS(ANSWER_DESCCHECK))<3 THEN ANSWER_DESC21='';  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ ANSWER_DESCCHECK I J; RUN;

NOTE: Variable dateColumn is uninitialized.
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3127      +
DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE ; DATA_VALUE=dateColumn; RDB_COLUMN_NM = 
_NAME_; RUN;

NOTE: Variable dateColumn is uninitialized.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3127      +
  DATA     
3128      + REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF
3129      + ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
3130      + 3 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 3 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF
3131      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      3129:38    3129:223   3130:154   3131:85    
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3131      +
PROC SQL;  
3131      +
 CREATE    
3132      + TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR 
742                                         The SAS System             22:41 Saturday, January 6, 2024

FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.

3132      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3132      +
PROC SQL;  
3132      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_BASE ON UPCASE
3133      +(METADATA_OUT.RDB_COLUMN_NM)  = UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND 
METADATA_OUT.ANSWER_GROUP_SEQ_NBR =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND 
METADATA_OUT.BLOCK_NM = REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable col1 already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 0 rows and 14 columns.

3133      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3133      +
PROC SORT  
3134      + DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_MERGED_INIT has 0 observations and 14 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3134      +                                                        PROC TRANSPOSE 
DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_DATE;  VAR dateColumn;  ID COL1;     BY 
INVESTIGATION_KEY; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1 observations and 2 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
743                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

3134      +
DATA INVESTIGATION_REPEAT_DATE; SET INVESTIGATION_REPEAT_DATE; DROP
3135      + _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.INVESTIGATION_REPEAT_DATE because compression 
      overhead would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.INVESTIGATION_REPEAT_DATE.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3135      +                 PROC SQL;
3135      +                           CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM  FROM D_INV_REPEAT_METADATA;
NOTE: Table WORK.REPEAT_ALL created, with 0 rows and 2 columns.

3135      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3135      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL 
= COMPRESS
3136      +(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3136      +                                                                       PROC SQL;
3136      +                                                                                 CREATE 
TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON UPCASE
3137      +(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 0 rows and 11 columns.

3137      +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

744                                         The SAS System             22:41 Saturday, January 6, 2024

3137      +                                                                                  PROC 
SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 0 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3137      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_DATE_ALL;  VAR ANSWER_DESC21;  ID
3138      + USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3138      +                                                              DATA REPEAT_BLOCK_DATE_ALL; 
SET REPEAT_BLOCK_DATE_ALL; DROP _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.REPEAT_BLOCK_DATE_ALL because compression overhead 
      would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.REPEAT_BLOCK_DATE_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3140      + PROC SQL;
3140      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
3141      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3142      + RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' 
and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL and (code_set_group_id >0  OR data_type in ( 
'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_INIT created, with 0 rows and 5 columns.

3142      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.07 seconds
      

745                                         The SAS System             22:41 Saturday, January 6, 2024

3142      +
PROC SQL;
3143      + CREATE TABLE METADATA_UNIT AS   SELECT  INIT.DATAMART_NM,RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR,BLOCK_NM, MASK FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3144      + NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND
3145      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND UNIT_TYPE_CD='CODED' AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS
3146      + NOT NULL   ORDER BY RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_UNIT created, with 0 rows and 6 columns.

3146      +                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3146      +                                           DATA METADATA_UNIT; SET METADATA_UNIT; LENGTH 
RDB_COLUMN_NM3 $21; LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= 
TRIM(RDB_COLUMN_NM3) || '_UNIT';  USER_DEFINED_COLUMN_NM = TRIM
3147      +(USER_DEFINED_COLUMN_NM)|| '_UNIT';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 
RDB_COLUMN_NM3; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3147      +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3147      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

746                                         The SAS System             22:41 Saturday, January 6, 2024

3147      +
  DATA
3148      + METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
3149      + USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
3150      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
3151      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
3152      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
3153      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
3154      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3154      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA has 0 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3154      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
3155      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 3 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
747                                         The SAS System             22:41 Saturday, January 6, 2024


3155      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: There were 5 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 5 observations and 4 variables.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3155      +
PROC SQL;  
3155      +
 CREATE TABLE METADATA_OUT as select
3156      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_OUT created, with 5 rows and 4 columns.

3156      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3156      +                                                                 PROC SQL;
3156      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: 5 rows were deleted from WORK.METADATA_OUT.

3156      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3156      +
PROC SQL;  
3156      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Table WORK.METADATA_OUT1 created, with 0 rows and 4 columns.

3156      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
748                                         The SAS System             22:41 Saturday, January 6, 2024


3156      +
PROC SQL;  
3156      +
  CREATE   
3157      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = 
METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.

3157      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3157      +
DATA METADATA_OUT; SET METADATA_OUT;
3158      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3158:57   
NOTE: There were 0 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3158      +
PROC SQL;  
3158      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3158      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3158      +
  UPDATE STD_TESTER SET
3159      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3159      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
749                                         The SAS System             22:41 Saturday, January 6, 2024


3159      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3159      +
PROC SQL;  
3160      + CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 0 rows and 4 columns.

3160      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3160      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
3161      +     RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3161      +            PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 0 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3161      +                                                                           ;
3161      +
DATA DYNINVLISTING;
3162      +                                                                                           
                                              SET D_INV_REPEAT_METADATA;
3163      +                                          BY SORT_KEY;
3164      +                                                                                           
        LENGTH RDB_COLUMN_NAME_LIST $15000;
750                                         The SAS System             22:41 Saturday, January 6, 2024

3165      + RETAIN RDB_COLUMN_NAME_LIST;
3166      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
3167      +
3168      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
3169      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
3170      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3171      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
3172      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
3173      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
3174      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
3175      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3175      +
PROC SQL;  
3176      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3176      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3177      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

751                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3177      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
3178      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3178      +                                   DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3179      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
3180      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 0 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3180      +                                                                     PROC SQL;
3180      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
3181      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
3182      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 29.09 percent. 
      Compressed is 39 pages; un-compressed would require 55 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 3926 rows and 4 columns.

3182      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.42 seconds
      cpu time            0.00 seconds
      

3182      +
PROC SQL;  
3182      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
752                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 3926 rows were deleted from WORK.REPEAT_BLOCK.

3182      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3182      +
PROC SORT DATA=REPEAT_BLOCK ; BY
3183      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3183      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: No variables to transpose.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3183      +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
3184      + RDB_COLUMN_NM = _NAME_; run;

NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3184      +                               PROC SQL;
3184      +                                         CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  
RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE
3185      + BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='AL_NIC') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM
3186      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Table WORK.BLOCK_DATA_PL created, with 0 rows and 2 columns.

753                                         The SAS System             22:41 Saturday, January 6, 2024

3186      +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

3186      +
PROC SQL;  
3186      +
 CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM,  COMPRESS(RDB_COLUMN_NM || '_UNIT') AS 
RDB_COLUMN_NM FROM
3187      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3188      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='AL_NIC') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  
and (code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC')
3189      + ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 0 rows and 2 columns.

3189      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.06 seconds
      

3189      +                                              PROC SQL;
3189      +                                                        CREATE TABLE BLOCK_DATA_OTH AS 
SELECT BLOCK_NM,  TRIM(RDB_COLUMN_NM || '_OTH') AS RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN NBS_ODS.NBS_UI_METADATA   ON
3190      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM 
IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='AL_NIC') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and
3191      +(code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, 
BLOCK_NM;
NOTE: Table WORK.BLOCK_DATA_OTH created, with 0 rows and 2 columns.

3191      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      

3191      +
DATA BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM2 $22; LENGTH RDB_COLUMN_NM $30; 
RDB_COLUMN_NM2=RDB_COLUMN_NM; RDB_COLUMN_NM = COMPRESS
WARNING: Length of character variable RDB_COLUMN_NM has already been set. 
         Use the LENGTH statement as the very first statement in the DATA STEP to declare the length 
         of a character variable.
3192      +(RDB_COLUMN_NM2|| '_OTH'); DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.BLOCK_DATA_OTH.
754                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.BLOCK_DATA_OTH has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3192      +                                                       PROC SQL;
3192      +                                                                 CREATE TABLE BLOCK_DATA 
AS SELECT * FROM BLOCK_DATA_PL  UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM 
BLOCK_DATA_OTH;
NOTE: Table WORK.BLOCK_DATA created, with 0 rows and 2 columns.

3192      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3192      +
PROC SQL;  
3192      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT
3193      + DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM 
=BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 0 rows and 5 columns.

3193      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3193      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE
3194      + BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3194      +                                                                                      PROC 
SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR ;RUN;
755                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3194      +
DATA REPEAT_BLOCK_OUT_ALL; SET
3195      + REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR; 
   FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;  FORMAT ANSWER_DESCCHECK 
$10.;   ARRAY ANSWER_DESC(20) ANSWER_DESC1-ANSWER_DESC20;
3196      + ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM 
 THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; ANSWER_DESC21 = '';  END;  I+1;  IF 
I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND LENGTHN
3197      +(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN ANSWER_DESC21 =  
LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ '|| LEFT(TRIM(col1)) ;  END;  
IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20
3198      + _NAME_ _LABEL_ col1 I J;     RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3196:232   3197:96    3197:172   
NOTE: Variable col1 is uninitialized.
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3198      +                                    DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE 
; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3198      +
DATA REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 
THEN COL2 =' ';   IF
3199      + ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR =
3200      + 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF
3201      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF 
756                                         The SAS System             22:41 Saturday, January 6, 2024

ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
3202      + 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 5 THEN COL4 =' ';    RUN;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      3199:177   3200:108   3201:38    3201:223   
NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 0 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3202      +
PROC SQL;  
3202      +
 CREATE TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM 
METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Table WORK.METADATA_OUT created, with 0 rows and 5 columns.

3202      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3203      + PROC SQL;
3203      +           CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT 
OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  = 
UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR
3204      + =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM = 
REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable col1 already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 0 rows and 11 columns.

3204      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3204      +
PROC SORT DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_MERGED_INIT has 0 observations and 11 variables.
757                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3204      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_NUMERIC;
3205      + VAR DATA_VALUE;  ID COL1;     BY INVESTIGATION_KEY; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1 observations and 2 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3205      +                                                           DATA 
INVESTIGATION_REPEAT_NUMERIC; SET INVESTIGATION_REPEAT_NUMERIC; DROP _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.INVESTIGATION_REPEAT_NUMERIC because compression 
      overhead would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.INVESTIGATION_REPEAT_NUMERIC.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3205      +
PROC SQL;  
3205      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM
3206      + D_INV_REPEAT_METADATA;
NOTE: Table WORK.REPEAT_ALL created, with 0 rows and 2 columns.

3206      +                        QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3206      +                               DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH 
USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = COMPRESS(USER_DEFINED_COLUMN_NM || 
'_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

758                                         The SAS System             22:41 Saturday, January 6, 2024

3206      +
PROC SQL;
3206      +
 CREATE TABLE
3207      + REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON 
UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 0 rows and 7 columns.

3207      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3207      +
PROC SQL;  
3208      + DELETE FROM REPEAT_BLOCK_METADATA_OUT WHERE USER_DEFINED_COLUMN_NM_ALL= '_ALL';
NOTE: No rows were deleted from WORK.REPEAT_BLOCK_METADATA_OUT.

3208      +                                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3208      +                                                                                          
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 0 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3208      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_NUMERIC_ALL;  VAR ANSWER_DESC21
3209      +;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 0 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3209      +                                                                   DATA 
REPEAT_BLOCK_NUMERIC_ALL; SET REPEAT_BLOCK_NUMERIC_ALL; DROP _NAME_; RUN;

NOTE: Compression was disabled for data set WORK.REPEAT_BLOCK_NUMERIC_ALL because compression 
759                                         The SAS System             22:41 Saturday, January 6, 2024

      overhead would increase the size of the data set.
NOTE: There were 1 observations read from the data set WORK.REPEAT_BLOCK_NUMERIC_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3210      + PROC SQL;
3210      +           DROP TABLE  NBS_RDB.DM_INV_AL_NIC;
NOTE: Table NBS_RDB.DM_INV_AL_NIC has been dropped.
3210      +                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3210      +                                                     PROC SQL;
3210      +                                                                CREATE TABLE DISCRETE_ALL 
AS SELECT * FROM INV_SUMM_DATAMART  LEFT JOIN INVESTIGATION_DATA ON 
INVESTIGATION_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN PATIENT_DATA
3211      + ON PATIENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
CASE_MANAGEMENT_DATA ON CASE_MANAGEMENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_ADMINISTRATIVE ON D_INV_ADMINISTRATIVE.INVESTIGATION_KEY
3212      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_CLINICAL ON 
D_INV_CLINICAL.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_COMPLICATION ON 
D_INV_COMPLICATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
3213      + D_INV_CONTACT ON D_INV_CONTACT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_DEATH ON D_INV_DEATH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_EPIDEMIOLOGY ON D_INV_EPIDEMIOLOGY.INVESTIGATION_KEY
3214      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_HIV ON D_INV_HIV.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PATIENT_OBS ON 
D_INV_PATIENT_OBS.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
3215      + D_INV_ISOLATE_TRACKING ON D_INV_ISOLATE_TRACKING.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_LAB_FINDING ON 
D_INV_LAB_FINDING.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY  LEFT JOIN 
D_INV_MEDICAL_HISTORY ON
3216      + D_INV_MEDICAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_MOTHER ON D_INV_MOTHER.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_OTHER ON D_INV_OTHER.INVESTIGATION_KEY
3217      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PREGNANCY_BIRTH ON 
D_INV_PREGNANCY_BIRTH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_RESIDENCY ON D_INV_RESIDENCY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT
3218      + JOIN D_INV_RISK_FACTOR ON D_INV_RISK_FACTOR.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SOCIAL_HISTORY ON 
D_INV_SOCIAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SYMPTOM ON
3219      + D_INV_SYMPTOM.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY   LEFT JOIN 
D_INV_TREATMENT ON D_INV_TREATMENT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_TRAVEL ON D_INV_TRAVEL.INVESTIGATION_KEY
3220      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_UNDER_CONDITION ON 
D_INV_UNDER_CONDITION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_VACCINATION ON D_INV_VACCINATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
3221      + LEFT JOIN D_INV_STD ON D_INV_STD.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN ORGANIZATION ON ORGANIZATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT 
760                                         The SAS System             22:41 Saturday, January 6, 2024

JOIN PROVIDER ON PROVIDER.INVESTIGATION_KEY
3222      + =INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable PATIENT_LOCAL_ID already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
NOTE: Compressing data set WORK.DISCRETE_ALL decreased size by 98.52 percent. 
      Compressed is 21 pages; un-compressed would require 1419 pages.
NOTE: Table WORK.DISCRETE_ALL created, with 1419 rows and 155 columns.

3222      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.86 seconds
      cpu time            0.85 seconds
      
761                                         The SAS System             22:41 Saturday, January 6, 2024


3222      +                                              PROC SQL;
3222      +                                                        CREATE TABLE REPEAT_ALL AS SELECT 
* FROM  INVESTIGATION_REPEAT_VARCHAR LEFT JOIN REPEAT_BLOCK_VARCHAR_ALL ON 
REPEAT_BLOCK_VARCHAR_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY
3223      + LEFT JOIN INVESTIGATION_REPEAT_NUMERIC ON INVESTIGATION_REPEAT_NUMERIC.INVESTIGATION_KEY 
=INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN INVESTIGATION_REPEAT_DATE ON 
INVESTIGATION_REPEAT_DATE.INVESTIGATION_KEY
3224      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN REPEAT_BLOCK_DATE_ALL ON 
REPEAT_BLOCK_DATE_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN 
REPEAT_BLOCK_NUMERIC_ALL ON REPEAT_BLOCK_NUMERIC_ALL.INVESTIGATION_KEY
3225      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 98.34 percent. 
      Compressed is 21 pages; un-compressed would require 1267 pages.
NOTE: Table WORK.REPEAT_ALL created, with 1267 rows and 5 columns.

3225      +                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.06 seconds
      cpu time            0.07 seconds
      

3225      +                                                         PROC SQL;
3225      +                                                                   CREATE TABLE 
DM_INV_AL_NIC AS SELECT * FROM  DISCRETE_ALL LEFT OUTER JOIN REPEAT_ALL ON  
DISCRETE_ALL.INVESTIGATION_KEY = REPEAT_ALL.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DM_INV_AL_NIC.
NOTE: Compressing data set WORK.DM_INV_AL_NIC decreased size by 98.52 percent. 
      Compressed is 21 pages; un-compressed would require 1419 pages.
NOTE: Table WORK.DM_INV_AL_NIC created, with 1419 rows and 159 columns.

3225      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      

3225      +
Proc Append Force
3226      + base=nbs_rdb.DM_INV_AL_NIC data=DM_INV_AL_NIC;  Run;

NOTE: Appending WORK.DM_INV_AL_NIC to NBS_RDB.DM_INV_AL_NIC.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
WARNING: Engine ODBC does not support SORTEDBY operations.  SORTEDBY information cannot be copied.
NOTE: There were 1419 observations read from the data set WORK.DM_INV_AL_NIC.
NOTE: The data set NBS_RDB.DM_INV_AL_NIC has 1419 observations and 159 variables.
NOTE: PROCEDURE APPEND used (Total process time):
762                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           1.07 seconds
      cpu time            0.09 seconds
      
3226      +                                                       Quit;;

3226      +                                                               PROC SQL;
3226      +                                                                         DROP TABLE 
DISCRETE_ALL;
NOTE: Table WORK.DISCRETE_ALL has been dropped.
3226      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3226      +
PROC SQL;  
3226      +
 DROP TABLE REPEAT_ALL;
NOTE: Table WORK.REPEAT_ALL has been dropped.
3226      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3226      +
PROC SQL;  
3226      +
 DROP TABLE DM_INV_AL_NIC;
NOTE: Table WORK.DM_INV_AL_NIC has been dropped.
3226      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3227      + PROC SQL;
3227      +             DROP TABLE NBS_RDB.SUMM_DATAMART;
NOTE: Table NBS_RDB.SUMM_DATAMART has been dropped.
3227      +                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3227      +                                                     PROC SQL;
3227      +                                                                  CREATE TABLE 
NBS_RDB.SUMM_DATAMART AS SELECT PATIENT_KEY AS PATIENT_KEY, INVESTIGATION_KEY, DISEASE_GRP_CD      
FROM NBS_RDB.INV_SUMM_DATAMART        INNER JOIN NBS_RDB.CONDITION ON
3228      + INV_SUMM_DATAMART.DISEASE_CD = CONDITION.CONDITION_CD      WHERE CONDITION.DISEASE_GRP_CD 
763                                         The SAS System             22:41 Saturday, January 6, 2024

= (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
NOTE: Table NBS_RDB.SUMM_DATAMART created, with 55 rows and 3 columns.

3228      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.73 seconds
      cpu time            0.03 seconds
      

3228      +
PROC SQL;  
3228      +
  CREATE TABLE INV_METADATA AS SELECT  DISTINCT INIT.FORM_CD,
3229      + INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM FROM NBS_RDB.INIT INNER JOIN 
NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD INNER JOIN
3230      + NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='INVESTIGATION'  AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI') AND
3231      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.INV_METADATA created, with 46 rows and 5 columns.

3231      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

3231      +
DATA INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET INV_METADATA;    SORT_KEY+1;
3232      + OUTPUT;       RUN;

NOTE: There were 46 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INV_METADATA has 47 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3232      +                      PROC SORT DATA=INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 47 observations read from the data set WORK.INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INV_METADATA has 46 observations and 6 variables.
NOTE: Compressing data set WORK.INV_METADATA decreased size by 0.00 percent. 
764                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3232      +                                                                            ;
3232      +                                                                              DATA 
INVLISTING;   SET INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   USER_DEFINED_COLUMN_NAME = TRIM
3233      +(RDB_COLUMN_NM) || ' AS ' ||TRIM(USER_DEFINED_COLUMN_NM)|| 
"'"||TRIM(USER_DEFINED_COLUMN_NM)||"'";   RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || 
RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 46 observations read from the data set WORK.INV_METADATA.
NOTE: The data set WORK.INVLISTING has 46 observations and 8 variables.
NOTE: Compressing data set WORK.INVLISTING decreased size by 84.78 percent. 
      Compressed is 7 pages; un-compressed would require 46 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3233      +
PROC SQL;  
3233      +
  DELETE FROM INVLISTING WHERE SORT_KEY <
3234      +(SELECT MAX (SORT_KEY) FROM INVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 45 rows were deleted from WORK.INVLISTING.

3234      +                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3234      +                                               DATA INVLISTING; SET INVLISTING;    CALL 
SYMPUTX('INV_SEL2', '');  LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  
TRIMMED_VALUE=SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1);   CALL SYMPUTX('INV_SEL2', TRIMMED_VALUE);
3235      + RUN;

NOTE: There were 1 observations read from the data set WORK.INVLISTING.
NOTE: The data set WORK.INVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.INVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3235      +       PROC SQL;
3235      +                   CREATE TABLE INVESTIGATION_DATA AS   SELECT  &INV_SEL2, 
765                                         The SAS System             22:41 Saturday, January 6, 2024

SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.INVESTIGATION  INNER JOIN NBS_RDB.SUMM_DATAMART ON  
SUMM_DATAMART.INVESTIGATION_KEY  =INVESTIGATION.INVESTIGATION_KEY WHERE
3236      + SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.INVESTIGATION_DATA decreased size by 89.66 percent. 
      Compressed is 3 pages; un-compressed would require 29 pages.
NOTE: Table WORK.INVESTIGATION_DATA created, with 55 rows and 47 columns.

3236      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.00 seconds
      

3236      +
PROC SQL;  
3236      +
   CREATE TABLE CASE_MANAGEMENT_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3237      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM NBS_RDB.INIT 
INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  INNER 
JOIN NBS_ODS.NBS_RDB_METADATA  ON
3238      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_CASE_MANAGEMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3239      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL  ORDER BY INIT.FORM_CD,  NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.CASE_MANAGEMENT_METADATA created, with 0 rows and 5 columns.

3239      +
   INSERT INTO CASE_MANAGEMENT_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3240      + DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_CASE_MANAGEMENT';
NOTE: 1 row was inserted into WORK.CASE_MANAGEMENT_METADATA.

3240      +                                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

3240      +                                                                    PROC SQL;
3240      +                                                                              CREATE TABLE 
INV_SUMM_DATAMART AS SELECT INV_SUMM_DATAMART.PROGRAM_JURISDICTION_OID,  
INV_SUMM_DATAMART.INVESTIGATION_KEY,  INV_SUMM_DATAMART.PATIENT_KEY,
3241      + INV_SUMM_DATAMART.PATIENT_LOCAL_ID,  INV_SUMM_DATAMART.INVESTIGATION_CREATE_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_CREATED_BY,  INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_DATE,  
INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,
3242      + INV_SUMM_DATAMART.EVENT_DATE,  INV_SUMM_DATAMART.EVENT_DATE_TYPE,  
INV_SUMM_DATAMART.LABORATORY_INFORMATION,  INV_SUMM_DATAMART.EARLIEST_SPECIMEN_COLLECT_DATE,  
INV_SUMM_DATAMART.NOTIFICATION_STATUS,  INV_SUMM_DATAMART.CONFIRMATION_METHOD,
3243      + INV_SUMM_DATAMART.CONFIRMATION_DT,   INV_SUMM_DATAMART.DISEASE_CD,  
INV_SUMM_DATAMART.DISEASE,  INV_SUMM_DATAMART.NOTIFICATION_LAST_UPDATED_DATE,   
INV_SUMM_DATAMART.NOTIFICATION_LOCAL_ID,  INV_SUMM_DATAMART.PROGRAM_AREA,
766                                         The SAS System             22:41 Saturday, January 6, 2024

3244      + INV_SUMM_DATAMART.INVESTIGATION_LAST_UPDTD_BY,  INV_SUMM_DATAMART.PATIENT_COUNTY_CODE,  
INV_SUMM_DATAMART.JURISDICTION_NM  FROM NBS_RDB.INV_SUMM_DATAMART  INNER JOIN INVESTIGATION_DATA ON  
INVESTIGATION_DATA.INVESTIGATION_KEY =
3245      + INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_LAST_UPDTD_BY already exists on file WORK.INV_SUMM_DATAMART.
NOTE: Compressing data set WORK.INV_SUMM_DATAMART decreased size by 94.55 percent. 
      Compressed is 3 pages; un-compressed would require 55 pages.
NOTE: Table WORK.INV_SUMM_DATAMART created, with 55 rows and 22 columns.

3245      +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           29.46 seconds
      cpu time            10.46 seconds
      

3245      +                                              PROC SQL;
3245      +                                                         CREATE TABLE PAT_METADATA AS   
SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM  FROM
3246      + NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA ON NBS_UI_METADATA.INVESTIGATION_FORM_CD 
= INIT.FORM_CD INNER JOIN NBS_ODS.NBS_RDB_METADATA ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID WHERE RDB_TABLE_NM='D_PATIENT'  AND
3247      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI') AND RDB_COLUMN_NM NOT IN ('PATIENT_WORK_STREET_ADDRESS_1', 
'PATIENT_WORK_STREET_ADDRESS_2') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3248      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PAT_METADATA created, with 35 rows and 5 columns.

3248      +
  QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.06 seconds
      

3248      +
DATA PAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PAT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 35 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.PAT_METADATA has 36 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3248      +
PROC SORT DATA=PAT_METADATA
3249      + NODUPKEY; BY SORT_KEY;RUN;

767                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 36 observations read from the data set WORK.PAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PAT_METADATA has 35 observations and 6 variables.
NOTE: Compressing data set WORK.PAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3249      +                           ;
3249      +                             DATA LISTING;   SET PAT_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY THEN   
USER_DEFINED_COLUMN_NAME = ' AS ' ||USER_DEFINED_COLUMN_NM||
3250      + "'"||USER_DEFINED_COLUMN_NM||"'";   RDB_COLUMN_NAME_LIST = (TRIM(RDB_COLUMN_NM) || 
USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);     OUTPUT; RUN;

NOTE: There were 35 observations read from the data set WORK.PAT_METADATA.
NOTE: The data set WORK.LISTING has 35 observations and 8 variables.
NOTE: Compressing data set WORK.LISTING decreased size by 85.71 percent. 
      Compressed is 5 pages; un-compressed would require 35 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3250      +
PROC SQL;  
3250      +
  DELETE FROM LISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM LISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 34 rows were deleted from WORK.LISTING.

3250      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3250      +
 DATA      
3251      + LISTING; SET LISTING;   CALL SYMPUTX('PAT_SEL', '');  
LENGTH=LENGTHN(RDB_COLUMN_NAME_LIST);  TRIMMED_VALUE=TRIM(SUBSTR(RDB_COLUMN_NAME_LIST, 1, LENGTH-1)); 
  CALL SYMPUTX('PAT_SEL', TRIMMED_VALUE); RUN;

NOTE: There were 1 observations read from the data set WORK.LISTING.
NOTE: The data set WORK.LISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.LISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
768                                         The SAS System             22:41 Saturday, January 6, 2024

      

3251      +
PROC SQL;  
3251      +
  CREATE TABLE PATIENT_DATA AS   SELECT
3252      + &PAT_SEL,SUMM_DATAMART.INVESTIGATION_KEY  FROM NBS_RDB.D_PATIENT INNER JOIN 
NBS_RDB.SUMM_DATAMART ON  D_PATIENT.PATIENT_KEY = SUMM_DATAMART.PATIENT_KEY; QUIT;
NOTE: Compressing data set WORK.PATIENT_DATA decreased size by 94.55 percent. 
      Compressed is 3 pages; un-compressed would require 55 pages.
NOTE: Table WORK.PATIENT_DATA created, with 55 rows and 36 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

3253      + DATA CASE_MANAGEMENT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET 
CASE_MANAGEMENT_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3253      +
PROC SORT DATA=CASE_MANAGEMENT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.CASE_MANAGEMENT_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.CASE_MANAGEMENT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3253      +
;          
3253      +
DATA CMLISTING;   SET CASE_MANAGEMENT_METADATA;   BY
3254      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) 
|| ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3255      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.CASE_MANAGEMENT_METADATA.
NOTE: The data set WORK.CMLISTING has 1 observations and 8 variables.
769                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3255      +
PROC SQL;  
3255      +
  DELETE FROM CMLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3256      + CMLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.CMLISTING.

3256      +             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3256      +                     DATA CMLISTING; SET CMLISTING;   CALL SYMPUTX('CM_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1,
3257      + LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= 
'D_CASE_MANAGEMENT.INVESTIGATION_KEY AS INVESTIGATION_KEY';  CALL SYMPUTX('CM_CASE', TRIMMED_VALUE);  
RUN;

NOTE: There were 1 observations read from the data set WORK.CMLISTING.
NOTE: The data set WORK.CMLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.CMLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3257      +
PROC SQL;  
3257      +
  CREATE TABLE CASE_MANAGEMENT_DATA AS   SELECT  &CM_CASE ,
3258      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  LEFT JOIN  
NBS_RDB.D_CASE_MANAGEMENT ON  SUMM_DATAMART.INVESTIGATION_KEY  =D_CASE_MANAGEMENT.INVESTIGATION_KEY 
WHERE SUMM_DATAMART.DISEASE_GRP_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3259      + DATAMART_NM='TB_LTBI')  AND D_CASE_MANAGEMENT.INVESTIGATION_KEY>1;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.CASE_MANAGEMENT_DATA.
NOTE: Compression was disabled for data set WORK.CASE_MANAGEMENT_DATA because compression overhead 
      would increase the size of the data set.
NOTE: Table WORK.CASE_MANAGEMENT_DATA created, with 0 rows and 1 columns.

3259      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
770                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

3260      + PROC SQL;
3260      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3260      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3260      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3260      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3260      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3261      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3261      +
PROC SQL;  
3261      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3262      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3263      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3264      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 24 rows and 5 columns.

3264      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
771                                         The SAS System             22:41 Saturday, January 6, 2024

3265      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_ADMINISTRATIVE'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3265      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.07 seconds
      

3265      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 25 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 26 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3265      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3266      + SORT_KEY;RUN;

NOTE: There were 26 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 25 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3266      +              ;
3266      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3267      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 25 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 25 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 88.00 percent. 
      Compressed is 3 pages; un-compressed would require 25 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
772                                         The SAS System             22:41 Saturday, January 6, 2024


3267      +
PROC SQL;  
3268      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 24 rows were deleted from WORK.DYNINVLISTING.

3268      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3268      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3269      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3270      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3269:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3270      +                                                         PROC SQL;
3270      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
3271      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3272      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3273      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3273      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
773                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.03 seconds
      

3273      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3274      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3274      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3274      +
;          
3274      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3275      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3276      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3276      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3277      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3278      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
774                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3278      +               PROC SQL;
3278      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3278      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3278      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3278      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3279      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
3280      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3280:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3280      +
PROC SQL;  
3280      +
  CREATE TABLE
3281      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
775                                         The SAS System             22:41 Saturday, January 6, 2024

3282      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ADMINISTRATIVE'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
3283      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
3284      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3284      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

3284      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3285      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3285      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3285      +                                                                           ;
3285      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3286      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3287      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
776                                         The SAS System             22:41 Saturday, January 6, 2024

      

3287      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3288      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3288      +
PROC SQL;  
3289      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3289      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3289      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3289      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
3290      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3291      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3291:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
777                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3291      +
PROC SQL;  
3291      +
  CREATE TABLE
3292      + D_INV_ADMINISTRATIVE AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
3293      + NBS_RDB. D_INV_ADMINISTRATIVE ON  &FACT_CASE .D_INV_ADMINISTRATIVE_KEY  
=D_INV_ADMINISTRATIVE .D_INV_ADMINISTRATIVE_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_ADMINISTRATIVE created, with 55 rows and 25 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.01 seconds
      

3294      + D_INV_ADMINISTRATIVE; SET D_INV_ADMINISTRATIVE;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_ADMINISTRATIVE.
NOTE: The data set WORK.D_INV_ADMINISTRATIVE has 55 observations and 25 variables.
NOTE: Compressing data set WORK.D_INV_ADMINISTRATIVE decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3295      + PROC SQL;
3295      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3295      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3295      +
778                                         The SAS System             22:41 Saturday, January 6, 2024

  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3295      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3295      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3296      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3296      +
PROC SQL;  
3296      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3297      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3298      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CLINICAL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3299      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 14 rows and 5 columns.

3299      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3300      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_CLINICAL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3300      +                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.25 seconds
      cpu time            0.04 seconds
      

3300      +                                                                        DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 15 observations read from the data set WORK.D_INV_METADATA.
779                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA has 16 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3300      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 16 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 15 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3300      +
;  DATA    
3301      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3302      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 15 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 15 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 86.67 percent. 
      Compressed is 2 pages; un-compressed would require 15 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3302      +
PROC SQL;  
3302      +
  DELETE FROM
3303      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 14 rows were deleted from WORK.DYNINVLISTING.

3303      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

780                                         The SAS System             22:41 Saturday, January 6, 2024

3303      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3304      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3305      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3304:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3305      +                                   PROC SQL;
3305      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3306      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3307      + RDB_TABLE_NM='D_INV_CLINICAL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
3308      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 1 rows and 5 columns.

3308      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

3308      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
781                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

3308      +
PROC SORT  
3309      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3309      +                                                   ;
3309      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3310      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3310      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3311      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3312      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3312      +
782                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
3312      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3313      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3313      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3313      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3313      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3314      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3315      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3315:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3315      +
PROC SQL;  
3315      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3316      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3317      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CLINICAL'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
783                                         The SAS System             22:41 Saturday, January 6, 2024

3318      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3319      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3319      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3319      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3319      +
PROC SORT DATA=D_INV_METADATA_UNIT
3320      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3320      +                           ;
3320      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3321      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3321      +
784                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT; SET
3322      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3323      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3323      +
PROC SQL;  
3323      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3324      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3324      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3324      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3324      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3325      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3326      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3326:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
785                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3326      +
PROC SQL;  
3326      +
  CREATE TABLE D_INV_CLINICAL AS   SELECT
3327      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CLINICAL ON
3328      + &FACT_CASE .D_INV_CLINICAL_KEY  =D_INV_CLINICAL .D_INV_CLINICAL_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_CLINICAL; SET D_INV_CLINICAL;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_CLINICAL created, with 55 rows and 16 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.39 seconds
      cpu time            0.03 seconds
      

3329      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_CLINICAL.
NOTE: The data set WORK.D_INV_CLINICAL has 55 observations and 16 variables.
NOTE: Compressing data set WORK.D_INV_CLINICAL decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3330      + PROC SQL;
3330      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3330      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3330      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
786                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was updated in WORK.STD_TESTER.

3330      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3330      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3331      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3331      +
PROC SQL;  
3331      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3332      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3333      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_COMPLICATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3334      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3334      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3335      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_COMPLICATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3335      +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

3335      +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
787                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3335      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3335      +
;  DATA    
3336      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3337      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3337      +
PROC SQL;  
3337      +
  DELETE FROM
3338      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3338      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3338      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
788                                         The SAS System             22:41 Saturday, January 6, 2024

3339      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3340      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3339:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3340      +                                   PROC SQL;
3340      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3341      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3342      + RDB_TABLE_NM='D_INV_COMPLICATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
3343      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3343      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

3343      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3343      +
PROC SORT  
3344      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

789                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3344      +                                                   ;
3344      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3345      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3345      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3346      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3347      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3347      +
PROC SQL;  
3347      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3348      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3348      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
790                                         The SAS System             22:41 Saturday, January 6, 2024


3348      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3348      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3349      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3350      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3350:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3350      +
PROC SQL;  
3350      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3351      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3352      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_COMPLICATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3353      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3354      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3354      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

3354      +
791                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3354      +
PROC SORT DATA=D_INV_METADATA_UNIT
3355      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3355      +                           ;
3355      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3356      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3356      +
DATA D_INV_METADATA_UNIT; SET
3357      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3358      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

792                                         The SAS System             22:41 Saturday, January 6, 2024

3358      +
PROC SQL;
3358      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3359      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3359      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3359      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3359      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3360      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3361      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3361:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3361      +
PROC SQL;  
3361      +
  CREATE TABLE D_INV_COMPLICATION AS   SELECT
3362      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_COMPLICATION ON
3363      + &FACT_CASE .D_INV_COMPLICATION_KEY  =D_INV_COMPLICATION .D_INV_COMPLICATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_COMPLICATION; SET D_INV_COMPLICATION;  DROP
793                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_COMPLICATION created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.03 seconds
      

3364      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_COMPLICATION.
NOTE: The data set WORK.D_INV_COMPLICATION has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_COMPLICATION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3365      + PROC SQL;
3365      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3365      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3365      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3365      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3365      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3366      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
794                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3366      +
PROC SQL;  
3366      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3367      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3368      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_CONTACT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3369      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3369      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3370      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_CONTACT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3370      +                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

3370      +                                                                       DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3370      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
795                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3370      +
;  DATA    
3371      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3372      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3372      +
PROC SQL;  
3372      +
  DELETE FROM
3373      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3373      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3373      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3374      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3375      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3374:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
796                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3375      +                                   PROC SQL;
3375      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3376      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3377      + RDB_TABLE_NM='D_INV_CONTACT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
3378      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3378      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3378      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3378      +
PROC SORT  
3379      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3379      +                                                   ;
3379      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3380      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;
797                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3380      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3381      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3382      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3382      +
PROC SQL;  
3382      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3383      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3383      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3383      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3383      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3384      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
798                                         The SAS System             22:41 Saturday, January 6, 2024

3385      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3385:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3385      +
PROC SQL;  
3385      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3386      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3387      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_CONTACT'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3388      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3389      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3389      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.07 seconds
      

3389      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3389      +
PROC SORT DATA=D_INV_METADATA_UNIT
3390      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
799                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3390      +                           ;
3390      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3391      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3391      +
DATA D_INV_METADATA_UNIT; SET
3392      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3393      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3393      +
PROC SQL;  
3393      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3394      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3394      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

800                                         The SAS System             22:41 Saturday, January 6, 2024

3394      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3394      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3395      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3396      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3396:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3396      +
PROC SQL;  
3396      +
  CREATE TABLE D_INV_CONTACT AS   SELECT
3397      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_CONTACT ON
3398      + &FACT_CASE .D_INV_CONTACT_KEY  =D_INV_CONTACT .D_INV_CONTACT_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_CONTACT; SET D_INV_CONTACT;  DROP _TEMA001 _TEMA002 _TEMA003
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_CONTACT created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.00 seconds
      

3399      + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
801                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_CONTACT.
NOTE: The data set WORK.D_INV_CONTACT has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_CONTACT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3400      + PROC SQL;
3400      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3400      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3400      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3400      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3400      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3401      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3401      +
PROC SQL;  
3401      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3402      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3403      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_DEATH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
802                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3404      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3404      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3405      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_DEATH'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3405      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.20 seconds
      cpu time            0.06 seconds
      

3405      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3405      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3405      +
;          
3405      +
DATA DYNINVLISTING
3406      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3407      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
803                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3407      +
PROC SQL;  
3407      +
  DELETE FROM
3408      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3408      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3408      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3409      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3410      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3409:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3410      +                                   PROC SQL;
3410      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3411      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3412      + RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
804                                         The SAS System             22:41 Saturday, January 6, 2024

3413      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3413      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3413      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3413      +
PROC SORT DATA=D_INV_METADATA_OTH
3414      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3414      +                           ;
3414      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
3415      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3415      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
3416      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
805                                         The SAS System             22:41 Saturday, January 6, 2024

3417      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3417      +
PROC SQL;  
3417      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3418      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3418      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3418      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3418      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3419      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3420      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3419:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3420      +
PROC SQL;  
806                                         The SAS System             22:41 Saturday, January 6, 2024

3420      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
3421      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
3422      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_DEATH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3423      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
3424      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3424      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3424      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3424      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3424      +
;   DATA   
3425      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
3426      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
807                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3426      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
3427      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3428      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3428      +
PROC SQL;  
3428      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3429      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3429      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3429      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3429      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3430      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3431      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3430:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
808                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3431      +
PROC SQL;  
3431      +
  CREATE TABLE D_INV_DEATH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
3432      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_DEATH ON  &FACT_CASE .D_INV_DEATH_KEY  =D_INV_DEATH
3433      + .D_INV_DEATH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_DEATH created, with 55 rows and 2 columns.

3433      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

3433      +
;          
3433      +
DATA D_INV_DEATH; SET D_INV_DEATH;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_DEATH.
NOTE: The data set WORK.D_INV_DEATH has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_DEATH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3435      + PROC SQL;
3435      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
809                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3435      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3435      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3435      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3435      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3436      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3436      +
PROC SQL;  
3436      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3437      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3438      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3439      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 10 rows and 5 columns.

3439      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3440      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3440      +                                                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
810                                         The SAS System             22:41 Saturday, January 6, 2024

      

3440      +                                                                            DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 12 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3440      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 12 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 11 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3440      +
;  DATA    
3441      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3442      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 11 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 81.82 percent. 
      Compressed is 2 pages; un-compressed would require 11 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3442      +
PROC SQL;  
3442      +
  DELETE FROM
3443      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 10 rows were deleted from WORK.DYNINVLISTING.

811                                         The SAS System             22:41 Saturday, January 6, 2024

3443      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3443      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3444      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3445      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3444:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3445      +                                   PROC SQL;
3445      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3446      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3447      + RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
3448      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 2 rows and 5 columns.

3448      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

3448      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

812                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3448      +
PROC SORT  
3449      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3449      +                                                   ;
3449      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3450      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3450      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3451      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3452      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
813                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3452      +
PROC SQL;  
3452      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3453      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING_OTH.

3453      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3453      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3453      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3454      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3455      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3455:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3455      +
PROC SQL;  
3455      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
814                                         The SAS System             22:41 Saturday, January 6, 2024

3456      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3457      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_EPIDEMIOLOGY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3458      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3459      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3459      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

3459      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3459      +
PROC SORT DATA=D_INV_METADATA_UNIT
3460      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3460      +                           ;
3460      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3461      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
815                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3461      +
DATA D_INV_METADATA_UNIT; SET
3462      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3463      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3463      +
PROC SQL;  
3463      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3464      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3464      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3464      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3464      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3465      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3466      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

816                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3466:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3466      +
PROC SQL;  
3466      +
  CREATE TABLE D_INV_EPIDEMIOLOGY AS   SELECT
3467      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_EPIDEMIOLOGY ON
3468      + &FACT_CASE .D_INV_EPIDEMIOLOGY_KEY  =D_INV_EPIDEMIOLOGY .D_INV_EPIDEMIOLOGY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_EPIDEMIOLOGY; SET D_INV_EPIDEMIOLOGY;  DROP
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_EPIDEMIOLOGY created, with 55 rows and 13 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.45 seconds
      cpu time            0.03 seconds
      

3469      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_EPIDEMIOLOGY.
NOTE: The data set WORK.D_INV_EPIDEMIOLOGY has 55 observations and 13 variables.
NOTE: Compressing data set WORK.D_INV_EPIDEMIOLOGY decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3470      + PROC SQL;
3470      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
817                                         The SAS System             22:41 Saturday, January 6, 2024

3470      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3470      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3470      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3470      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3471      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3471      +
PROC SQL;  
3471      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3472      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3473      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_HIV'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL
3474      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3474      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3475      + DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_HIV'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3475      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

3475      +                                                             DATA D_INV_METADATA;   IF 
818                                         The SAS System             22:41 Saturday, January 6, 2024

SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3475      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3475      +
;          
3475      +
DATA DYNINVLISTING;   SET
3476      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
3477      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3477      +
PROC SQL;  
3477      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
3478      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3478      +                                            QUIT;
819                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3478      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
3479      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3479:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3480      + PROC SQL;
3480      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
3481      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_HIV'    AND
3482      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3483      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3483      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3483      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
820                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

3483      +
PROC SORT DATA=D_INV_METADATA_OTH
3484      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3484      +                           ;
3484      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
3485      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3485      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
3486      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3487      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3487      +
PROC SQL;  
3487      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3488      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.
821                                         The SAS System             22:41 Saturday, January 6, 2024


3488      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3488      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3488      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3489      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3490      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3489:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3490      +
PROC SQL;  
3490      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
3491      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
3492      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_HIV'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3493      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
3494      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3494      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
822                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

3494      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3494      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3494      +
;          
3494      +
DATA D_INV_METADATA_UNIT; LENGTH
3495      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
3496      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3496      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
3497      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
3498      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
823                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3498      +
PROC SQL;  
3498      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3499      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3499      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3499      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3500      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
3501      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3500:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3501      +
PROC SQL;  
3501      +
  CREATE TABLE D_INV_HIV AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
3502      + NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_HIV ON  
&FACT_CASE .D_INV_HIV_KEY  =D_INV_HIV .D_INV_HIV_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD =
3503      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.D_INV_HIV increased size by 100.00 percent. 
824                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_HIV created, with 55 rows and 2 columns.

3503      +                                                                    ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.01 seconds
      

3503      +                                                                          ;
3503      +                                                                               DATA 
D_INV_HIV; SET D_INV_HIV;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 
_TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_HIV.
NOTE: The data set WORK.D_INV_HIV has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_HIV increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3504      + PROC SQL;
3504      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3504      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3504      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3504      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3504      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3505      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
825                                         The SAS System             22:41 Saturday, January 6, 2024

'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3505      +
PROC SQL;  
3505      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3506      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3507      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PATIENT_OBS'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3508      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

3508      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3509      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_PATIENT_OBS'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3509      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

3509      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3509      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
826                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3509      +
;  DATA    
3510      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3511      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3511      +
PROC SQL;  
3511      +
  DELETE FROM
3512      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

3512      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3512      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3513      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3514      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3513:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
827                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3514      +                                   PROC SQL;
3514      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3515      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3516      + RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
3517      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3517      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

3517      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3517      +
PROC SORT  
3518      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3518      +                                                   ;
3518      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
828                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3519      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3519      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3520      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3521      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3521      +
PROC SQL;  
3521      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3522      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3522      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3522      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3522      +
829                                         The SAS System             22:41 Saturday, January 6, 2024

DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3523      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3524      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3524:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3524      +
PROC SQL;  
3524      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3525      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3526      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_PATIENT_OBS'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3527      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3528      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3528      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

3528      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

830                                         The SAS System             22:41 Saturday, January 6, 2024

3528      +
PROC SORT DATA=D_INV_METADATA_UNIT
3529      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3529      +                           ;
3529      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3530      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3530      +
DATA D_INV_METADATA_UNIT; SET
3531      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3532      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3532      +
PROC SQL;  
3532      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3533      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3533      +                                                             QUIT;
831                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3533      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3533      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3534      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3535      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3535:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3535      +
PROC SQL;  
3535      +
  CREATE TABLE D_INV_PATIENT_OBS AS   SELECT
3536      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_PATIENT_OBS ON
3537      + &FACT_CASE .D_INV_PATIENT_OBS_KEY  =D_INV_PATIENT_OBS .D_INV_PATIENT_OBS_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_PATIENT_OBS; SET D_INV_PATIENT_OBS;  DROP
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: Table WORK.D_INV_PATIENT_OBS created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.39 seconds
      cpu time            0.03 seconds
      

3538      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;
832                                         The SAS System             22:41 Saturday, January 6, 2024


WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_PATIENT_OBS.
NOTE: The data set WORK.D_INV_PATIENT_OBS has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PATIENT_OBS decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3539      + PROC SQL;
3539      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3539      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3539      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3539      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3539      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3540      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3540      +
PROC SQL;  
3540      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
833                                         The SAS System             22:41 Saturday, January 6, 2024

3541      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3542      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3543      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3543      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
3544      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_ISOLATE_TRACKING 
'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3544      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

3544      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3544      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3545      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3545      +              ;
3545      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
834                                         The SAS System             22:41 Saturday, January 6, 2024

MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3546      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3546      +
PROC SQL;  
3547      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3547      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3547      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3548      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3549      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3548:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3549      +                                                         PROC SQL;
3549      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
3550      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
835                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3551      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3552      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3552      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

3552      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3553      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3553      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3553      +
;          
3553      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3554      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3555      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
836                                         The SAS System             22:41 Saturday, January 6, 2024

      

3555      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3556      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3557      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3557      +               PROC SQL;
3557      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3557      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3557      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3557      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3558      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
3559      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3559:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
837                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3559      +
PROC SQL;  
3559      +
  CREATE TABLE
3560      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3561      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_ISOLATE_TRACKING '    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=
3562      +(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND 
QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL 
AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND
3563      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3563      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3563      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3564      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3564      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3564      +                                                                           ;
3564      +                                                                               DATA 
838                                         The SAS System             22:41 Saturday, January 6, 2024

D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3565      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3566      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3566      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3567      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3567      +
PROC SQL;  
3568      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3568      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3568      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3568      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
839                                         The SAS System             22:41 Saturday, January 6, 2024

3569      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3570      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3570:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3570      +
PROC SQL;  
3570      +
  CREATE TABLE
3571      + D_INV_ISOLATE_TRACKING AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER
3572      + JOIN  NBS_RDB. D_INV_ISOLATE_TRACKING ON  &FACT_CASE .D_INV_ISOLATE_TRACKING_KEY  
=D_INV_ISOLATE_TRACKING .D_INV_ISOLATE_TRACKING_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_ISOLATE_TRACKING created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.03 seconds
      

3573      + DATA D_INV_ISOLATE_TRACKING; SET D_INV_ISOLATE_TRACKING;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_ISOLATE_TRACKING.
NOTE: The data set WORK.D_INV_ISOLATE_TRACKING has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_ISOLATE_TRACKING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
840                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3574      + PROC SQL;
3574      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3574      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3574      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3574      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3574      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3575      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3575      +
PROC SQL;  
3575      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3576      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3577      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_LAB_FINDING'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3578      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 38 rows and 5 columns.

3578      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
841                                         The SAS System             22:41 Saturday, January 6, 2024

3579      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_LAB_FINDING'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3579      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.03 seconds
      

3579      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 39 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 40 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3579      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 40 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 39 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3579      +
;  DATA    
3580      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3581      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 39 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 39 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 87.18 percent. 
      Compressed is 5 pages; un-compressed would require 39 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3581      +
PROC SQL;  
842                                         The SAS System             22:41 Saturday, January 6, 2024

3581      +
  DELETE FROM
3582      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 38 rows were deleted from WORK.DYNINVLISTING.

3582      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3582      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3583      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3584      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3583:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3584      +                                   PROC SQL;
3584      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3585      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3586      + RDB_TABLE_NM='D_INV_LAB_FINDING'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
3587      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 4 rows and 5 columns.

3587      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
843                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.06 seconds
      

3587      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 5 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3587      +
PROC SORT  
3588      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 4 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3588      +                                                   ;
3588      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3589      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 4 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3589      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3590      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3591      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
844                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 4 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 4 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3591      +
PROC SQL;  
3591      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3592      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 3 rows were deleted from WORK.DYNINVLISTING_OTH.

3592      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3592      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3592      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3593      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3594      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3594:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
845                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3594      +
PROC SQL;  
3594      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3595      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3596      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_LAB_FINDING'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3597      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3598      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3598      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3598      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3598      +
PROC SORT DATA=D_INV_METADATA_UNIT
3599      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3599      +                           ;
3599      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
846                                         The SAS System             22:41 Saturday, January 6, 2024

3600      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3600      +
DATA D_INV_METADATA_UNIT; SET
3601      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3602      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3602      +
PROC SQL;  
3602      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3603      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3603      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3603      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3603      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
847                                         The SAS System             22:41 Saturday, January 6, 2024

3604      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3605      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3605:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3605      +
PROC SQL;  
3605      +
  CREATE TABLE D_INV_LAB_FINDING AS   SELECT
3606      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_LAB_FINDING ON
3607      + &FACT_CASE .D_INV_LAB_FINDING_KEY  =D_INV_LAB_FINDING .D_INV_LAB_FINDING_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_LAB_FINDING; SET D_INV_LAB_FINDING;  DROP
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_LAB_FINDING created, with 55 rows and 43 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

3608      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_LAB_FINDING.
NOTE: The data set WORK.D_INV_LAB_FINDING has 55 observations and 43 variables.
NOTE: Compressing data set WORK.D_INV_LAB_FINDING decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
848                                         The SAS System             22:41 Saturday, January 6, 2024

      

3609      + PROC SQL;
3609      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3609      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3609      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3609      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3609      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3610      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3610      +
PROC SQL;  
3610      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3611      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3612      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3613      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 4 rows and 5 columns.

3613      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
3614      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_MEDICAL_HISTORY' 
849                                         The SAS System             22:41 Saturday, January 6, 2024

 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3614      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

3614      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 6 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3614      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3615      + SORT_KEY;RUN;

NOTE: There were 6 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 5 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3615      +              ;
3615      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3616      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 5 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 5 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 60.00 percent. 
      Compressed is 2 pages; un-compressed would require 5 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

850                                         The SAS System             22:41 Saturday, January 6, 2024

3616      +
PROC SQL;
3617      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 4 rows were deleted from WORK.DYNINVLISTING.

3617      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3617      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3618      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3619      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3618:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3619      +                                                         PROC SQL;
3619      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
3620      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3621      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3622      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3622      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
851                                         The SAS System             22:41 Saturday, January 6, 2024

      

3622      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3623      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3623      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3623      +
;          
3623      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3624      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3625      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3625      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3626      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3627      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
852                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3627      +               PROC SQL;
3627      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3627      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3627      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3627      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3628      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
3629      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3629:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3629      +
PROC SQL;  
3629      +
  CREATE TABLE
3630      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3631      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
853                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MEDICAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
3632      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
3633      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3633      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.06 seconds
      

3633      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3634      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3634      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3634      +                                                                           ;
3634      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3635      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3636      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
854                                         The SAS System             22:41 Saturday, January 6, 2024


3636      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3637      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3637      +
PROC SQL;  
3638      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3638      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3638      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3638      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
3639      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3640      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3640:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
855                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3640      +
PROC SQL;  
3640      +
  CREATE TABLE
3641      + D_INV_MEDICAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
3642      +  NBS_RDB. D_INV_MEDICAL_HISTORY ON  &FACT_CASE .D_INV_MEDICAL_HISTORY_KEY  
=D_INV_MEDICAL_HISTORY .D_INV_MEDICAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 92.86 percent. 
      Compressed is 2 pages; un-compressed would require 28 pages.
NOTE: Table WORK.D_INV_MEDICAL_HISTORY created, with 55 rows and 5 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

3643      + D_INV_MEDICAL_HISTORY; SET D_INV_MEDICAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_MEDICAL_HISTORY.
NOTE: The data set WORK.D_INV_MEDICAL_HISTORY has 55 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_MEDICAL_HISTORY decreased size by 92.86 percent. 
      Compressed is 2 pages; un-compressed would require 28 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3644      + PROC SQL;
3644      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3644      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3644      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
856                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was updated in WORK.STD_TESTER.

3644      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3644      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3645      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3645      +
PROC SQL;  
3645      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3646      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3647      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3648      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3648      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3649      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_MOTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3649      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.23 seconds
      cpu time            0.07 seconds
      

3649      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
857                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3649      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3649      +
;  DATA    
3650      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3651      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3651      +
PROC SQL;  
3651      +
  DELETE FROM
3652      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3652      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3652      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
858                                         The SAS System             22:41 Saturday, January 6, 2024

3653      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3654      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3653:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3654      +                                   PROC SQL;
3654      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3655      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3656      + RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
3657      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3657      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

3657      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3657      +
PROC SORT DATA=D_INV_METADATA_OTH
3658      + NODUPKEY; BY SORT_KEY;RUN;

859                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3658      +                           ;
3658      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
3659      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3659      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
3660      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3661      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3661      +
PROC SQL;  
3661      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3662      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3662      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3662      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;
860                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3662      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3663      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3664      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3663:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3664      +
PROC SQL;  
3664      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
3665      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
3666      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_MOTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3667      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
3668      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3668      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3668      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
861                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3668      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3668      +
;   DATA   
3669      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
3670      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3670      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
3671      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3672      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3672      +
PROC SQL;  
3672      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3673      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
862                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3673      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3673      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3673      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3674      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3675      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3674:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3675      +
PROC SQL;  
3675      +
  CREATE TABLE D_INV_MOTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
3676      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_MOTHER ON  &FACT_CASE .D_INV_MOTHER_KEY  =D_INV_MOTHER
3677      + .D_INV_MOTHER_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_MOTHER created, with 55 rows and 2 columns.

3677      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.04 seconds
      
863                                         The SAS System             22:41 Saturday, January 6, 2024


3677      +
;          
3677      +
DATA D_INV_MOTHER; SET D_INV_MOTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
3678      + RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_MOTHER.
NOTE: The data set WORK.D_INV_MOTHER has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_MOTHER increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3679      + PROC SQL;
3679      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3679      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3679      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3679      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3679      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3680      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
864                                         The SAS System             22:41 Saturday, January 6, 2024

      

3680      +
PROC SQL;  
3680      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3681      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3682      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_OTHER'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3683      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3683      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3684      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_OTHER'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3684      +                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

3684      +                                                                     DATA D_INV_METADATA;  
 IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3684      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

865                                         The SAS System             22:41 Saturday, January 6, 2024

3684      +
;
3684      +
DATA DYNINVLISTING
3685      +;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3686      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3686      +
PROC SQL;  
3686      +
  DELETE FROM
3687      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3687      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3687      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3688      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3689      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3688:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
866                                         The SAS System             22:41 Saturday, January 6, 2024

      

3689      +                                   PROC SQL;
3689      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3690      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3691      + RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
3692      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3692      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

3692      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3692      +
PROC SORT DATA=D_INV_METADATA_OTH
3693      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3693      +                           ;
3693      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
3694      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
867                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3694      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
3695      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3696      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3696      +
PROC SQL;  
3696      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3697      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3697      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3697      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3697      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3698      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3699      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
868                                         The SAS System             22:41 Saturday, January 6, 2024

      3698:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3699      +
PROC SQL;  
3699      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
3700      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
3701      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_OTHER'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3702      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
3703      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3703      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3703      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3703      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

869                                         The SAS System             22:41 Saturday, January 6, 2024

3703      +
;   DATA
3704      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
3705      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3705      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
3706      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3707      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3707      +
PROC SQL;  
3707      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3708      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3708      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3708      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3708      +                                                                                       
870                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3709      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3710      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3709:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3710      +
PROC SQL;  
3710      +
  CREATE TABLE D_INV_OTHER AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
3711      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_OTHER ON  &FACT_CASE .D_INV_OTHER_KEY  =D_INV_OTHER
3712      + .D_INV_OTHER_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.D_INV_OTHER increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_OTHER created, with 55 rows and 2 columns.

3712      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

3712      +
;          
3712      +
DATA D_INV_OTHER; SET D_INV_OTHER;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_OTHER.
871                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_OTHER has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_OTHER increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3714      + PROC SQL;
3714      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3714      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3714      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3714      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3714      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3715      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3715      +
PROC SQL;  
3715      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3716      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3717      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3718      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.
872                                         The SAS System             22:41 Saturday, January 6, 2024


3718      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
3719      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH' 
 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3719      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.06 seconds
      

3719      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3719      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3720      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3720      +              ;
3720      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3721      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
873                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3721      +
PROC SQL;  
3722      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3722      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3722      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3723      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3724      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3723:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3724      +                                                         PROC SQL;
3724      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
3725      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3726      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3727      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3727      +
874                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

3727      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3728      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3728      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3728      +
;          
3728      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3729      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3730      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3730      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3731      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3732      + OUTPUT; RUN;

875                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3732      +               PROC SQL;
3732      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3732      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3732      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3732      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3733      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
3734      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3734:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3734      +
PROC SQL;  
3734      +
  CREATE TABLE
876                                         The SAS System             22:41 Saturday, January 6, 2024

3735      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3736      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_PREGNANCY_BIRTH'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
3737      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
3738      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3738      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

3738      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3739      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3739      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3739      +                                                                           ;
3739      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3740      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3741      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
877                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3741      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3742      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3742      +
PROC SQL;  
3743      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3743      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3743      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3743      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
3744      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3745      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3745:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
878                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3745      +
PROC SQL;  
3745      +
  CREATE TABLE
3746      + D_INV_PREGNANCY_BIRTH AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
3747      +  NBS_RDB. D_INV_PREGNANCY_BIRTH ON  &FACT_CASE .D_INV_PREGNANCY_BIRTH_KEY  
=D_INV_PREGNANCY_BIRTH .D_INV_PREGNANCY_BIRTH_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_PREGNANCY_BIRTH created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.01 seconds
      

3748      + D_INV_PREGNANCY_BIRTH; SET D_INV_PREGNANCY_BIRTH;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_PREGNANCY_BIRTH.
NOTE: The data set WORK.D_INV_PREGNANCY_BIRTH has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_PREGNANCY_BIRTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3749      + PROC SQL;
3749      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3749      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
879                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 row was inserted into WORK.STD_TESTER.

3749      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3749      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3749      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3750      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3750      +
PROC SQL;  
3750      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3751      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3752      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RESIDENCY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3753      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3753      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3754      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_RESIDENCY'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3754      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.23 seconds
      cpu time            0.06 seconds
      

3754      +                                                                         DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

880                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3754      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3754      +
;  DATA    
3755      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3756      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3756      +
PROC SQL;  
3756      +
  DELETE FROM
3757      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3757      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
881                                         The SAS System             22:41 Saturday, January 6, 2024


3757      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3758      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3759      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3758:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3759      +                                   PROC SQL;
3759      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3760      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3761      + RDB_TABLE_NM='D_INV_RESIDENCY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
3762      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3762      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3762      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

882                                         The SAS System             22:41 Saturday, January 6, 2024

3762      +
PROC SORT
3763      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3763      +                                                   ;
3763      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3764      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3764      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3765      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3766      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3766      +
PROC SQL;  
3766      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3767      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3767      +                                     QUIT;
883                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3767      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3767      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3768      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3769      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3769:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3769      +
PROC SQL;  
3769      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3770      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3771      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RESIDENCY'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3772      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3773      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3773      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
884                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.04 seconds
      

3773      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3773      +
PROC SORT DATA=D_INV_METADATA_UNIT
3774      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3774      +                           ;
3774      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3775      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3775      +
DATA D_INV_METADATA_UNIT; SET
3776      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3777      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
885                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.01 seconds
      

3777      +
PROC SQL;  
3777      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3778      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3778      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3778      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3778      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3779      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3780      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3780:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3780      +
PROC SQL;  
3780      +
  CREATE TABLE D_INV_RESIDENCY AS   SELECT
3781      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
886                                         The SAS System             22:41 Saturday, January 6, 2024

=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RESIDENCY ON
3782      + &FACT_CASE .D_INV_RESIDENCY_KEY  =D_INV_RESIDENCY .D_INV_RESIDENCY_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_RESIDENCY; SET D_INV_RESIDENCY;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_RESIDENCY created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

3783      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_RESIDENCY.
NOTE: The data set WORK.D_INV_RESIDENCY has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_RESIDENCY increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3784      + PROC SQL;
3784      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3784      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3784      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3784      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3784      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
887                                         The SAS System             22:41 Saturday, January 6, 2024

3785      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3785      +
PROC SQL;  
3785      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3786      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3787      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_RISK_FACTOR'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3788      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 9 rows and 5 columns.

3788      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3789      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_RISK_FACTOR'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3789      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.09 seconds
      

3789      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 11 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3789      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 11 observations read from the data set WORK.D_INV_METADATA.
888                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 10 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3789      +
;  DATA    
3790      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3791      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 10 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 10 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 80.00 percent. 
      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3791      +
PROC SQL;  
3791      +
  DELETE FROM
3792      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 9 rows were deleted from WORK.DYNINVLISTING.

3792      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3792      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3793      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3794      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3793:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
889                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3794      +                                   PROC SQL;
3794      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3795      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3796      + RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
3797      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3797      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.06 seconds
      

3797      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3797      +
PROC SORT  
3798      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3798      +                                                   ;
890                                         The SAS System             22:41 Saturday, January 6, 2024

3798      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3799      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3799      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3800      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3801      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3801      +
PROC SQL;  
3801      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3802      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3802      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3802      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

891                                         The SAS System             22:41 Saturday, January 6, 2024

3802      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3803      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3804      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3804:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3804      +
PROC SQL;  
3804      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3805      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3806      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_RISK_FACTOR'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3807      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3808      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3808      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3808      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
892                                         The SAS System             22:41 Saturday, January 6, 2024


3808      +
PROC SORT DATA=D_INV_METADATA_UNIT
3809      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3809      +                           ;
3809      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3810      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3810      +
DATA D_INV_METADATA_UNIT; SET
3811      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3812      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3812      +
PROC SQL;  
3812      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3813      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

893                                         The SAS System             22:41 Saturday, January 6, 2024

3813      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3813      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3813      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3814      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3815      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3815:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3815      +
PROC SQL;  
3815      +
  CREATE TABLE D_INV_RISK_FACTOR AS   SELECT
3816      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_RISK_FACTOR ON
3817      + &FACT_CASE .D_INV_RISK_FACTOR_KEY  =D_INV_RISK_FACTOR .D_INV_RISK_FACTOR_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_RISK_FACTOR; SET D_INV_RISK_FACTOR;  DROP
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_RISK_FACTOR created, with 55 rows and 10 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.03 seconds
      

894                                         The SAS System             22:41 Saturday, January 6, 2024

3818      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_RISK_FACTOR.
NOTE: The data set WORK.D_INV_RISK_FACTOR has 55 observations and 10 variables.
NOTE: Compressing data set WORK.D_INV_RISK_FACTOR decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3819      + PROC SQL;
3819      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3819      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3819      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3819      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3819      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3820      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3820      +
PROC SQL;  
3820      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
895                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB_METADATA.RDB_TABLE_NM,
3821      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3822      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3823      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3823      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
3824      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'  
;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3824      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

3824      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3824      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3825      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3825      +              ;
3825      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
896                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3826      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3826      +
PROC SQL;  
3827      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3827      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3827      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3828      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3829      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3828:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3829      +                                                         PROC SQL;
3829      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
897                                         The SAS System             22:41 Saturday, January 6, 2024

3830      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3831      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3832      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3832      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
      

3832      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3833      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3833      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3833      +
;          
3833      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3834      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3835      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
898                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3835      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3836      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3837      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3837      +               PROC SQL;
3837      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3837      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3837      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3837      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3838      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
 IF
3839      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3839:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
899                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3839      +
PROC SQL;  
3839      +
  CREATE TABLE
3840      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3841      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_SOCIAL_HISTORY'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
3842      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
3843      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3843      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

3843      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3844      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3844      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3844      +                                                                           ;
900                                         The SAS System             22:41 Saturday, January 6, 2024

3844      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3845      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3846      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3846      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3847      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3847      +
PROC SQL;  
3848      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3848      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3848      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3848      +
901                                         The SAS System             22:41 Saturday, January 6, 2024

DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
3849      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3850      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3850:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3850      +
PROC SQL;  
3850      +
  CREATE TABLE
3851      + D_INV_SOCIAL_HISTORY AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
3852      + NBS_RDB. D_INV_SOCIAL_HISTORY ON  &FACT_CASE .D_INV_SOCIAL_HISTORY_KEY  
=D_INV_SOCIAL_HISTORY .D_INV_SOCIAL_HISTORY_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_SOCIAL_HISTORY created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

3853      + D_INV_SOCIAL_HISTORY; SET D_INV_SOCIAL_HISTORY;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 
_TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_SOCIAL_HISTORY.
NOTE: The data set WORK.D_INV_SOCIAL_HISTORY has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SOCIAL_HISTORY increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
902                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3854      + PROC SQL;
3854      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3854      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3854      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3854      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3854      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3855      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3855      +
PROC SQL;  
3855      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3856      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3857      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_SYMPTOM'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3858      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

3858      +
903                                         The SAS System             22:41 Saturday, January 6, 2024

   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3859      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_SYMPTOM'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3859      +                                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

3859      +                                                                       DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3859      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3859      +
;  DATA    
3860      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3861      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3861      +
904                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
3861      +
  DELETE FROM
3862      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

3862      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3862      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3863      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3864      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3863:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3864      +                                   PROC SQL;
3864      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3865      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3866      + RDB_TABLE_NM='D_INV_SYMPTOM'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
3867      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3867      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
905                                         The SAS System             22:41 Saturday, January 6, 2024

      

3867      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3867      +
PROC SORT  
3868      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3868      +                                                   ;
3868      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3869      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3869      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3870      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3871      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
906                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

3871      +
PROC SQL;  
3871      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3872      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3872      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3872      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3872      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3873      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3874      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3874:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3874      +
PROC SQL;  
3874      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3875      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3876      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
907                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_SYMPTOM'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3877      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3878      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3878      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

3878      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3878      +
PROC SORT DATA=D_INV_METADATA_UNIT
3879      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3879      +                           ;
3879      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3880      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
908                                         The SAS System             22:41 Saturday, January 6, 2024


3880      +
DATA D_INV_METADATA_UNIT; SET
3881      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3882      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3882      +
PROC SQL;  
3882      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3883      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3883      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3883      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3883      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3884      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3885      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3885:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
909                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3885      +
PROC SQL;  
3885      +
  CREATE TABLE D_INV_SYMPTOM AS   SELECT
3886      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_SYMPTOM ON
3887      + &FACT_CASE .D_INV_SYMPTOM_KEY  =D_INV_SYMPTOM .D_INV_SYMPTOM_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_SYMPTOM; SET D_INV_SYMPTOM;  DROP _TEMA001 _TEMA002 _TEMA003
NOTE: Compressing data set WORK.D_INV_SYMPTOM decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: Table WORK.D_INV_SYMPTOM created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.01 seconds
      

3888      + _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_SYMPTOM.
NOTE: The data set WORK.D_INV_SYMPTOM has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_SYMPTOM decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3889      + PROC SQL;
3889      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3889      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

910                                         The SAS System             22:41 Saturday, January 6, 2024

3889      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3889      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3889      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3890      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3890      +
PROC SQL;  
3890      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3891      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3892      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TREATMENT'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3893      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.D_INV_METADATA created, with 44 rows and 5 columns.

3893      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3894      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_TREATMENT'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3894      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.06 seconds
      

3894      +                                                                         DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

911                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 45 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 46 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3894      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 46 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 45 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3894      +
;  DATA    
3895      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3896      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 45 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 45 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 86.67 percent. 
      Compressed is 6 pages; un-compressed would require 45 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3896      +
PROC SQL;  
3896      +
  DELETE FROM
3897      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 44 rows were deleted from WORK.DYNINVLISTING.

3897      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
912                                         The SAS System             22:41 Saturday, January 6, 2024


3897      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3898      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3899      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3898:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3899      +                                   PROC SQL;
3899      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3900      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3901      + RDB_TABLE_NM='D_INV_TREATMENT'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE
3902      + '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA_OTH created, with 7 rows and 5 columns.

3902      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.06 seconds
      

3902      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 8 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
913                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

3902      +
PROC SORT  
3903      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3903      +                                                   ;
3903      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
3904      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 7 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3904      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
3905      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
3906      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 7 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 7 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH decreased size by 71.43 percent. 
      Compressed is 2 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

914                                         The SAS System             22:41 Saturday, January 6, 2024

3906      +
PROC SQL;
3906      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
3907      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 6 rows were deleted from WORK.DYNINVLISTING_OTH.

3907      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3907      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3907      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
3908      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
3909      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3909:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3909      +
PROC SQL;  
3909      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
3910      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
3911      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_TREATMENT'    AND 
915                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
3912      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
3913      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3913      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

3913      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3913      +
PROC SORT DATA=D_INV_METADATA_UNIT
3914      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3914      +                           ;
3914      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
3915      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

916                                         The SAS System             22:41 Saturday, January 6, 2024

3915      +
DATA D_INV_METADATA_UNIT; SET
3916      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
3917      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3917      +
PROC SQL;  
3917      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
3918      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3918      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3918      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3918      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
3919      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
3920      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3920:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
917                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3920      +
PROC SQL;  
3920      +
  CREATE TABLE D_INV_TREATMENT AS   SELECT
3921      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_TREATMENT ON
3922      + &FACT_CASE .D_INV_TREATMENT_KEY  =D_INV_TREATMENT .D_INV_TREATMENT_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_TREATMENT; SET D_INV_TREATMENT;  DROP _TEMA001 _TEMA002
NOTE: Compressing data set WORK.D_INV_TREATMENT decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.D_INV_TREATMENT created, with 55 rows and 52 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

3923      + _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_TREATMENT.
NOTE: The data set WORK.D_INV_TREATMENT has 55 observations and 52 variables.
NOTE: Compressing data set WORK.D_INV_TREATMENT decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3924      + PROC SQL;
3924      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3924      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3924      +
918                                         The SAS System             22:41 Saturday, January 6, 2024

  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3924      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3924      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3925      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3925      +
PROC SQL;  
3925      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3926      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3927      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS
3928      + NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_METADATA created, with 1 rows and 5 columns.

3928      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
3929      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_TRAVEL'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3929      +                                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.03 seconds
      

3929      +                                                                      DATA D_INV_METADATA; 
  IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
919                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA has 3 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3929      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3929      +
;  DATA    
3930      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
3931      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 2 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3931      +
PROC SQL;  
3931      +
  DELETE FROM
3932      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 1 row was deleted from WORK.DYNINVLISTING.

3932      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

920                                         The SAS System             22:41 Saturday, January 6, 2024

3932      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
3933      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
3934      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3933:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3934      +                                   PROC SQL;
3934      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
3935      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
3936      + RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE ''
3937      + and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3937      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.03 seconds
      

3937      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3937      +
921                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SORT DATA=D_INV_METADATA_OTH
3938      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3938      +                           ;
3938      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
3939      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3939      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
3940      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3941      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3941      +
PROC SQL;  
3941      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
3942      + DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3942      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
922                                         The SAS System             22:41 Saturday, January 6, 2024

      

3942      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3942      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3943      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3944      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3943:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3944      +
PROC SQL;  
3944      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
3945      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
3946      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_TRAVEL'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3947      + QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND 
CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS
3948      + NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3948      +                                                   QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.11 seconds
      cpu time            0.03 seconds
      

3948      +                                                         DATA D_INV_METADATA_UNIT;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;
923                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3948      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3948      +
;   DATA   
3949      + D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2
3950      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3950      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH
3951      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
3952      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

3952      +
PROC SQL;  
3952      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
924                                         The SAS System             22:41 Saturday, January 6, 2024

3953      + D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3953      +                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3953      +                              DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3953      +                                                                                       
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3954      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
3955      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3954:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3955      +
PROC SQL;  
3955      +
  CREATE TABLE D_INV_TRAVEL AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE ,
3956      + SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. 
D_INV_TRAVEL ON  &FACT_CASE .D_INV_TRAVEL_KEY  =D_INV_TRAVEL
3957      + .D_INV_TRAVEL_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI');
NOTE: Compressing data set WORK.D_INV_TRAVEL decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: Table WORK.D_INV_TRAVEL created, with 55 rows and 2 columns.

3957      +
 ;QUIT;    
NOTE: PROCEDURE SQL used (Total process time):
925                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.31 seconds
      cpu time            0.03 seconds
      

3957      +
;          
3957      +
DATA D_INV_TRAVEL; SET D_INV_TRAVEL;  DROP _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 
_TEMA007 _TEMA008 ;
3958      + RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_TRAVEL.
NOTE: The data set WORK.D_INV_TRAVEL has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_TRAVEL decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3959      + PROC SQL;
3959      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3959      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3959      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3959      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3959      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3960      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
926                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3960      +
PROC SQL;  
3960      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3961      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3962      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND
3963      + QUESTION_GROUP_SEQ_NBR IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3963      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD
3964      + FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_UNDER_CONDITION' 
 ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

3964      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.04 seconds
      

3964      +
DATA D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       
RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3964      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY
3965      + SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
927                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3965      +              ;
3965      +                 DATA DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN      USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || '
3966      + AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  
IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3966      +
PROC SQL;  
3967      + DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

3967      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3967      +
DATA DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', ''); 
 LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
3968      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL
3969      + SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3968:221   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
928                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3969      +                                                         PROC SQL;
3969      +                                                                     CREATE TABLE 
D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM,
3970      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON
3971      + NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND
3972      + OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

3972      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.01 seconds
      

3972      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET
3973      + D_INV_METADATA_OTH;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3973      +                                                          PROC SORT 
DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3973      +
;          
3973      +
DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_OTH;     BY SORT_KEY;
3974      + end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  
929                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  
USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP
3975      + RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3975      +                       DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   
LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS
3976      +(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));
3977      + OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3977      +               PROC SQL;
3977      +                          DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX 
(SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

3977      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3977      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3977      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE
3978      + $30000;   CALL SYMPUTX('D_INV_CASE_OTH', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1); 
930                                         The SAS System             22:41 Saturday, January 6, 2024

 IF
3979      +(LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3979:60   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3979      +
PROC SQL;  
3979      +
  CREATE TABLE
3980      + D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM, NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
   FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3981      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN 
NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_UNDER_CONDITION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT
3982      + FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS 
NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND
3983      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL ORDER BY NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

3983      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

3983      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;
3984      +       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3984      +              PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

931                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3984      +                                                                           ;
3984      +                                                                               DATA 
D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY); 
    SET D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL
3985      +(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 
=RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN
3986      +;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3986      +   DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH 
RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS '
3987      + ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3987      +
PROC SQL;  
3988      + DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM 
D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

3988      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

932                                         The SAS System             22:41 Saturday, January 6, 2024

3988      +
DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3988      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL
3989      + SYMPUTX('D_INV_CASE_UNIT', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  
RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2)
3990      + THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF 
(LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL 
SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      3990:50   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3990      +
PROC SQL;  
3990      +
  CREATE TABLE
3991      + D_INV_UNDER_CONDITION AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN
3992      +  NBS_RDB. D_INV_UNDER_CONDITION ON  &FACT_CASE .D_INV_UNDER_CONDITION_KEY  
=D_INV_UNDER_CONDITION .D_INV_UNDER_CONDITION_KEY  WHERE SUMM_DATAMART.DISEASE_GRP_CD = (SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); ;QUIT;;    DATA
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_UNDER_CONDITION created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.03 seconds
      

3993      + D_INV_UNDER_CONDITION; SET D_INV_UNDER_CONDITION;  DROP _TEMA001 _TEMA002 _TEMA003 
_TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
933                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_UNDER_CONDITION.
NOTE: The data set WORK.D_INV_UNDER_CONDITION has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_UNDER_CONDITION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3995      + PROC SQL;
3995      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
3995      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

3995      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

3995      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

3995      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
3996      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

3996      +
PROC SQL;  
3996      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
3997      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
3998      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_VACCINATION'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
934                                         The SAS System             22:41 Saturday, January 6, 2024

NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
3999      + IS NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

3999      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE
4000      + WHERE DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_VACCINATION'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

4000      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.04 seconds
      

4000      +                                                                           DATA 
D_INV_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4000      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4000      +
;  DATA    
4001      + DYNINVLISTING;   SET D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;  
 RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS
4002      +(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF 
(LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME 
|| ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
935                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4002      +
PROC SQL;  
4002      +
  DELETE FROM
4003      + DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING.

4003      +                                                                           QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4003      +                                                                                  DATA 
DYNINVLISTING; SET DYNINVLISTING; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
4004      + = TRIM(RDB_COLUMN_NAME_LIST);    IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE',
4005      + COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4004:200   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4005      +                                   PROC SQL;
4005      +                                               CREATE TABLE D_INV_METADATA_OTH AS  SELECT  
DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM
4006      + NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON 
NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   
ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE
4007      + RDB_TABLE_NM='D_INV_VACCINATION'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND 
OTHER_VALUE_IND_CD='T'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM
4008      + NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
936                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

4008      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.04 seconds
      

4008      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4008      +
PROC SORT  
4009      + DATA=D_INV_METADATA_OTH NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4009      +                                                   ;
4009      +                                                       DATA D_INV_METADATA_OTH; LENGTH 
RDB_COLUMN_NM2 $26;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY
4010      + SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH'; 
 USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4010      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY
4011      + SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF 
FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = 
COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
4012      +(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  
937                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; 
RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4012      +
PROC SQL;  
4012      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX
4013      + (SORT_KEY) FROM DYNINVLISTING_OTH);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

4013      +                                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4013      +                                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', 
''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4013      +
DATA DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS
4014      +(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF 
(LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  
IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE
4015      + ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = 
TRIM(TRIMMED_VALUE) || ",";  CALL SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4015:9   2326:1   
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4015      +
938                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
4015      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT
4016      + OTHER_VALUE_IND_CD, INIT.DATAMART_NM, NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
4017      + NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_VACCINATION'    AND 
NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
4018      + DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND DATA_TYPE IN 
('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS NOT NULL and 
UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
4019      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

4019      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.10 seconds
      cpu time            0.03 seconds
      

4019      +
DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4019      +
PROC SORT DATA=D_INV_METADATA_UNIT
4020      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4020      +                           ;
4020      +                               DATA D_INV_METADATA_UNIT; LENGTH RDB_COLUMN_NM2 $25; LENGTH 
RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;     BY SORT_KEY;       
end;   DO UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_UNIT;
4021      + BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || 
'_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) || '_UNIT';     OUTPUT;   END;   DROP 
RDB_COLUMN_NM2; RUN;

939                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4021      +
DATA D_INV_METADATA_UNIT; SET
4022      + D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
4023      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4023      +
PROC SQL;  
4023      +
  DELETE FROM D_INV_METADATA_UNIT WHERE
4024      + SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

4024      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4024      +                                                                    DATA _NULL_;  CALL 
SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4024      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_UNIT', '');
4025      + LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = 
TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM
4026      +("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3) THEN 
940                                         The SAS System             22:41 Saturday, January 6, 2024

TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', COMPBL(TRIMMED_VALUE)); 
RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4026:25   2326:1    
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4026      +
PROC SQL;  
4026      +
  CREATE TABLE D_INV_VACCINATION AS   SELECT
4027      + &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , SUMM_DATAMART.INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  
=&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB. D_INV_VACCINATION ON
4028      + &FACT_CASE .D_INV_VACCINATION_KEY  =D_INV_VACCINATION .D_INV_VACCINATION_KEY  WHERE 
SUMM_DATAMART.DISEASE_GRP_CD = (SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI'); 
;QUIT;;    DATA D_INV_VACCINATION; SET D_INV_VACCINATION;  DROP
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_VACCINATION created, with 55 rows and 2 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.03 seconds
      

4029      + _TEMA001 _TEMA002 _TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

WARNING: The variable _TEMA001 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_VACCINATION.
NOTE: The data set WORK.D_INV_VACCINATION has 55 observations and 2 variables.
NOTE: Compressing data set WORK.D_INV_VACCINATION increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4030      + PROC SQL;
4030      +            CREATE TABLE STD_TESTER(COUNTSTD NUM);
941                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
4030      +                                                    INSERT INTO STD_TESTER( COUNTSTD) 
VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

4030      +
  UPDATE STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

4030      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4030      +
DATA _NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx
4031      +('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then call symputx('FACT_CASE', 
'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4031      +
PROC SQL;  
4031      +
  CREATE TABLE D_INV_METADATA AS  SELECT  DISTINCT INIT.FORM_CD, INIT.DATAMART_NM, 
NBS_RDB_METADATA.RDB_TABLE_NM,
4032      + NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_RDB.INIT INNER JOIN NBS_ODS.NBS_UI_METADATA  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = 
INIT.FORM_CD  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON
4033      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID  WHERE 
RDB_TABLE_NM='D_INV_STD'   AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL
4034      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL   ORDER BY INIT.FORM_CD,  
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA created, with 0 rows and 5 columns.

4034      +
   INSERT INTO D_INV_METADATA set FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE
4035      + DATAMART_NM='TB_LTBI'),  RDB_TABLE_NM='D_INV_STD'  ;
NOTE: 1 row was inserted into WORK.D_INV_METADATA.

4035      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.23 seconds
      cpu time            0.07 seconds
942                                         The SAS System             22:41 Saturday, January 6, 2024

      

4035      +                                                             DATA D_INV_METADATA;   IF 
SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.D_INV_METADATA has 2 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4035      +
PROC SORT DATA=D_INV_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 2 observations read from the data set WORK.D_INV_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA has 1 observations and 6 variables.
NOTE: Compressing data set WORK.D_INV_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4035      +
;          
4035      +
DATA DYNINVLISTING;   SET
4036      + D_INV_METADATA;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;   RETAIN 
RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN      
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)||
4037      + " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 
THEN  RDB_COLUMN_NAME_LIST = COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    
OUTPUT; RUN;

NOTE: There were 1 observations read from the data set WORK.D_INV_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4037      +
PROC SQL;  
4037      +
  DELETE FROM DYNINVLISTING WHERE SORT_KEY <
4038      +(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
943                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.DYNINVLISTING.

4038      +                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4038      +                                                   DATA DYNINVLISTING; SET DYNINVLISTING; 
LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);
4039      +  IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, 
LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN TRIMMED_VALUE= TRIM("'"||&FACT_CASE 
||"."||INVESTIGATION_KEY||"'");  CALL SYMPUTX('D_INV_CASE', COMPBL(TRIMMED_VALUE));   RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4039:168   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 12 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4040      + PROC SQL;
4040      +             CREATE TABLE D_INV_METADATA_OTH AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, 
INIT.DATAMART_NM,NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN
4041      + NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID  INNER JOIN NBS_RDB.INIT   ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE RDB_TABLE_NM='D_INV_STD'    AND
4042      + NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR IS NULL  AND OTHER_VALUE_IND_CD='T'  AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
4043      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL  ORDER BY 
NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_OTH created, with 0 rows and 5 columns.

4043      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.00 seconds
      

4043      +
DATA D_INV_METADATA_OTH;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_METADATA_OTH;    SORT_KEY+1;  
OUTPUT;       RUN;

944                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4043      +
PROC SORT DATA=D_INV_METADATA_OTH
4044      + NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4044      +                           ;
4044      +                               DATA D_INV_METADATA_OTH; LENGTH RDB_COLUMN_NM2 $26;    DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;       end;   DO 
UNTIL(LAST.SORT_KEY);     SET D_INV_METADATA_OTH;     BY SORT_KEY;  RDB_COLUMN_NM2
4045      + =RDB_COLUMN_NM;  RDB_COLUMN_NM =TRIM(RDB_COLUMN_NM2) || '_OTH';  USER_DEFINED_COLUMN_NM= 
TRIM(USER_DEFINED_COLUMN_NM) || '_OTH';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.D_INV_METADATA_OTH has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4045      +
DATA DYNINVLISTING_OTH; SET D_INV_METADATA_OTH;  BY SORT_KEY;   LENGTH
4046      + RDB_COLUMN_NAME_LIST $15000;   RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN    USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' 
||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM
4047      +)||"'";  IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4047      +
PROC SQL;  
4047      +
  DELETE FROM DYNINVLISTING_OTH WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM
4048      + DYNINVLISTING_OTH);
945                                         The SAS System             22:41 Saturday, January 6, 2024

WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.DYNINVLISTING_OTH.

4048      +                     QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4048      +                            DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_OTH', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4048      +                                                                                    DATA 
DYNINVLISTING_OTH; SET DYNINVLISTING_OTH; LENGTH TRIMMED_VALUE $30000;   CALL 
SYMPUTX('D_INV_CASE_OTH', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
4049      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN
4050      +(TRIMMED_VALUE) >3) THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";  CALL 
SYMPUTX('D_INV_CASE_OTH', COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4049:219   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.DYNINVLISTING_OTH.
NOTE: The data set WORK.DYNINVLISTING_OTH has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4050      +
PROC SQL;  
4050      +
  CREATE TABLE D_INV_METADATA_UNIT AS  SELECT  DISTINCT OTHER_VALUE_IND_CD, INIT.DATAMART_NM,
4051      + NBS_RDB_METADATA.RDB_TABLE_NM, 
NBS_RDB_METADATA.RDB_COLUMN_NM,NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM    FROM 
NBS_ODS.NBS_UI_METADATA  INNER JOIN NBS_ODS.NBS_RDB_METADATA  ON NBS_UI_METADATA.NBS_UI_METADATA_UID 
= NBS_RDB_METADATA.NBS_UI_METADATA_UID
4052      + INNER JOIN NBS_RDB.INIT   ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD  WHERE 
RDB_TABLE_NM='D_INV_STD'    AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND QUESTION_GROUP_SEQ_NBR
4053      + IS NULL  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND MASK IS 
NOT NULL and UPCASE(UNIT_TYPE_CD)='CODED'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL ORDER BY
4054      + NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: Table WORK.D_INV_METADATA_UNIT created, with 0 rows and 5 columns.

946                                         The SAS System             22:41 Saturday, January 6, 2024

4054      +                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

4054      +                                       DATA D_INV_METADATA_UNIT;   IF SORT_KEY=1 THEN 
OUTPUT;   SET D_INV_METADATA_UNIT;    SORT_KEY+1;  OUTPUT;       RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4054      +
PROC SORT DATA=D_INV_METADATA_UNIT NODUPKEY; BY SORT_KEY;RUN;

NOTE: Input data set is empty.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4054      +
;          
4054      +
DATA D_INV_METADATA_UNIT; LENGTH
4055      + RDB_COLUMN_NM2 $25; LENGTH RDB_COLUMN_NM $30;    DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;       end;   DO UNTIL(LAST.SORT_KEY);     SET 
D_INV_METADATA_UNIT;     BY SORT_KEY;  RDB_COLUMN_NM2 =RDB_COLUMN_NM;  RDB_COLUMN_NM
4056      + =TRIM(RDB_COLUMN_NM2) || '_UNIT';  USER_DEFINED_COLUMN_NM= TRIM(USER_DEFINED_COLUMN_NM) 
|| '_UNIT';     OUTPUT;   END;   DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4056      +
DATA D_INV_METADATA_UNIT; SET D_INV_METADATA_UNIT;  BY SORT_KEY;   LENGTH RDB_COLUMN_NAME_LIST $15000;
4057      + RETAIN RDB_COLUMN_NAME_LIST;  IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN    
USER_DEFINED_COLUMN_NAME = COMPRESS(RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " 
'"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";  IF (LENGTHN
4058      +(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
COMPBL((USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST));    OUTPUT; RUN;

NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
947                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4058      +
PROC SQL;  
4058      +
  DELETE FROM D_INV_METADATA_UNIT WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM D_INV_METADATA_UNIT);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: No rows were deleted from WORK.D_INV_METADATA_UNIT.

4059      + QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4059      +        DATA _NULL_;  CALL SYMPUTX('D_INV_CASE_UNIT', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4059      +                                                                 DATA D_INV_METADATA_UNIT; 
SET D_INV_METADATA_UNIT; LENGTH TRIMMED_VALUE $30000;   CALL SYMPUTX('D_INV_CASE_UNIT', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST
4060      + = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  IF (LENGTH<2) THEN 
TRIMMED_VALUE= TRIM("'"||&FACT_CASE ||"."||INVESTIGATION_KEY||"'");  IF (LENGTHN(TRIMMED_VALUE) >3)
4061      + THEN TRIMMED_VALUE = TRIM(TRIMMED_VALUE) || ",";   CALL SYMPUTX('D_INV_CASE_UNIT', 
COMPBL(TRIMMED_VALUE)); RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4060:198   2326:1     
NOTE: Variable F_PAGE_CASE is uninitialized.
NOTE: Variable INVESTIGATION_KEY is uninitialized.
NOTE: There were 0 observations read from the data set WORK.D_INV_METADATA_UNIT.
NOTE: The data set WORK.D_INV_METADATA_UNIT has 0 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4061      +
PROC SQL;  
4061      +
       CREATE TABLE D_INV_STD AS   SELECT  &D_INV_CASE_UNIT  &D_INV_CASE_OTH &D_INV_CASE , 
SUMM_DATAMART.INVESTIGATION_KEY FROM
4062      + NBS_RDB.SUMM_DATAMART;
NOTE: Compressing data set WORK.D_INV_STD increased size by 100.00 percent. 
948                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_STD created, with 55 rows and 2 columns.

4062      +                        ;QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

4062      +                              ;
4062      +                                   DATA D_INV_STD; SET D_INV_STD;  DROP _TEMA001 _TEMA002 
_TEMA003 _TEMA004 _TEMA005 _TEMA006 _TEMA007 _TEMA008 ; RUN;

NOTE: Compression was disabled for data set WORK.D_INV_STD because compression overhead would 
      increase the size of the data set.
WARNING: The variable _TEMA002 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA003 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA004 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA005 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA006 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA007 in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable _TEMA008 in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 55 observations read from the data set WORK.D_INV_STD.
NOTE: The data set WORK.D_INV_STD has 55 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4063      + PROC SQL;
4063      +           CREATE TABLE ORGANIZATION_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
4064      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
4065      + IS NOT NULL AND RDB_TABLE_NM ='D_ORGANIZATION' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.ORGANIZATION_METADATA created, with 2 rows and 3 columns.

4065      +                                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

4065      +                                                                            DATA 
ORGANIZATION_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET ORGANIZATION_METADATA;    SORT_KEY+1;  
OUTPUT;       RUN;

NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
949                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4065      +
PROC SORT DATA=ORGANIZATION_METADATA NODUPKEY; BY
4066      + SORT_KEY;RUN;

NOTE: There were 3 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 4 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4066      +              ;
4066      +                PROC SQL;
4066      +                          CREATE TABLE ORGANIZATION  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.ORGANIZATION because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.ORGANIZATION created, with 0 rows and 1 columns.
4066      +                                                                              QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4066      +                                                                                     DATA 
ORGANIZATION_METADATA;   SET ORGANIZATION_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF 
FIRST.SORT_KEY THEN  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
4067      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
4068      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY';    KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY';  DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1,
4069      + INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL';  QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 
1, INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC';  UID= USER_DEFINED_COLUMN_NM;  call 
execute('%POPULATE_ORGANIZATION('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||
4070      + KEY||','||  DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4069:234   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 2 observations read from the data set WORK.ORGANIZATION_METADATA.
NOTE: The data set WORK.ORGANIZATION_METADATA has 2 observations and 9 variables.
NOTE: Compressing data set WORK.ORGANIZATION_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
950                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
2         + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
3         + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
HOSPITAL_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
4         + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
HOSPITAL_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 55 rows and 15 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.01 seconds
      

4         +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH HSP_DETAIL  $2000;   IF
5         + ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; HSP_KEY=ORGANIZATION_KEY; HSP_QEC 
=ORGANIZATION_QUICK_CODE; HSP_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN 
CITY_STATE_ZIP =PROPCASE(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM
6         +(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || TRIM(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM
7         +(ORGANIZATION_LOCAL_ID))>0 THEN HSP_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN HSP_DETAIL =TRIM(HSP_DETAIL) ||'<br>' || 
PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN
8         + HSP_DETAIL=  TRIM(HSP_DETAIL) ||'<br>' ||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); 
IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0 then HSP_DETAIL=  TRIM(HSP_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM
9         +(CITY_STATE_ZIP))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ; 
IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || 
PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0
10        + then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
HSP_DETAIL= TRIM(HSP_DETAIL)|| ', ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK)
11        +; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)|| '<br> ext. ' || 
TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(HSP_DETAIL))>0 then HSP_DETAIL= TRIM(HSP_DETAIL)||
12        + '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME ORGANIZATION_STREET_ADDRESS_1 
ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  
951                                         The SAS System             22:41 Saturday, January 6, 2024

ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP ORGANIZATION_CITY
13        + ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE HOSPITAL_KEY;  RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 55 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

13        +                                                                                    PROC 
SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 55 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

13        +
DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 55 observations and 6 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

14        + PROC SQL;
14        +           CREATE TABLE ORGPART_TABLE AS SELECT D_ORGANIZATION.ORGANIZATION_KEY, 
D_ORGANIZATION.ORGANIZATION_QUICK_CODE, D_ORGANIZATION.ORGANIZATION_NAME, 
D_ORGANIZATION.ORGANIZATION_LOCAL_ID,  D_ORGANIZATION.ORGANIZATION_UID,
15        + D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_1, 
D_ORGANIZATION.ORGANIZATION_STREET_ADDRESS_2, 
D_ORGANIZATION.ORGANIZATION_CITY,D_ORGANIZATION.ORGANIZATION_STATE, D_ORGANIZATION.ORGANIZATION_ZIP, 
D_ORGANIZATION.ORGANIZATION_COUNTY,
16        + D_ORGANIZATION.ORGANIZATION_PHONE_WORK,D_ORGANIZATION.ORGANIZATION_PHONE_EXT_WORK, 
ORG_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON SUMM_DATAMART.INVESTIGATION_KEY =
17        + F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN NBS_RDB.D_ORGANIZATION ON   F_PAGE_CASE . 
ORG_AS_REPORTER_KEY = D_ORGANIZATION.ORGANIZATION_KEY;
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: Table WORK.ORGPART_TABLE created, with 55 rows and 15 columns.
952                                         The SAS System             22:41 Saturday, January 6, 2024


17        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.45 seconds
      cpu time            0.03 seconds
      

17        +
DATA ORGPART_TABLE; SET ORGPART_TABLE; LENGTH CITY_STATE_ZIP $2000; LENGTH REPORTING_FACILITY_DETAIL  
$2000;
18        +   IF   ORGANIZATION_KEY =1 THEN ORGANIZATION_KEY=.; 
REPORTING_FACILITY_KEY=ORGANIZATION_KEY; REPORTING_FACILITY_QEC =ORGANIZATION_QUICK_CODE; 
REPORTING_FACILITY_UID= ORGANIZATION_UID; IF LENGTHN(TRIM(ORGANIZATION_CITY))>0 THEN CITY_STATE_ZIP 
=PROPCASE
19        +(TRIM(ORGANIZATION_CITY)); IF LENGTHN(TRIM(ORGANIZATION_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(ORGANIZATION_STATE)) ; IF 
LENGTHN(TRIM(ORGANIZATION_ZIP))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || TRIM
20        +(ORGANIZATION_ZIP) ;  If LENGTHN(TRIM(ORGANIZATION_LOCAL_ID))>0 THEN 
REPORTING_FACILITY_DETAIL ='<b></b>' ||TRIM(ORGANIZATION_LOCAL_ID); If 
LENGTHN(TRIM(ORGANIZATION_NAME))>0 THEN REPORTING_FACILITY_DETAIL =TRIM(REPORTING_FACILITY_DETAIL) 
||'<br>' ||
21        + PROPCASE(ORGANIZATION_NAME); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_1))>0 THEN 
REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) ||'<br>' 
||PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_1)); IF LENGTHN(TRIM(ORGANIZATION_STREET_ADDRESS_2))>0
22        + then REPORTING_FACILITY_DETAIL=  TRIM(REPORTING_FACILITY_DETAIL) || '<br>' || 
PROPCASE(TRIM(ORGANIZATION_STREET_ADDRESS_2)) ; IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM
23        +(CITY_STATE_ZIP) ; IF LENGTHN(TRIM(ORGANIZATION_COUNTY))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>' || PROPCASE(TRIM(ORGANIZATION_COUNTY)); IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 then REPORTING_FACILITY_DETAIL= TRIM
24        +(REPORTING_FACILITY_DETAIL)|| '<br>' || TRIM(ORGANIZATION_PHONE_WORK) ; IF 
LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))>0 and LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then 
REPORTING_FACILITY_DETAIL= TRIM(REPORTING_FACILITY_DETAIL)|| ', ext. ' || TRIM
25        +(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN(TRIM(ORGANIZATION_PHONE_WORK))=0 and 
LENGTHN(TRIM(ORGANIZATION_PHONE_EXT_WORK))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br> ext. ' || TRIM(ORGANIZATION_PHONE_EXT_WORK) ; IF LENGTHN
26        +(TRIM(REPORTING_FACILITY_DETAIL))>0 then REPORTING_FACILITY_DETAIL= 
TRIM(REPORTING_FACILITY_DETAIL)|| '<br>';    DROP ORGANIZATION_LOCAL_ID ORGANIZATION_NAME 
ORGANIZATION_STREET_ADDRESS_1 ORGANIZATION_STREET_ADDRESS_2 ORGANIZATION_COUNTY
27        + ORGANIZATION_PHONE_WORK ORGANIZATION_KEY  ORGANIZATION_PHONE_EXT_WORK CITY_STATE_ZIP 
ORGANIZATION_CITY ORGANIZATION_ZIP ORGANIZATION_STATE ORGANIZATION_QUICK_CODE ORG_AS_REPORTER_KEY;  
RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: The data set WORK.ORGPART_TABLE has 55 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

27        +
953                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SORT DATA=ORGPART_TABLE NODUPKEY; BY INVESTIGATION_KEY
28        +;RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.ORGPART_TABLE has 55 observations and 6 variables.
NOTE: Compressing data set WORK.ORGPART_TABLE decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

28        +       DATA ORGANIZATION; MERGE ORGPART_TABLE ORGANIZATION; BY INVESTIGATION_KEY; RUN;

NOTE: There were 55 observations read from the data set WORK.ORGPART_TABLE.
NOTE: There were 55 observations read from the data set WORK.ORGANIZATION.
NOTE: The data set WORK.ORGANIZATION has 55 observations and 10 variables.
NOTE: Compressing data set WORK.ORGANIZATION decreased size by 89.47 percent. 
      Compressed is 2 pages; un-compressed would require 19 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4071      + PROC SQL;
4071      +           CREATE TABLE PROVIDER_METADATA  AS SELECT DISTINCT RDB_COLUMN_NM, 
user_defined_column_nm, part_type_cd FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA 
 ON NBS_RDB_METADATA.NBS_UI_METADATA_UID
4072      + =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND PART_TYPE_CD
4073      + IS NOT NULL AND RDB_TABLE_NM ='D_PROVIDER' AND DATA_TYPE='PART';
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.PROVIDER_METADATA created, with 3 rows and 3 columns.

4073      +                                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.00 seconds
      

4073      +                                                                        DATA 
PROVIDER_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET PROVIDER_METADATA;    SORT_KEY+1;  OUTPUT;      
 RUN;

NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 4 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
954                                         The SAS System             22:41 Saturday, January 6, 2024

      

4073      +
PROC SORT DATA=PROVIDER_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 4 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 4 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4073      +
; PROC     
4074      + SQL;
4074      +      CREATE TABLE PROVIDER  (INVESTIGATION_KEY NUM);
NOTE: Compression was disabled for data set WORK.PROVIDER because compression overhead would increase 
      the size of the data set.
NOTE: Table WORK.PROVIDER created, with 0 rows and 1 columns.
4074      +                                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4074      +                                                             DATA PROVIDER_METADATA;   SET 
PROVIDER_METADATA;  BY SORT_KEY;  LENGTH DETAIL $2000;  IF FIRST.SORT_KEY THEN  IF part_type_cd= 
'CASupervisorOfPHC' THEN
4075      + PART_TYPE_CD='SUPRVSR_OF_CASE_ASSGNMENT_KEY';  IF part_type_cd= 'ClosureInvestgrOfPHC' 
THEN PART_TYPE_CD='CLOSED_BY_KEY';  IF part_type_cd= 'DispoFldFupInvestgrOfPHC' THEN 
PART_TYPE_CD='DISPOSITIONED_BY_KEY';  IF part_type_cd= 'FldFupInvestgrOfPHC' THEN
4076      + PART_TYPE_CD='INVSTGTR_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupProvOfPHC' THEN 
PART_TYPE_CD='PROVIDER_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'FldFupSupervisorOfPHC' THEN 
PART_TYPE_CD='SUPRVSR_OF_FLD_FOLLOW_UP_KEY';  IF part_type_cd=
4077      + 'InitFldFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_ASGNED_FLD_FOLLOW_UP_KEY';  IF 
part_type_cd= 'InitFupInvestgrOfPHC' THEN PART_TYPE_CD='INIT_FOLLOW_UP_INVSTGTR_KEY';  IF 
part_type_cd= 'InitInterviewerOfPHC' THEN
4078      + PART_TYPE_CD='INIT_ASGNED_INTERVIEWER_KEY';  IF part_type_cd= 'InterviewerOfPHC' THEN 
PART_TYPE_CD='INTERVIEWER_ASSIGNED_KEY';  IF part_type_cd= 'InvestgrOfPHC' THEN 
PART_TYPE_CD='INVESTIGATOR_KEY';  IF part_type_cd= 'PerAsProviderOfDelivery' THEN
4079      + PART_TYPE_CD='DELIVERING_MD_KEY';  IF part_type_cd= 'PerAsProviderOfOBGYN' THEN 
PART_TYPE_CD='MOTHER_OB_GYN_KEY';  IF part_type_cd= 'PerAsProvideroOfPediatrics' THEN 
PART_TYPE_CD='PEDIATRICIAN_KEY';  IF part_type_cd= 'PerAsReporterOfPHC' THEN
4080      + PART_TYPE_CD='PERSON_AS_REPORTER_KEY';  IF part_type_cd= 'PhysicianOfPHC' THEN 
PART_TYPE_CD='PHYSICIAN_KEY';  IF part_type_cd= 'SurvInvestgrOfPHC' THEN 
PART_TYPE_CD='SURVEILLANCE_INVESTIGATOR_KEY';  IF part_type_cd= 'FldFupFacilityOfPHC' THEN
4081      + PART_TYPE_CD='FACILITY_FLD_FOLLOW_UP_KEY';  IF part_type_cd= 'HospOfADT' THEN 
PART_TYPE_CD='HOSPITAL_KEY';  IF part_type_cd= 'OrgAsClinicOfPHC' THEN 
PART_TYPE_CD='ORDERING_FACILITY_KEY';  IF part_type_cd= 'OrgAsHospitalOfDelivery' THEN
4082      + PART_TYPE_CD='DELIVERING_HOSP_KEY';  IF part_type_cd= 'OrgAsReporterOfPHC' THEN 
PART_TYPE_CD='ORG_AS_REPORTER_KEY'; KEY  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
955                                         The SAS System             22:41 Saturday, January 6, 2024

INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'KEY'; DETAIL  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, INDEX
4083      +(USER_DEFINED_COLUMN_NM, "_UID"))||'DETAIL'; QEC  = SUBSTR(USER_DEFINED_COLUMN_NM, 1, 
INDEX(USER_DEFINED_COLUMN_NM, "_UID"))||'QEC'; UID = USER_DEFINED_COLUMN_NM; call 
execute('%POPULATE_PROVIDER('|| PART_TYPE_CD||','||  SUMM_DATAMART||','||  KEY||','||
4084      + DETAIL||','||  QEC||','||  UID||')'); OUTPUT; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4083:222   
NOTE: Variable SUMM_DATAMART is uninitialized.
NOTE: There were 3 observations read from the data set WORK.PROVIDER_METADATA.
NOTE: The data set WORK.PROVIDER_METADATA has 3 observations and 9 variables.
NOTE: Compressing data set WORK.PROVIDER_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
2         + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
3         + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
INVESTIGATOR_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART 
INNER JOIN  NBS_RDB. F_PAGE_CASE ON
4         + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . INVESTIGATOR_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 55 rows and 20 columns.

4         +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.34 seconds
      cpu time            0.01 seconds
      

4         +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
5         + PHC_INV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  PHC_INV_KEY=PROVIDER_KEY;  PHC_INV_QEC =PROVIDER_QUICK_CODE;  
PHC_INV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
6         + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
7         +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
956                                         The SAS System             22:41 Saturday, January 6, 2024

=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
8         +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
9         + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
10        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
11        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
12        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN PHC_INV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHC_INV_DETAIL 
=TRIM(PHC_INV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
13        + PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
PHC_INV_DETAIL=  TRIM(PHC_INV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
14        +(TRIM(CITY_STATE_ZIP))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHC_INV_DETAIL= 
TRIM(PHC_INV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
15        +(PROVIDER_PHONE_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| ', ext. ' || TRIM
16        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHC_INV_DETAIL))>0 then
17        + PHC_INV_DETAIL= TRIM(PHC_INV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
18        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE INVESTIGATOR_KEY;  RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

18        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
957                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

18        +
  DATA     
19        + PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 0 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

20        + PROC SQL;
20        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
21        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
22        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PHYSICIAN_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM NBS_RDB.SUMM_DATAMART INNER 
JOIN  NBS_RDB. F_PAGE_CASE ON
23        + SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PHYSICIAN_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 55 rows and 20 columns.

23        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.31 seconds
      cpu time            0.01 seconds
      

23        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH PHYS_DETAIL
24        + $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN PROVIDER_KEY=.;  
PHYS_KEY=PROVIDER_KEY;  PHYS_QEC =PROVIDER_QUICK_CODE;  PHYS_UID=PROVIDER_UID;   IF 
LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP =PROPCASE(TRIM(PROVIDER_CITY));
25        + IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ', ' || 
PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE(TRIM(PROVIDER_ZIP)) ;
26        + PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF LENGTHN(TRIM(PROVIDER_NAME))>0 
AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| 
PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0
27        + AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
958                                         The SAS System             22:41 Saturday, January 6, 2024

=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM
28        +(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME
29        + =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN
30        +(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| 
TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE 
))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If LENGTHN(TRIM
31        +(PROVIDER_LOCAL_ID))>0 THEN PHYS_DETAIL ='<b></b>' ||TRIM(PROVIDER_LOCAL_ID);  If 
LENGTHN(TRIM(PROVIDER_NAME))>0 THEN PHYS_DETAIL =TRIM(PHYS_DETAIL) ||'<br>' || PROVIDER_NAME;  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN PHYS_DETAIL=  TRIM
32        +(PHYS_DETAIL) ||'<br>' ||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF 
LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN PHYS_DETAIL=  TRIM(PHYS_DETAIL) || '<br>' || 
PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF LENGTHN(TRIM(CITY_STATE_ZIP))>0 THEN
33        + PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || TRIM(CITY_STATE_ZIP) ;  IF 
LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>' || 
PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 THEN PHYS_DETAIL= TRIM
34        +(PHYS_DETAIL)|| '<br>' || TRIM(PROVIDER_PHONE_WORK) ;  IF 
LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| ', ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM
35        +(PROVIDER_PHONE_WORK))=0 and LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN PHYS_DETAIL= 
TRIM(PHYS_DETAIL)|| '<br> ext. ' || TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PHYS_DETAIL))>0 
then PHYS_DETAIL= TRIM(PHYS_DETAIL)|| '<br>';     DROP
36        + PROVIDER_NAME PROVIDER_FIRST_NAME PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME 
PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK    PROVIDER_STREET_ADDRESS_1 
PROVIDER_STREET_ADDRESS_2 PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY
37        + PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE 
PROVIDER_QUICK_CODE PHYSICIAN_KEY;  RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

37        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

959                                         The SAS System             22:41 Saturday, January 6, 2024

37        +
DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY
38        + INVESTIGATION_KEY; RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 55 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 55 observations and 11 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 89.47 percent. 
      Compressed is 2 pages; un-compressed would require 19 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

39        + PROC SQL;
39        +           CREATE TABLE PROVPART_TABLE AS SELECT D_PROVIDER.PROVIDER_KEY, 
D_PROVIDER.PROVIDER_QUICK_CODE, D_PROVIDER.PROVIDER_LOCAL_ID, D_PROVIDER.PROVIDER_UID, 
D_PROVIDER.PROVIDER_FIRST_NAME, D_PROVIDER.PROVIDER_MIDDLE_NAME,
40        + D_PROVIDER.PROVIDER_LAST_NAME, D_PROVIDER.PROVIDER_NAME_SUFFIX,  
D_PROVIDER.PROVIDER_NAME_DEGREE, D_PROVIDER.PROVIDER_STREET_ADDRESS_1, 
D_PROVIDER.PROVIDER_STREET_ADDRESS_2, D_PROVIDER.PROVIDER_CITY,D_PROVIDER.PROVIDER_STATE, 
D_PROVIDER.PROVIDER_ZIP,
41        + D_PROVIDER.PROVIDER_COUNTY, 
D_PROVIDER.PROVIDER_PHONE_WORK,D_PROVIDER.PROVIDER_PHONE_EXT_WORK, PROVIDER_EMAIL_WORK, 
PERSON_AS_REPORTER_KEY, SUMM_DATAMART.INVESTIGATION_KEY AS INVESTIGATION_KEY FROM 
NBS_RDB.SUMM_DATAMART INNER JOIN  NBS_RDB. F_PAGE_CASE
42        + ON SUMM_DATAMART.INVESTIGATION_KEY = F_PAGE_CASE .INVESTIGATION_KEY LEFT JOIN 
NBS_RDB.D_PROVIDER ON   F_PAGE_CASE . PERSON_AS_REPORTER_KEY = D_PROVIDER.PROVIDER_KEY;
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 50.00 percent. 
      Compressed is 2 pages; un-compressed would require 4 pages.
NOTE: Table WORK.PROVPART_TABLE created, with 55 rows and 20 columns.

42        +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.32 seconds
      cpu time            0.03 seconds
      

42        +
DATA PROVPART_TABLE; SET PROVPART_TABLE;  LENGTH CITY_STATE_ZIP $2000;  LENGTH
43        + RPT_PRV_DETAIL  $2000;  LENGTH PROVIDER_NAME  $2000;        IF   PROVIDER_KEY =1 THEN 
PROVIDER_KEY=.;  RPT_PRV_KEY=PROVIDER_KEY;  RPT_PRV_QEC =PROVIDER_QUICK_CODE;  
RPT_PRV_UID=PROVIDER_UID;   IF LENGTHN(TRIM(PROVIDER_CITY))>0 THEN CITY_STATE_ZIP
44        + =PROPCASE(TRIM(PROVIDER_CITY));  IF LENGTHN(TRIM(PROVIDER_STATE))>0 THEN CITY_STATE_ZIP = 
TRIM(CITY_STATE_ZIP) || ', ' || PROPCASE(TRIM(PROVIDER_STATE)) ;  IF LENGTHN(TRIM(PROVIDER_ZIP))>0 
THEN CITY_STATE_ZIP = TRIM(CITY_STATE_ZIP) || ' ' || PROPCASE
45        +(TRIM(PROVIDER_ZIP)) ;    PROVIDER_NAME=PROPCASE(TRIM(PROVIDER_FIRST_NAME));    IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=TRIM(PROVIDER_NAME) ||' '|| PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN
46        +(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_MIDDLE_NAME ))>0 THEN PROVIDER_NAME 
=PROPCASE(TRIM(PROVIDER_MIDDLE_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))>0 AND 
LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||' '||
47        + PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
960                                         The SAS System             22:41 Saturday, January 6, 2024

LENGTHN(TRIM(PROVIDER_LAST_NAME ))>0 THEN PROVIDER_NAME = PROPCASE(TRIM(PROVIDER_LAST_NAME));  IF 
LENGTHN(TRIM(PROVIDER_NAME))>0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN
48        + PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', '|| PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF 
LENGTHN(TRIM(PROVIDER_NAME))=0 AND LENGTHN(TRIM(PROVIDER_NAME_SUFFIX ))>0 THEN PROVIDER_NAME = 
PROPCASE(TRIM(PROVIDER_NAME_SUFFIX));  IF LENGTHN(TRIM(PROVIDER_NAME))>0
49        + AND LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0 THEN PROVIDER_NAME =TRIM(PROVIDER_NAME) ||', 
'|| TRIM(PROVIDER_NAME_DEGREE);  IF LENGTHN(TRIM(PROVIDER_NAME))=0 AND 
LENGTHN(TRIM(PROVIDER_NAME_DEGREE ))>0  THEN PROVIDER_NAME = TRIM(PROVIDER_NAME_DEGREE);    If
50        + LENGTHN(TRIM(PROVIDER_LOCAL_ID))>0 THEN RPT_PRV_DETAIL ='<b></b>' 
||TRIM(PROVIDER_LOCAL_ID);  If LENGTHN(TRIM(PROVIDER_NAME))>0 THEN RPT_PRV_DETAIL 
=TRIM(RPT_PRV_DETAIL) ||'<br>' || PROVIDER_NAME;  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_1))>0 THEN
51        + RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) ||'<br>' 
||PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_1));  IF LENGTHN(TRIM(PROVIDER_STREET_ADDRESS_2))>0 THEN 
RPT_PRV_DETAIL=  TRIM(RPT_PRV_DETAIL) || '<br>' || PROPCASE(TRIM(PROVIDER_STREET_ADDRESS_2)) ;  IF 
LENGTHN
52        +(TRIM(CITY_STATE_ZIP))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(CITY_STATE_ZIP) ;  IF LENGTHN(TRIM(PROVIDER_COUNTY))>0 THEN RPT_PRV_DETAIL= 
TRIM(RPT_PRV_DETAIL)|| '<br>' || PROPCASE(TRIM(PROVIDER_COUNTY)) ;  IF LENGTHN(TRIM
53        +(PROVIDER_PHONE_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>' || 
TRIM(PROVIDER_PHONE_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))>0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| ', ext. ' || TRIM
54        +(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(PROVIDER_PHONE_WORK))=0 and 
LENGTHN(TRIM(PROVIDER_PHONE_EXT_WORK))>0 THEN RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br> ext. ' || 
TRIM(PROVIDER_PHONE_EXT_WORK) ;  IF LENGTHN(TRIM(RPT_PRV_DETAIL))>0 then
55        + RPT_PRV_DETAIL= TRIM(RPT_PRV_DETAIL)|| '<br>';     DROP PROVIDER_NAME PROVIDER_FIRST_NAME 
PROVIDER_MIDDLE_NAME PROVIDER_LAST_NAME PROVIDER_NAME_SUFFIX PROVIDER_NAME_DEGREE PROVIDER_EMAIL_WORK 
   PROVIDER_STREET_ADDRESS_1 PROVIDER_STREET_ADDRESS_2
56        + PROVIDER_COUNTY PROVIDER_PHONE_WORK PROVIDER_KEY   PROVIDER_PHONE_EXT_WORK CITY_STATE_ZIP 
PROVIDER_CITY PROVIDER_ZIP PROVIDER_STATE PROVIDER_QUICK_CODE PERSON_AS_REPORTER_KEY;  RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

56        +
PROC SORT DATA=PROVPART_TABLE NODUPKEY; BY INVESTIGATION_KEY;RUN;

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.PROVPART_TABLE has 55 observations and 7 variables.
NOTE: Compressing data set WORK.PROVPART_TABLE decreased size by 77.78 percent. 
      Compressed is 2 pages; un-compressed would require 9 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

57        + DATA PROVIDER; MERGE PROVPART_TABLE PROVIDER; BY INVESTIGATION_KEY; RUN;

961                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 55 observations read from the data set WORK.PROVPART_TABLE.
NOTE: There were 55 observations read from the data set WORK.PROVIDER.
NOTE: The data set WORK.PROVIDER has 55 observations and 15 variables.
NOTE: Compressing data set WORK.PROVIDER decreased size by 89.29 percent. 
      Compressed is 3 pages; un-compressed would require 28 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4085      + PROC SQL;
4085      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
4086      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')
4087      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and 
(code_set_group_id >0  OR data_type in ( 'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
4088      + RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.METADATA_INIT created, with 74 rows and 5 columns.

4088      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

4088      +                        PROC SQL;
4088      +                                  CREATE TABLE METADATA_UNIT AS   SELECT  
INIT.DATAMART_NM, RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM, 
OTHER_VALUE_IND_CD FROM NBS_ODS.NBS_UI_METADATA  INNER JOIN
4089      + NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID = 
NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE
4090      + WHERE DATAMART_NM='TB_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and 
(code_set_group_id >0  OR data_type in ( 'Coded','CODED') ) AND
4091      + OTHER_VALUE_IND_CD='T' ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA_UNIT created, with 22 rows and 6 columns.

4091      +                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

4091      +                                                       DATA METADATA_UNIT; SET 
962                                         The SAS System             22:41 Saturday, January 6, 2024

METADATA_UNIT; LENGTH RDB_COLUMN_NM3 $22; LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  
RDB_COLUMN_NM2= TRIM(RDB_COLUMN_NM3) || '_OTH';  USER_DEFINED_COLUMN_NM =
4092      + TRIM(USER_DEFINED_COLUMN_NM)|| '_OTH';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP 
RDB_COLUMN_NM2 RDB_COLUMN_NM3; RUN;

NOTE: There were 22 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 22 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4092      +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: There were 22 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 22 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4092      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 22 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 74 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 96 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4092      +
  DATA     
4093      + METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
4094      + USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
4095      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
4096      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
963                                         The SAS System             22:41 Saturday, January 6, 2024

4097      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
4098      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
4099      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 96 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 96 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 97.92 percent. 
      Compressed is 2 pages; un-compressed would require 96 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4099      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 96 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 96 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 97.92 percent. 
      Compressed is 2 pages; un-compressed would require 96 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4099      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
4100      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 96 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 240 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4100      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4100:188   
NOTE: There were 240 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 240 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: DATA statement used (Total process time):
964                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.01 seconds
      cpu time            0.00 seconds
      

4100      +
PROC SQL;  
4100      +
 CREATE TABLE METADATA_OUT as select
4101      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: Table WORK.METADATA_OUT created, with 240 rows and 4 columns.

4101      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4101      +                                                                 PROC SQL;
4101      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

4101      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4101      +
PROC SQL;  
4101      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 97.92 percent. 
      Compressed is 2 pages; un-compressed would require 96 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 96 rows and 4 columns.

4101      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4101      +
PROC SQL;  
4101      +
  CREATE   
4102      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  UPCASE(METADATA_OUT1.RDB_COLUMN_NM) = 
965                                         The SAS System             22:41 Saturday, January 6, 2024

UPCASE(METADATA_OUT.RDB_COLUMN_NM);
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: Table WORK.METADATA_OUT created, with 240 rows and 5 columns.

4102      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

4102      +
DATA METADATA_OUT; SET
4103      + METADATA_OUT;   ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), 
comma20.);  DROP BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 240 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 240 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4103      +
PROC SQL;  
4103      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
4103      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

4103      +
  UPDATE   
4104      + STD_TESTER SET COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

4104      +                                                                            QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4104      +                                                                                   DATA 
_NULL_; SET STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF 
COUNTSTD<2 then call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

966                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4105      + PROC SQL;
4105      +             CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, 
RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 48 rows and 4 columns.

4105      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4105      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1
4106      +;  OUTPUT;       RUN;

NOTE: There were 48 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 49 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4106      +                        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 49 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 48 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4106      +                                                                                       ;   
                                                                                                      
                                                     DATA
4107      + DYNINVLISTING;                                                                            
                                                               SET D_INV_REPEAT_METADATA;
4108      +                                                           BY SORT_KEY;
4109      +                                                                                           
                         LENGTH RDB_COLUMN_NAME_LIST $15000;
4110      +                 RETAIN RDB_COLUMN_NAME_LIST;
967                                         The SAS System             22:41 Saturday, January 6, 2024

4111      +                                                                          LENGTH 
RDB_COLUMN_LIST $15000;                                                                               
                                               RETAIN RDB_COLUMN_LIST;
4112      +
4113      +                                LENGTH RDB_COLUMN_COMMA_LIST $15000;                       
                                                                                                 
RETAIN RDB_COLUMN_COMMA_LIST;
4114      +                                                                                           
                                                                                                      
                                                    IF
4115      + FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN                                          
                                                                     USER_DEFINED_COLUMN_NAME = 
COMPRESS( RDB_COLUMN_NM) || ' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM
4116      +)|| " '"||COMPRESS(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT 
MISSING(DATAMART_NM) THEN                                                                             
                                  RDB_COLUMN_NAME = COMPRESS(
4117      + RDB_COLUMN_NM);                                                                           
                                IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = 
(USER_DEFINED_COLUMN_NAME || ', ' || RDB_COLUMN_NAME_LIST);
4118      +                                                                                           
                                                                                      IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_LIST = (RDB_COLUMN_NAME || '
4119      + ' ||  RDB_COLUMN_LIST);                                                       IF 
(LENGTHN(RDB_COLUMN_NAME))>0 THEN  RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  
RDB_COLUMN_COMMA_LIST);                                          OUTPUT;     DROP
4120      + datamart_nm USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 48 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 48 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 89.58 percent. 
      Compressed is 5 pages; un-compressed would require 48 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4120      +
PROC SQL;  
4121      +                                                                                           
              DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 47 rows were deleted from WORK.DYNINVLISTING.

4122      +      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4122      +            DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');   CALL 
SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

968                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4122      +
DATA DYNINVLISTING; SET DYNINVLISTING;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX
4123      +('D_REPEAT_CASE_NAME', '');  CALL SYMPUTX('D_REPEAT_COMMA_NAME', '');  
LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));  RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  
IF (LENGTH>1)  THEN TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN
4124      +(RDB_COLUMN_NAME_LIST)-1);  CALL SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL 
SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);  CALL SYMPUTX('D_REPEAT_COMMA_NAME', 
RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4124      +
PROC SQL;  
4124      +
  CREATE TABLE REPEAT_BLOCK AS   SELECT
4125      + &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY, 
D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB .&FACT_CASE ON  
SUMM_DATAMART.INVESTIGATION_KEY
4126      +  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  NBS_RDB.D_INVESTIGATION_REPEAT ON  
&FACT_CASE .D_INVESTIGATION_REPEAT_KEY  =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1; ; QUIT;    PROC SQL;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 94.59 percent. 
      Compressed is 2 pages; un-compressed would require 37 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 37 rows and 52 columns.

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.03 seconds
      

4127      + DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

4127      +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4127      +                                                                               PROC SORT 
DATA=REPEAT_BLOCK ; BY INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;
969                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 37 observations and 52 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 94.59 percent. 
      Compressed is 2 pages; un-compressed would require 37 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4127      +
PROC TRANSPOSE DATA=REPEAT_BLOCK OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY
4128      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 1776 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.67 percent. 
      Compressed is 11 pages; un-compressed would require 254 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4128      +                                                         DATA REPEAT_BLOCK_OUT; set 
REPEAT_BLOCK_OUT; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 1776 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 1776 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 94.49 percent. 
      Compressed is 14 pages; un-compressed would require 254 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4128      +
PROC SQL;  
4128      +
 CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN
4129      + NBS_ODS.NBS_UI_METADATA   ON  NBS_RDB_METADATA.NBS_UI_METADATA_UID 
=NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE  BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND
4130      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Coded' ,'Text','text','TEXT','CODED') ) ORDER BY
4131      + RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 37 rows and 2 columns.

4131      +                          QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
970                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

4131      +                                PROC SQL;
4131      +                                          CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM, 
 RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID
4132      + WHERE BLOCK_NM IS NOT NULL  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND RDB_TABLE_NM
4133      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 'Coded' 
,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 37 rows and 2 columns.

4133      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

4133      +
PROC SQL;  
4133      +
 CREATE TABLE BLOCK_DATA_OTH AS SELECT BLOCK_NM,  RDB_COLUMN_NM FROM
4134      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
4135      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT' 
 and (code_set_group_id >0  OR data_type in ( 'Coded'
4136      + ,'Text','text','TEXT','CODED') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_OTH created, with 37 rows and 2 columns.

4136      +                                                                    QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.03 seconds
      

4136      +                                                                            DATA 
BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM $30; LENGTH RDB_COLUMN_NM2 $22; 
RDB_COLUMN_NM2= RDB_COLUMN_NM; RDB_COLUMN_NM=COMPRESS(RDB_COLUMN_NM2 || '_OTH'); DROP
4137      + RDB_COLUMN_NM2; RUN;

NOTE: There were 37 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 37 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
971                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

4137      +                       PROC SQL;
4137      +                                 CREATE TABLE BLOCK_DATA AS SELECT * FROM BLOCK_DATA_PL 
UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: Table WORK.BLOCK_DATA created, with 73 rows and 2 columns.

4137      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4137      +
PROC SQL;  
4137      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT
4138      + INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM =BLOCK_DATA.BLOCK_NM  AND 
UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 90.00 percent. 
      Compressed is 3 pages; un-compressed would require 30 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 204 rows and 7 columns.

4138      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4138      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT
4139      + BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4139      +                                         PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; 
BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;
972                                         The SAS System             22:41 Saturday, January 6, 2024


NOTE: There were 204 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 204 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 90.00 percent. 
      Compressed is 3 pages; un-compressed would require 30 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4139      +
DATA REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM
4140      + BLOCK_NM ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  FORMAT 
ANSWER_DESCCHECK $10.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;
4141      +  IF FIRST.RDB_COLUMN_NM  THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; 
ANSWER_DESC21 = '';  END;  I+1;  IF I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND 
LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN
4142      + ANSWER_DESC21 =  LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ 
'|| LEFT(TRIM(col1)) ;  END;  IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ col1 I J; RUN;

NOTE: There were 204 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 120 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 96.72 percent. 
      Compressed is 2 pages; un-compressed would require 61 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4142      +
DATA REPEAT_BLOCK_OUT_BASE ; SET
4143      + REPEAT_BLOCK_OUT_BASE ; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 204 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 204 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 90.00 percent. 
      Compressed is 3 pages; un-compressed would require 30 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4143      +                                                       DATA REPEAT_BLOCK_OUT_BASE; SET 
REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN
4144      + COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 
THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 
=' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF
4145      + ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
973                                         The SAS System             22:41 Saturday, January 6, 2024

4146      + 4 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF
4147      + ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: There were 204 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 204 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 95.59 percent. 
      Compressed is 3 pages; un-compressed would require 68 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4147      +                                                   PROC SQL;
4147      +                                                             CREATE TABLE METADATA_OUT as 
select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.75 percent. 
      Compressed is 3 pages; un-compressed would require 240 pages.
NOTE: Table WORK.METADATA_OUT created, with 240 rows and 5 columns.

4147      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4147      +
PROC SQL;  
4147      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM
4148      + METADATA_OUT LEFT OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  
= UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR 
=REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM =
4149      + REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.61 percent. 
      Compressed is 5 pages; un-compressed would require 361 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 361 rows and 12 columns.

4149      +                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.06 seconds
      cpu time            0.07 seconds
      

4149      +                                           PROC SORT DATA=METADATA_MERGED_INIT ; BY 
974                                         The SAS System             22:41 Saturday, January 6, 2024

INVESTIGATION_KEY;RUN;

NOTE: There were 361 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 361 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.61 percent. 
      Compressed is 5 pages; un-compressed would require 361 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4149      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_VARCHAR;  VAR DATA_VALUE;  ID COL1; 
    BY INVESTIGATION_KEY; RUN;

WARNING: 88 observations omitted due to missing ID values.
NOTE: There were 361 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 21 observations and 154 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4149      +
  DATA     
4150      + INVESTIGATION_REPEAT_VARCHAR; SET INVESTIGATION_REPEAT_VARCHAR; DROP _NAME_; RUN;

NOTE: There were 21 observations read from the data set WORK.INVESTIGATION_REPEAT_VARCHAR.
NOTE: The data set WORK.INVESTIGATION_REPEAT_VARCHAR has 21 observations and 153 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_VARCHAR decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4150      +                                                                                      PROC 
SQL;
4150      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM 
D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.REPEAT_ALL created, with 48 rows and 2 columns.

4150      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

975                                         The SAS System             22:41 Saturday, January 6, 2024

4150      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH
4151      + USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = 
COMPRESS(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 48 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 48 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 84.62 percent. 
      Compressed is 2 pages; un-compressed would require 13 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4151      +
PROC SQL;  
4151      +
 CREATE TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*,
4152      + REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_ALL  ON UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = 
UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 97.87 percent. 
      Compressed is 3 pages; un-compressed would require 141 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 141 rows and 7 columns.

4152      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4152      +
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 141 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 141 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 97.87 percent. 
      Compressed is 3 pages; un-compressed would require 141 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4153      + PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_VARCHAR_ALL;  VAR 
ANSWER_DESC21;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 141 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 21 observations and 50 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
976                                         The SAS System             22:41 Saturday, January 6, 2024

      

4153      +
DATA REPEAT_BLOCK_VARCHAR_ALL; SET REPEAT_BLOCK_VARCHAR_ALL; DROP _NAME_; RUN;

NOTE: There were 21 observations read from the data set WORK.REPEAT_BLOCK_VARCHAR_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_VARCHAR_ALL has 21 observations and 49 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_VARCHAR_ALL decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4154      + PROC SQL;
4154      +           CREATE TABLE METADATA AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON NBS_UI_METADATA.NBS_UI_METADATA_UID =
4155      + NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN NBS_RDB.INIT  ON 
NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD =(SELECT FORM_CD 
FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND
4156      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
IS NOT NULL AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and data_type in ( 'DATETIME','DATE', 
'Date','Date/Time')  and code_set_group_id is null ORDER BY
4157      + RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.METADATA created, with 16 rows and 5 columns.

4157      +                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.12 seconds
      cpu time            0.04 seconds
      

4157      +                        DATA METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 
$15000;  LENGTH USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000
4158      +;  USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
4159      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
THEN
4160      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
4161      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
4162      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
977                                         The SAS System             22:41 Saturday, January 6, 2024

4163      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 16 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 16 observations and 10 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 87.50 percent. 
      Compressed is 2 pages; un-compressed would require 16 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4163      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 16 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 16 observations and 10 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 87.50 percent. 
      Compressed is 2 pages; un-compressed would require 16 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4163      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
4164      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 16 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 40 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4164      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4164:187   
NOTE: There were 40 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 40 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4164      +
PROC SQL;  
978                                         The SAS System             22:41 Saturday, January 6, 2024

4164      +
 CREATE TABLE METADATA_OUT as select
4165      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: Table WORK.METADATA_OUT created, with 40 rows and 4 columns.

4165      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4165      +                                                                PROC SQL;
4165      +                                                                           DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

4165      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4165      +
PROC SQL;  
4165      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 87.50 percent. 
      Compressed is 2 pages; un-compressed would require 16 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 16 rows and 4 columns.

4165      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4165      +
PROC SQL;  
4165      +
  CREATE TABLE
4166      + METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1  FROM 
METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: Table WORK.METADATA_OUT created, with 40 rows and 5 columns.

979                                         The SAS System             22:41 Saturday, January 6, 2024

4166      +
 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4166      +
DATA METADATA_OUT; SET METADATA_OUT;
4167      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 40 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 40 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4167      +
PROC SQL;  
4167      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
4167      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

4167      +
  UPDATE STD_TESTER SET
4168      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

4168      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4168      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4168      +
980                                         The SAS System             22:41 Saturday, January 6, 2024

PROC SQL;  
4168      +
  CREATE   
4169      + TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 8 rows and 4 columns.

4169      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4169      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
4170      + RUN;

NOTE: There were 8 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 9 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4170      +        PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 9 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 8 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4170      +                                                                       ;
4170      +
DATA DYNINVLISTING;
4171      +                                                                                           
                                          SET D_INV_REPEAT_METADATA;
4172      +                                      BY SORT_KEY;
4173      +                                                                                           
    LENGTH RDB_COLUMN_NAME_LIST $15000;
4174      + RETAIN RDB_COLUMN_NAME_LIST;
4175      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
981                                         The SAS System             22:41 Saturday, January 6, 2024

4176      +
4177      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
4178      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
4179      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
4180      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
4181      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
4182      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
4183      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
4184      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 8 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 8 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4184      +
PROC SQL;  
4185      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 7 rows were deleted from WORK.DYNINVLISTING.

4185      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4186      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
982                                         The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

4186      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
4187      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4187      +                                  DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
4188      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
4189      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4189      +                                                                     PROC SQL;
4189      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
4190      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
4191      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 37 rows and 12 columns.

4191      +
 ; QUIT;   
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.00 seconds
      

4191      +
PROC SQL;  
4191      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
983                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

4191      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4191      +
PROC SORT DATA=REPEAT_BLOCK ; BY
4192      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 37 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4192      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;

NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 296 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 0.00 percent. 
      Compressed is 5 pages; un-compressed would require 5 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4192      +
DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;
4193      + RDB_COLUMN_NM = _NAME_; coloumnText=ANSWER_TXT;  rename col1=dateColumn; RUN;

NOTE: Variable ANSWER_TXT is uninitialized.
NOTE: There were 296 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 296 observations and 9 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 14.29 percent. 
      Compressed is 6 pages; un-compressed would require 7 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4193      +                                                                                PROC SQL;
4193      +                                                                                          
CREATE TABLE BLOCK_DATA AS SELECT BLOCK_NM,  RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN 
NBS_ODS.NBS_UI_METADATA   ON
4194      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE  
984                                         The SAS System             22:41 Saturday, January 6, 2024

RDB_TABLE_NM='D_INVESTIGATION_REPEAT'  AND NBS_UI_METADATA.INVESTIGATION_FORM_CD=(SELECT FORM_CD FROM 
NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')  AND PART_TYPE_CD IS
4195      + NULL  AND QUESTION_GROUP_SEQ_NBR IS NOT NULL   AND 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL 
 AND NBS_RDB_METADATA.BLOCK_PIVOT_NBR IS NOT NULL  and data_type in ( 'DATETIME','DATE',
4196      + 'Date','Date/Time') and code_set_group_id is null   ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA created, with 8 rows and 2 columns.

4196      +                                                                                       
QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.06 seconds
      

4196      +
PROC SQL;  
4196      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA 
  ON  REPEAT_BLOCK_OUT.BLOCK_NM
4197      + =BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= 
UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 42 rows and 9 columns.

4197      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4197      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE   BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4197      +
PROC SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY
4198      + INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 42 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
985                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 42 observations and 9 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4198      +                                                                      DATA 
REPEAT_BLOCK_OUT_ALL; SET REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR;    FORMAT ANSWER_DESCCHECK $10.;  FORMAT
4199      + ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;    ARRAY ANSWER_DESC(20) 
ANSWER_DESC1-ANSWER_DESC20;  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM  
THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = '';    END;   I = 0;
4200      + ANSWER_DESC21 = '';    ANSWER_DESCCHECK='';  END;  I+1;  X=LENGTHN(ANSWER_DESC21);  IF I 
<= 20 THEN DO;   TEXTDATE =  PUT(dateColumn, yymmddd10.);          ANSWER_DESC(I) = TEXTDATE;   IF 
LENGTHN(TEXTDATE)< 5 THEN TEXTDATE='';   IF LENGTHN(TEXTDATE)>4
4201      + AND LENGTHN(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN 
ANSWER_DESC21 =  LEFT(TRIM(TEXTDATE));   ELSE ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))|| ' ~ '|| 
LEFT(TRIM(TEXTDATE));  END;   IF LAST.RDB_COLUMN_NM THEN OUTPUT;   IF  LENGTHN
4202      +(COMPRESS(ANSWER_DESCCHECK))<3 THEN ANSWER_DESC21='';  DROP ANSWER_DESC1-ANSWER_DESC20  
_NAME_ _LABEL_ ANSWER_DESCCHECK I J; RUN;

NOTE: There were 42 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 18 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 80.00 percent. 
      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4202      +
DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE ; DATA_VALUE=dateColumn; RDB_COLUMN_NM = 
_NAME_; RUN;

NOTE: There were 42 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 42 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4202      +
  DATA     
4203      + REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF
4204      + ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
4205      + 3 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR 
986                                         The SAS System             22:41 Saturday, January 6, 2024

= 3 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN 
COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF
4206      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL4 =' ';    RUN;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      4204:38    4204:223   4205:154   4206:85    
NOTE: There were 42 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 42 observations and 15 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4206      +
PROC SQL;  
4206      +
 CREATE    
4207      + TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR 
FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 95.00 percent. 
      Compressed is 2 pages; un-compressed would require 40 pages.
NOTE: Table WORK.METADATA_OUT created, with 40 rows and 5 columns.

4207      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4207      +
PROC SQL;  
4207      +
 CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT OUTER JOIN 
REPEAT_BLOCK_OUT_BASE ON UPCASE
4208      +(METADATA_OUT.RDB_COLUMN_NM)  = UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND 
METADATA_OUT.ANSWER_GROUP_SEQ_NBR =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND 
METADATA_OUT.BLOCK_NM = REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable col1 already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 96.67 percent. 
      Compressed is 2 pages; un-compressed would require 60 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 60 rows and 15 columns.

4208      +
987                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

4208      +
PROC SORT  
4209      + DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: There were 60 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 60 observations and 15 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 96.67 percent. 
      Compressed is 2 pages; un-compressed would require 60 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4209      +                                                        PROC TRANSPOSE 
DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_DATE;  VAR dateColumn;  ID COL1;     BY 
INVESTIGATION_KEY; RUN;

WARNING: 16 observations omitted due to missing ID values.
NOTE: There were 60 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 10 observations and 26 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4209      +
DATA INVESTIGATION_REPEAT_DATE; SET INVESTIGATION_REPEAT_DATE; DROP
4210      + _NAME_; RUN;

NOTE: There were 10 observations read from the data set WORK.INVESTIGATION_REPEAT_DATE.
NOTE: The data set WORK.INVESTIGATION_REPEAT_DATE has 10 observations and 25 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_DATE increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4210      +                 PROC SQL;
4210      +                           CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM  FROM D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 8 rows and 2 columns.

4210      +
988                                         The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4210      +
DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL 
= COMPRESS
4211      +(USER_DEFINED_COLUMN_NM || '_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 8 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 8 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 33.33 percent. 
      Compressed is 2 pages; un-compressed would require 3 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4211      +                                                                       PROC SQL;
4211      +                                                                                 CREATE 
TABLE REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON UPCASE
4212      +(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 20 rows and 11 columns.

4212      +                                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4212      +                                                                                  PROC 
SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 20 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 20 observations and 11 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4212      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_DATE_ALL;  VAR ANSWER_DESC21;  ID
4213      + USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 20 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 10 observations and 10 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL decreased size by 80.00 percent. 
989                                         The SAS System             22:41 Saturday, January 6, 2024

      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4213      +                                                              DATA REPEAT_BLOCK_DATE_ALL; 
SET REPEAT_BLOCK_DATE_ALL; DROP _NAME_; RUN;

NOTE: There were 10 observations read from the data set WORK.REPEAT_BLOCK_DATE_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_DATE_ALL has 10 observations and 9 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_DATE_ALL decreased size by 80.00 percent. 
      Compressed is 2 pages; un-compressed would require 10 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4214      + PROC SQL;
4214      +           CREATE TABLE METADATA_INIT AS   SELECT  INIT.DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR, BLOCK_NM FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
4215      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')
4216      + AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM 
NE '' and NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL and (code_set_group_id >0  OR data_type 
in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM;
NOTE: Compressing data set WORK.METADATA_INIT decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.METADATA_INIT created, with 58 rows and 5 columns.

4216      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.04 seconds
      

4216      +
  PROC     
4217      + SQL;
4217      +      CREATE TABLE METADATA_UNIT AS   SELECT  INIT.DATAMART_NM,RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM, NBS_RDB_METADATA.BLOCK_PIVOT_NBR,BLOCK_NM, MASK FROM NBS_ODS.NBS_UI_METADATA  
INNER JOIN NBS_ODS.NBS_RDB_METADATA   ON
4218      + NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID INNER JOIN 
NBS_RDB.INIT  ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT.FORM_CD WHERE INVESTIGATION_FORM_CD 
=(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI')
4219      + AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND UNIT_TYPE_CD='CODED' AND RDB_TABLE_NM 
='D_INVESTIGATION_REPEAT'  AND DATA_TYPE IN ('Numeric','NUMERIC') AND CODE_SET_GROUP_ID IS NULL AND 
MASK
4220      + IS NOT NULL   ORDER BY RDB_COLUMN_NM;
NOTE: Table WORK.METADATA_UNIT created, with 0 rows and 6 columns.
990                                         The SAS System             22:41 Saturday, January 6, 2024


4220      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.14 seconds
      cpu time            0.03 seconds
      

4220      +                                              DATA METADATA_UNIT; SET METADATA_UNIT; 
LENGTH RDB_COLUMN_NM3 $21; LENGTH RDB_COLUMN_NM2 $30;  RDB_COLUMN_NM3=RDB_COLUMN_NM;  RDB_COLUMN_NM2= 
TRIM(RDB_COLUMN_NM3) || '_UNIT';  USER_DEFINED_COLUMN_NM = TRIM
4221      +(USER_DEFINED_COLUMN_NM)|| '_UNIT';  RDB_COLUMN_NM= RDB_COLUMN_NM2; DROP RDB_COLUMN_NM2 
RDB_COLUMN_NM3; RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4221      +
PROC SORT DATA=METADATA_UNIT; BY RDB_COLUMN_NM;RUN;

NOTE: Input data set is empty.
NOTE: The data set WORK.METADATA_UNIT has 0 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4221      +
DATA METADATA;    MERGE METADATA_UNIT METADATA_INIT;    BY RDB_COLUMN_NM;  RUN;

NOTE: There were 0 observations read from the data set WORK.METADATA_UNIT.
NOTE: There were 58 observations read from the data set WORK.METADATA_INIT.
NOTE: The data set WORK.METADATA has 58 observations and 6 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4221      +
  DATA     
4222      + METADATA; SET METADATA; LENGTH USER_DEFINED_COLUMN_NM_1 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_2 $15000;  LENGTH USER_DEFINED_COLUMN_NM_3 $15000;  LENGTH 
USER_DEFINED_COLUMN_NM_4 $15000;  LENGTH USER_DEFINED_COLUMN_NM_5 $15000;
4223      + USER_DEFINED_COLUMN_NM_1=COMPRESS(USER_DEFINED_COLUMN_NM|| '_1'); 
USER_DEFINED_COLUMN_NM_2=COMPRESS(USER_DEFINED_COLUMN_NM|| '_2'); 
USER_DEFINED_COLUMN_NM_3=COMPRESS(USER_DEFINED_COLUMN_NM|| '_3'); USER_DEFINED_COLUMN_NM_4=COMPRESS
4224      +(USER_DEFINED_COLUMN_NM|| '_4'); 
USER_DEFINED_COLUMN_NM_5=COMPRESS(USER_DEFINED_COLUMN_NM|| '_5');  IF BLOCK_PIVOT_NBR=. THEN 
BLOCK_PIVOT_NBR=1;  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_1 = ''; IF BLOCK_PIVOT_NBR = 0 
991                                         The SAS System             22:41 Saturday, January 6, 2024

THEN
4225      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 0 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 0 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 1 THEN
4226      + USER_DEFINED_COLUMN_NM_2 = '';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_3 = 
'';  IF BLOCK_PIVOT_NBR = 1 THEN USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 1 THEN 
USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 2 THEN
4227      + USER_DEFINED_COLUMN_NM_3 = '';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_4 = 
'';  IF BLOCK_PIVOT_NBR = 2 THEN USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 3 THEN 
USER_DEFINED_COLUMN_NM_4 = '';  IF BLOCK_PIVOT_NBR = 3 THEN
4228      + USER_DEFINED_COLUMN_NM_5 = '';   IF BLOCK_PIVOT_NBR = 4 THEN USER_DEFINED_COLUMN_NM_5 = 
'';   RUN;

NOTE: There were 58 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 58 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 96.55 percent. 
      Compressed is 2 pages; un-compressed would require 58 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4228      +
PROC SORT DATA=METADATA ; BY RDB_COLUMN_NM;RUN;

NOTE: There were 58 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA has 58 observations and 11 variables.
NOTE: Compressing data set WORK.METADATA decreased size by 96.55 percent. 
      Compressed is 2 pages; un-compressed would require 58 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4228      +
PROC TRANSPOSE DATA=METADATA OUT=METADATA_OUT;  VAR USER_DEFINED_COLUMN_NM_1 USER_DEFINED_COLUMN_NM_2
4229      + USER_DEFINED_COLUMN_NM_3 USER_DEFINED_COLUMN_NM_4  USER_DEFINED_COLUMN_NM_5; COPY  
BLOCK_NM;     BY RDB_COLUMN_NM; RUN;

NOTE: There were 58 observations read from the data set WORK.METADATA.
NOTE: The data set WORK.METADATA_OUT has 145 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.62 percent. 
      Compressed is 2 pages; un-compressed would require 145 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4229      +
DATA METADATA_OUT; SET METADATA_OUT; IF MISSING(COL1) THEN COL1=.; RUN;

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      4229:187   
NOTE: There were 145 observations read from the data set WORK.METADATA_OUT.
992                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: The data set WORK.METADATA_OUT has 145 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 98.62 percent. 
      Compressed is 2 pages; un-compressed would require 145 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4229      +
PROC SQL;  
4229      +
 CREATE TABLE METADATA_OUT as select
4230      + RDB_COLUMN_NM,BLOCK_NM, _NAME_, COL1 FROM METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 97.93 percent. 
      Compressed is 3 pages; un-compressed would require 145 pages.
NOTE: Table WORK.METADATA_OUT created, with 145 rows and 4 columns.

4230      +                                                         QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4230      +                                                                 PROC SQL;
4230      +                                                                            DELETE * FROM 
METADATA_OUT WHERE COL1 IS NULL;
NOTE: No rows were deleted from WORK.METADATA_OUT.

4230      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4230      +
PROC SQL;  
4230      +
 CREATE TABLE METADATA_OUT1 AS SELECT * FROM METADATA_OUT WHERE BLOCK_NM IS NOT NULL;
NOTE: Compressing data set WORK.METADATA_OUT1 decreased size by 96.55 percent. 
      Compressed is 2 pages; un-compressed would require 58 pages.
NOTE: Table WORK.METADATA_OUT1 created, with 58 rows and 4 columns.

4230      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4230      +
PROC SQL;  
993                                         The SAS System             22:41 Saturday, January 6, 2024

4230      +
  CREATE
4231      + TABLE METADATA_OUT AS SELECT DISTINCT METADATA_OUT.*, METADATA_OUT1.BLOCK_NM AS BLOCK_NM1 
 FROM METADATA_OUT INNER JOIN METADATA_OUT1 ON  METADATA_OUT1.RDB_COLUMN_NM = 
METADATA_OUT.RDB_COLUMN_NM;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 97.93 percent. 
      Compressed is 3 pages; un-compressed would require 145 pages.
NOTE: Table WORK.METADATA_OUT created, with 145 rows and 5 columns.

4231      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

4231      +
DATA METADATA_OUT; SET METADATA_OUT;
4232      + ANSWER_GROUP_SEQ_NBR = INPUT(substrn(COL1,max(1,length(COL1)),1), comma20.);  DROP 
BLOCK_NM;  RENAME BLOCK_NM1 = BLOCK_NM; RUN;

NOTE: There were 145 observations read from the data set WORK.METADATA_OUT.
NOTE: The data set WORK.METADATA_OUT has 145 observations and 5 variables.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 97.93 percent. 
      Compressed is 3 pages; un-compressed would require 145 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4232      +
PROC SQL;  
4232      +
   CREATE TABLE STD_TESTER(COUNTSTD NUM);
NOTE: Compression was disabled for data set WORK.STD_TESTER because compression overhead would 
      increase the size of the data set.
NOTE: Table WORK.STD_TESTER created, with 0 rows and 1 columns.
4232      +
  INSERT INTO STD_TESTER( COUNTSTD) VALUES(NULL);
NOTE: 1 row was inserted into WORK.STD_TESTER.

4232      +
  UPDATE STD_TESTER SET
4233      + COUNTSTD= (select  count(*) from CASE_MANAGEMENT_METADATA);
NOTE: 1 row was updated in WORK.STD_TESTER.

4233      +                                                             QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

994                                         The SAS System             22:41 Saturday, January 6, 2024

4233      +                                                                    DATA _NULL_; SET 
STD_TESTER;    IF COUNTSTD>1 then call symputx('FACT_CASE', 'F_STD_PAGE_CASE');    IF COUNTSTD<2 then 
call symputx('FACT_CASE', 'F_PAGE_CASE');    RUN;

NOTE: There were 1 observations read from the data set WORK.STD_TESTER.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4233      +
PROC SQL;  
4234      + CREATE TABLE D_INV_REPEAT_METADATA AS SELECT DISTINCT DATAMART_NM, RDB_COLUMN_NM, 
USER_DEFINED_COLUMN_NM,BLOCK_PIVOT_NBR  FROM METADATA;
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.D_INV_REPEAT_METADATA created, with 29 rows and 4 columns.

4234      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4234      +
DATA D_INV_REPEAT_METADATA;   IF SORT_KEY=1 THEN OUTPUT;   SET D_INV_REPEAT_METADATA;    SORT_KEY+1;  
OUTPUT;
4235      +     RUN;

NOTE: There were 29 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 30 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4235      +            PROC SORT DATA=D_INV_REPEAT_METADATA NODUPKEY; BY SORT_KEY;RUN;

NOTE: There were 30 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.D_INV_REPEAT_METADATA has 29 observations and 5 variables.
NOTE: Compressing data set WORK.D_INV_REPEAT_METADATA increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4235      +                                                                           ;
4235      +
DATA DYNINVLISTING;
995                                         The SAS System             22:41 Saturday, January 6, 2024

4236      +                                                                                           
                                              SET D_INV_REPEAT_METADATA;
4237      +                                          BY SORT_KEY;
4238      +                                                                                           
        LENGTH RDB_COLUMN_NAME_LIST $15000;
4239      + RETAIN RDB_COLUMN_NAME_LIST;
4240      +                                                          LENGTH RDB_COLUMN_LIST $15000;   
                                                                                                      
                     RETAIN RDB_COLUMN_LIST;
4241      +
4242      +                LENGTH RDB_COLUMN_COMMA_LIST $15000;                                       
                                                                                 RETAIN 
RDB_COLUMN_COMMA_LIST;
4243      +                                                                                           
                                                                                                      
                                    IF FIRST.SORT_KEY AND NOT
4244      + MISSING(DATAMART_NM) THEN                                                                 
                                              USER_DEFINED_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM) || 
' AS ' ||COMPRESS(USER_DEFINED_COLUMN_NM)|| " '"||COMPRESS
4245      +(USER_DEFINED_COLUMN_NM)||"'";       IF FIRST.SORT_KEY AND NOT MISSING(DATAMART_NM) THEN   
                                                                                                      
      RDB_COLUMN_NAME = COMPRESS( RDB_COLUMN_NM);
4246      +                                                                                           
   IF (LENGTHN(USER_DEFINED_COLUMN_NAME))>0 THEN  RDB_COLUMN_NAME_LIST = (USER_DEFINED_COLUMN_NAME || 
', ' || RDB_COLUMN_NAME_LIST);
4247      +                                                                                           
                                                            IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_LIST = (RDB_COLUMN_NAME || ' ' ||  RDB_COLUMN_LIST);
4248      +                                                    IF (LENGTHN(RDB_COLUMN_NAME))>0 THEN  
RDB_COLUMN_COMMA_LIST = (RDB_COLUMN_NAME || ', ' ||  RDB_COLUMN_COMMA_LIST);                          
                OUTPUT;     DROP datamart_nm
4249      + USER_DEFINED_COLUMN_NAME form_cd;  RUN;

WARNING: The variable form_cd in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 29 observations read from the data set WORK.D_INV_REPEAT_METADATA.
NOTE: The data set WORK.DYNINVLISTING has 29 observations and 8 variables.
NOTE: Compressing data set WORK.DYNINVLISTING decreased size by 89.66 percent. 
      Compressed is 3 pages; un-compressed would require 29 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4249      +
PROC SQL;  
4250      +                                                                                           
   DELETE FROM DYNINVLISTING WHERE SORT_KEY <(SELECT MAX (SORT_KEY) FROM DYNINVLISTING);
WARNING: This DELETE/INSERT statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: 28 rows were deleted from WORK.DYNINVLISTING.

4250      +
                                                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
996                                         The SAS System             22:41 Saturday, January 6, 2024

      real time           0.00 seconds
      cpu time            0.00 seconds
      

4251      + DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', ''); 
 CALL SYMPUTX('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4251      +
DATA _NULL_;  CALL SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX
4252      +('D_REPEAT_COMMA_NAME', ''); RUN;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4252      +                                   DATA DYNINVLISTING; SET DYNINVLISTING;  CALL 
SYMPUTX('D_REPEAT_CASE', '');  CALL SYMPUTX('D_REPEAT_CASE_NAME', '');  CALL 
SYMPUTX('D_REPEAT_COMMA_NAME', '');  LENGTH=LENGTHN(COMPRESS(RDB_COLUMN_NAME_LIST));
4253      + RDB_COLUMN_NAME_LIST = TRIM(RDB_COLUMN_NAME_LIST);  IF (LENGTH>1)  THEN 
TRIMMED_VALUE=SUBSTR((RDB_COLUMN_NAME_LIST), 1, LENGTHN(RDB_COLUMN_NAME_LIST)-1);  CALL 
SYMPUTX('D_REPEAT_CASE', TRIMMED_VALUE);  CALL SYMPUTX('D_REPEAT_CASE_NAME', RDB_COLUMN_LIST);
4254      +  CALL SYMPUTX('D_REPEAT_COMMA_NAME', RDB_COLUMN_COMMA_LIST);   RUN;

NOTE: There were 1 observations read from the data set WORK.DYNINVLISTING.
NOTE: The data set WORK.DYNINVLISTING has 1 observations and 10 variables.
NOTE: Compressing data set WORK.DYNINVLISTING increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4254      +                                                                     PROC SQL;
4254      +                                                                                CREATE 
TABLE REPEAT_BLOCK AS   SELECT  &D_REPEAT_COMMA_NAME ANSWER_GROUP_SEQ_NBR, 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY, SUMM_DATAMART.INVESTIGATION_KEY,
4255      + D_INVESTIGATION_REPEAT.BLOCK_NM FROM NBS_RDB.SUMM_DATAMART  INNER JOIN  NBS_RDB 
.&FACT_CASE ON  SUMM_DATAMART.INVESTIGATION_KEY  =&FACT_CASE .INVESTIGATION_KEY  INNER JOIN  
NBS_RDB.D_INVESTIGATION_REPEAT ON  &FACT_CASE .D_INVESTIGATION_REPEAT_KEY
4256      + =D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY WHERE 
D_INVESTIGATION_REPEAT.D_INVESTIGATION_REPEAT_KEY>1;
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 94.59 percent. 
      Compressed is 2 pages; un-compressed would require 37 pages.
NOTE: Table WORK.REPEAT_BLOCK created, with 37 rows and 33 columns.

4256      +
 ; QUIT;   
997                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.18 seconds
      cpu time            0.04 seconds
      

4256      +
PROC SQL;  
4256      +
 DELETE FROM REPEAT_BLOCK WHERE (SELECT COUNT(*) FROM DYNINVLISTING) =0;
NOTE: No rows were deleted from WORK.REPEAT_BLOCK.

4256      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4256      +
PROC SORT DATA=REPEAT_BLOCK ; BY
4257      + INVESTIGATION_KEY BLOCK_NM ANSWER_GROUP_SEQ_NBR;RUN;

NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK has 37 observations and 33 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK decreased size by 94.59 percent. 
      Compressed is 2 pages; un-compressed would require 37 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4257      +                                                       PROC TRANSPOSE DATA=REPEAT_BLOCK 
OUT=REPEAT_BLOCK_OUT;  VAR &D_REPEAT_CASE_NAME;     BY INVESTIGATION_KEY BLOCK_NM 
ANSWER_GROUP_SEQ_NBR; RUN;   DATA REPEAT_BLOCK_OUT; set REPEAT_BLOCK_OUT;

NOTE: There were 37 observations read from the data set WORK.REPEAT_BLOCK.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 1073 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 95.45 percent. 
      Compressed is 7 pages; un-compressed would require 154 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4258      + RDB_COLUMN_NM = _NAME_; run;

NOTE: There were 1073 observations read from the data set WORK.REPEAT_BLOCK_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_OUT has 1073 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT decreased size by 94.16 percent. 
      Compressed is 9 pages; un-compressed would require 154 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
998                                         The SAS System             22:41 Saturday, January 6, 2024


4258      +                               PROC SQL;
4258      +                                         CREATE TABLE BLOCK_DATA_PL AS SELECT BLOCK_NM,  
RDB_COLUMN_NM  FROM NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID WHERE
4259      + BLOCK_NM IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE 
WHERE DATAMART_NM='TB_LTBI') AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and 
NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND RDB_TABLE_NM
4260      + ='D_INVESTIGATION_REPEAT'  and (code_set_group_id >0  OR data_type in ( 
'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_PL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_PL created, with 29 rows and 2 columns.

4260      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.06 seconds
      

4260      +
PROC SQL;  
4260      +
 CREATE TABLE BLOCK_DATA_UNIT AS SELECT BLOCK_NM,  COMPRESS(RDB_COLUMN_NM || '_UNIT') AS 
RDB_COLUMN_NM FROM
4261      + NBS_ODS.NBS_RDB_METADATA INNER JOIN NBS_ODS.NBS_UI_METADATA   ON  
NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM IS NOT NULL 
 AND NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM NE '' and
4262      + NBS_RDB_METADATA.USER_DEFINED_COLUMN_NM IS NOT NULL AND INVESTIGATION_FORM_CD =(SELECT 
FORM_CD FROM NBS_RDB.NBS_PAGE WHERE DATAMART_NM='TB_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT' 
 and (code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC'
4263      +) ) ORDER BY RDB_COLUMN_NM, BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_UNIT increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.BLOCK_DATA_UNIT created, with 29 rows and 2 columns.

4263      +                                      QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.04 seconds
      

4263      +                                               PROC SQL;
4263      +                                                         CREATE TABLE BLOCK_DATA_OTH AS 
SELECT BLOCK_NM,  TRIM(RDB_COLUMN_NM || '_OTH') AS RDB_COLUMN_NM FROM NBS_ODS.NBS_RDB_METADATA INNER 
JOIN NBS_ODS.NBS_UI_METADATA   ON
4264      + NBS_RDB_METADATA.NBS_UI_METADATA_UID =NBS_UI_METADATA.NBS_UI_METADATA_UID  WHERE BLOCK_NM 
IS NOT NULL  AND INVESTIGATION_FORM_CD =(SELECT FORM_CD FROM NBS_RDB.NBS_PAGE WHERE 
DATAMART_NM='TB_LTBI') AND RDB_TABLE_NM ='D_INVESTIGATION_REPEAT'  and
4265      +(code_set_group_id >0  OR data_type in ( 'Numeric','NUMERIC') ) ORDER BY RDB_COLUMN_NM, 
BLOCK_NM;
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
999                                         The SAS System             22:41 Saturday, January 6, 2024

NOTE: Table WORK.BLOCK_DATA_OTH created, with 29 rows and 2 columns.

4265      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.04 seconds
      

4265      +
DATA BLOCK_DATA_OTH; SET BLOCK_DATA_OTH; LENGTH RDB_COLUMN_NM2 $22; LENGTH RDB_COLUMN_NM $30; 
RDB_COLUMN_NM2=RDB_COLUMN_NM; RDB_COLUMN_NM = COMPRESS
WARNING: Length of character variable RDB_COLUMN_NM has already been set. 
         Use the LENGTH statement as the very first statement in the DATA STEP to declare the length 
         of a character variable.
4266      +(RDB_COLUMN_NM2|| '_OTH'); DROP RDB_COLUMN_NM2; RUN;

NOTE: There were 29 observations read from the data set WORK.BLOCK_DATA_OTH.
NOTE: The data set WORK.BLOCK_DATA_OTH has 29 observations and 2 variables.
NOTE: Compressing data set WORK.BLOCK_DATA_OTH increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4266      +                                                       PROC SQL;
4266      +                                                                 CREATE TABLE BLOCK_DATA 
AS SELECT * FROM BLOCK_DATA_PL  UNION SELECT * FROM BLOCK_DATA_UNIT UNION SELECT * FROM 
BLOCK_DATA_OTH;
NOTE: Compressing data set WORK.BLOCK_DATA increased size by 50.00 percent. 
      Compressed is 3 pages; un-compressed would require 2 pages.
NOTE: Table WORK.BLOCK_DATA created, with 87 rows and 2 columns.

4266      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4266      +
PROC SQL;  
4266      +
 CREATE TABLE REPEAT_BLOCK_OUT_BASE AS SELECT
4267      + DISTINCT * FROM REPEAT_BLOCK_OUT  INNER JOIN BLOCK_DATA   ON  REPEAT_BLOCK_OUT.BLOCK_NM 
=BLOCK_DATA.BLOCK_NM  AND UPCASE(REPEAT_BLOCK_OUT.RDB_COLUMN_NM)= UPCASE(BLOCK_DATA.RDB_COLUMN_NM);
WARNING: Variable block_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
WARNING: Variable rdb_column_nm already exists on file WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 88.24 percent. 
      Compressed is 2 pages; un-compressed would require 17 pages.
NOTE: Table WORK.REPEAT_BLOCK_OUT_BASE created, with 116 rows and 7 columns.

4267      +
1000                                        The SAS System             22:41 Saturday, January 6, 2024

 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4267      +
PROC DATASETS LIBRARY = WORK NOLIST;  DELETE
4268      + BLOCK_DATA_OTH BLOCK_DATA_PL BLOCK_DATA_UNIT BLOCK_DATA REPEAT_BLOCK_OUT RUN; QUIT;

NOTE: The file WORK.RUN (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: Deleting WORK.BLOCK_DATA_OTH (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_PL (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA_UNIT (memtype=DATA).
NOTE: Deleting WORK.BLOCK_DATA (memtype=DATA).
NOTE: Deleting WORK.REPEAT_BLOCK_OUT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4268      +                                                                                      PROC 
SORT DATA=REPEAT_BLOCK_OUT_BASE NODUPKEY ; BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM 
ANSWER_GROUP_SEQ_NBR ;RUN;

NOTE: There were 116 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 116 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 88.24 percent. 
      Compressed is 2 pages; un-compressed would require 17 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4268      +
DATA REPEAT_BLOCK_OUT_ALL; SET
4269      + REPEAT_BLOCK_OUT_BASE;  BY INVESTIGATION_KEY RDB_COLUMN_NM BLOCK_NM ANSWER_GROUP_SEQ_NBR; 
   FORMAT ANSWER_DESC1-ANSWER_DESC20 $100.;  LENGTH ANSWER_DESC21 $8000;  FORMAT ANSWER_DESCCHECK 
$10.;   ARRAY ANSWER_DESC(20) ANSWER_DESC1-ANSWER_DESC20;
4270      + ANSWER_DESCCHECK='';  RETAIN  ANSWER_DESC1-ANSWER_DESC21 ' ' I 0;  IF FIRST.RDB_COLUMN_NM 
 THEN DO;   DO J=1 TO 20; ANSWER_DESC(J) = ' ';    END;   I = 0; ANSWER_DESC21 = '';  END;  I+1;  IF 
I <= 20 THEN DO;   IF LENGTHN(COMPRESS(col1))>0 AND LENGTHN
4271      +(ANSWER_DESCCHECK)<2 THEN ANSWER_DESCCHECK ='TRUE';   IF I = 1 THEN ANSWER_DESC21 =  
LEFT(TRIM(col1));   ELSE  ANSWER_DESC21 =LEFT(TRIM(ANSWER_DESC21))||' ~ '|| LEFT(TRIM(col1)) ;  END;  
IF LAST.RDB_COLUMN_NM THEN OUTPUT;  DROP ANSWER_DESC1-ANSWER_DESC20
4272      + _NAME_ _LABEL_ col1 I J;     RUN;

NOTE: There were 116 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_ALL has 68 observations and 6 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_ALL decreased size by 94.29 percent. 
      Compressed is 2 pages; un-compressed would require 35 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
1001                                        The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.01 seconds
      

4272      +                                    DATA REPEAT_BLOCK_OUT_BASE ; SET REPEAT_BLOCK_OUT_BASE 
; RDB_COLUMN_NM = _NAME_; RUN;

NOTE: There were 116 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 116 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 88.24 percent. 
      Compressed is 2 pages; un-compressed would require 17 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4272      +
DATA REPEAT_BLOCK_OUT_BASE; SET REPEAT_BLOCK_OUT_BASE; DATA_VALUE=col1; IF ANSWER_GROUP_SEQ_NBR = 1 
THEN COL2 =' ';   IF
4273      + ANSWER_GROUP_SEQ_NBR = 1 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL4 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 1 THEN COL5 =' ';    IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL1 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 2 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR =
4274      + 2 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 2 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL2 =' ';   IF 
ANSWER_GROUP_SEQ_NBR = 3 THEN COL4 =' ';   IF ANSWER_GROUP_SEQ_NBR = 3 THEN COL5 =' ';    IF
4275      + ANSWER_GROUP_SEQ_NBR = 4 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL2 =' ';   
IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR = 4 THEN COL5 =' ';    IF 
ANSWER_GROUP_SEQ_NBR = 5 THEN COL1 =' ';   IF ANSWER_GROUP_SEQ_NBR =
4276      + 5 THEN COL2 =' ';   IF ANSWER_GROUP_SEQ_NBR = 5 THEN COL3 =' ';   IF ANSWER_GROUP_SEQ_NBR 
= 5 THEN COL4 =' ';    RUN;

NOTE: There were 116 observations read from the data set WORK.REPEAT_BLOCK_OUT_BASE.
NOTE: The data set WORK.REPEAT_BLOCK_OUT_BASE has 116 observations and 12 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_OUT_BASE decreased size by 92.31 percent. 
      Compressed is 3 pages; un-compressed would require 39 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4276      +
PROC SQL;  
4276      +
 CREATE TABLE METADATA_OUT as select RDB_COLUMN_NM, _NAME_, COL1, BLOCK_NM, ANSWER_GROUP_SEQ_NBR FROM 
METADATA_OUT;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of this 
         is a possible data integrity problem.
NOTE: Compressing data set WORK.METADATA_OUT decreased size by 97.93 percent. 
      Compressed is 3 pages; un-compressed would require 145 pages.
NOTE: Table WORK.METADATA_OUT created, with 145 rows and 5 columns.

4276      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
1002                                        The SAS System             22:41 Saturday, January 6, 2024

      cpu time            0.00 seconds
      

4277      + PROC SQL;
4277      +           CREATE TABLE METADATA_MERGED_INIT AS SELECT distinct * FROM METADATA_OUT LEFT 
OUTER JOIN REPEAT_BLOCK_OUT_BASE ON UPCASE(METADATA_OUT.RDB_COLUMN_NM)  = 
UPCASE(REPEAT_BLOCK_OUT_BASE.RDB_COLUMN_NM) AND METADATA_OUT.ANSWER_GROUP_SEQ_NBR
4278      + =REPEAT_BLOCK_OUT_BASE.ANSWER_GROUP_SEQ_NBR AND METADATA_OUT.BLOCK_NM = 
REPEAT_BLOCK_OUT_BASE.BLOCK_NM ;
WARNING: Variable BLOCK_NM already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable ANSWER_GROUP_SEQ_NBR already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable _NAME_ already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable COL1 already exists on file WORK.METADATA_MERGED_INIT.
WARNING: Variable RDB_COLUMN_NM already exists on file WORK.METADATA_MERGED_INIT.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.59 percent. 
      Compressed is 3 pages; un-compressed would require 213 pages.
NOTE: Table WORK.METADATA_MERGED_INIT created, with 213 rows and 12 columns.

4278      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

4278      +
PROC SORT DATA=METADATA_MERGED_INIT ; BY INVESTIGATION_KEY;RUN;

NOTE: There were 213 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.METADATA_MERGED_INIT has 213 observations and 12 variables.
NOTE: Compressing data set WORK.METADATA_MERGED_INIT decreased size by 98.59 percent. 
      Compressed is 3 pages; un-compressed would require 213 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4278      +
PROC TRANSPOSE DATA=METADATA_MERGED_INIT OUT=INVESTIGATION_REPEAT_NUMERIC;
4279      + VAR DATA_VALUE;  ID COL1;     BY INVESTIGATION_KEY; RUN;

WARNING: 52 observations omitted due to missing ID values.
NOTE: There were 213 observations read from the data set WORK.METADATA_MERGED_INIT.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 20 observations and 95 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4279      +                                                           DATA 
INVESTIGATION_REPEAT_NUMERIC; SET INVESTIGATION_REPEAT_NUMERIC; DROP _NAME_; RUN;

1003                                        The SAS System             22:41 Saturday, January 6, 2024

NOTE: There were 20 observations read from the data set WORK.INVESTIGATION_REPEAT_NUMERIC.
NOTE: The data set WORK.INVESTIGATION_REPEAT_NUMERIC has 20 observations and 94 variables.
NOTE: Compressing data set WORK.INVESTIGATION_REPEAT_NUMERIC decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4279      +
PROC SQL;  
4279      +
 CREATE TABLE REPEAT_ALL AS SELECT DISTINCT RDB_COLUMN_NM, USER_DEFINED_COLUMN_NM  FROM
4280      + D_INV_REPEAT_METADATA;
NOTE: Compressing data set WORK.REPEAT_ALL increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.REPEAT_ALL created, with 29 rows and 2 columns.

4280      +                        QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4280      +                               DATA REPEAT_ALL; SET REPEAT_ALL; LENGTH 
USER_DEFINED_COLUMN_NM_ALL $4000; USER_DEFINED_COLUMN_NM_ALL = COMPRESS(USER_DEFINED_COLUMN_NM || 
'_ALL'); DROP USER_DEFINED_COLUMN_NM; RUN;

NOTE: There were 29 observations read from the data set WORK.REPEAT_ALL.
NOTE: The data set WORK.REPEAT_ALL has 29 observations and 2 variables.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 75.00 percent. 
      Compressed is 2 pages; un-compressed would require 8 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4280      +
PROC SQL;  
4280      +
 CREATE TABLE
4281      + REPEAT_BLOCK_METADATA_OUT AS SELECT REPEAT_BLOCK_OUT_ALL.*, 
REPEAT_ALL.USER_DEFINED_COLUMN_NM_ALL FROM REPEAT_ALL LEFT OUTER JOIN REPEAT_BLOCK_OUT_ALL  ON 
UPCASE(REPEAT_ALL.RDB_COLUMN_NM) = UPCASE(REPEAT_BLOCK_OUT_ALL.RDB_COLUMN_NM);
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 97.53 percent. 
      Compressed is 2 pages; un-compressed would require 81 pages.
NOTE: Table WORK.REPEAT_BLOCK_METADATA_OUT created, with 81 rows and 7 columns.

4281      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
1004                                        The SAS System             22:41 Saturday, January 6, 2024


4281      +
PROC SQL;  
4282      + DELETE FROM REPEAT_BLOCK_METADATA_OUT WHERE USER_DEFINED_COLUMN_NM_ALL= '_ALL';
NOTE: No rows were deleted from WORK.REPEAT_BLOCK_METADATA_OUT.

4282      +                                                                                 QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4282      +                                                                                          
PROC SORT DATA=REPEAT_BLOCK_METADATA_OUT ; BY INVESTIGATION_KEY ;RUN;

NOTE: There were 81 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_METADATA_OUT has 81 observations and 7 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_METADATA_OUT decreased size by 97.53 percent. 
      Compressed is 2 pages; un-compressed would require 81 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

4282      +
PROC TRANSPOSE DATA=REPEAT_BLOCK_METADATA_OUT OUT=REPEAT_BLOCK_NUMERIC_ALL;  VAR ANSWER_DESC21
4283      +;  ID USER_DEFINED_COLUMN_NM_ALL;     BY INVESTIGATION_KEY ; RUN;

NOTE: There were 81 observations read from the data set WORK.REPEAT_BLOCK_METADATA_OUT.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 20 observations and 31 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4283      +                                                                   DATA 
REPEAT_BLOCK_NUMERIC_ALL; SET REPEAT_BLOCK_NUMERIC_ALL; DROP _NAME_; RUN;

NOTE: There were 20 observations read from the data set WORK.REPEAT_BLOCK_NUMERIC_ALL.
NOTE: The data set WORK.REPEAT_BLOCK_NUMERIC_ALL has 20 observations and 30 variables.
NOTE: Compressing data set WORK.REPEAT_BLOCK_NUMERIC_ALL decreased size by 90.00 percent. 
      Compressed is 2 pages; un-compressed would require 20 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

4285      + PROC SQL;
4285      +           DROP TABLE  NBS_RDB.DM_INV_TB_LTBI;
NOTE: Table NBS_RDB.DM_INV_TB_LTBI has been dropped.
4285      +                                               QUIT;
NOTE: PROCEDURE SQL used (Total process time):
1005                                        The SAS System             22:41 Saturday, January 6, 2024

      real time           0.03 seconds
      cpu time            0.00 seconds
      

4285      +                                                      PROC SQL;
4285      +                                                                 CREATE TABLE DISCRETE_ALL 
AS SELECT * FROM INV_SUMM_DATAMART  LEFT JOIN INVESTIGATION_DATA ON 
INVESTIGATION_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN PATIENT_DATA
4286      + ON PATIENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
CASE_MANAGEMENT_DATA ON CASE_MANAGEMENT_DATA.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_ADMINISTRATIVE ON D_INV_ADMINISTRATIVE.INVESTIGATION_KEY
4287      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_CLINICAL ON 
D_INV_CLINICAL.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_COMPLICATION ON 
D_INV_COMPLICATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
4288      + D_INV_CONTACT ON D_INV_CONTACT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN D_INV_DEATH ON D_INV_DEATH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_EPIDEMIOLOGY ON D_INV_EPIDEMIOLOGY.INVESTIGATION_KEY
4289      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_HIV ON D_INV_HIV.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PATIENT_OBS ON 
D_INV_PATIENT_OBS.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN
4290      + D_INV_ISOLATE_TRACKING ON D_INV_ISOLATE_TRACKING.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_LAB_FINDING ON 
D_INV_LAB_FINDING.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY  LEFT JOIN 
D_INV_MEDICAL_HISTORY ON
4291      + D_INV_MEDICAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_MOTHER ON D_INV_MOTHER.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_OTHER ON D_INV_OTHER.INVESTIGATION_KEY
4292      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_PREGNANCY_BIRTH ON 
D_INV_PREGNANCY_BIRTH.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_RESIDENCY ON D_INV_RESIDENCY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT
4293      + JOIN D_INV_RISK_FACTOR ON D_INV_RISK_FACTOR.INVESTIGATION_KEY 
=INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SOCIAL_HISTORY ON 
D_INV_SOCIAL_HISTORY.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_SYMPTOM ON
4294      + D_INV_SYMPTOM.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY   LEFT JOIN 
D_INV_TREATMENT ON D_INV_TREATMENT.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_TRAVEL ON D_INV_TRAVEL.INVESTIGATION_KEY
4295      + =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN D_INV_UNDER_CONDITION ON 
D_INV_UNDER_CONDITION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT JOIN 
D_INV_VACCINATION ON D_INV_VACCINATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY
4296      + LEFT JOIN D_INV_STD ON D_INV_STD.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY 
LEFT JOIN ORGANIZATION ON ORGANIZATION.INVESTIGATION_KEY =INV_SUMM_DATAMART.INVESTIGATION_KEY LEFT 
JOIN PROVIDER ON PROVIDER.INVESTIGATION_KEY
4297      + =INV_SUMM_DATAMART.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable PATIENT_LOCAL_ID already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
1006                                        The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable EXPRSSN already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DISCRETE_ALL.
NOTE: Compressing data set WORK.DISCRETE_ALL decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.DISCRETE_ALL created, with 55 rows and 286 columns.

4297      +                                       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.17 seconds
      cpu time            0.18 seconds
      

4297      +                                              PROC SQL;
4297      +                                                        CREATE TABLE REPEAT_ALL AS SELECT 
* FROM  INVESTIGATION_REPEAT_VARCHAR LEFT JOIN REPEAT_BLOCK_VARCHAR_ALL ON 
REPEAT_BLOCK_VARCHAR_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY
4298      + LEFT JOIN INVESTIGATION_REPEAT_NUMERIC ON INVESTIGATION_REPEAT_NUMERIC.INVESTIGATION_KEY 
=INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN INVESTIGATION_REPEAT_DATE ON 
INVESTIGATION_REPEAT_DATE.INVESTIGATION_KEY
4299      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN REPEAT_BLOCK_DATE_ALL ON 
REPEAT_BLOCK_DATE_ALL.INVESTIGATION_KEY =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY LEFT JOIN 
REPEAT_BLOCK_NUMERIC_ALL ON REPEAT_BLOCK_NUMERIC_ALL.INVESTIGATION_KEY
4300      + =INVESTIGATION_REPEAT_VARCHAR.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_IND_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_IND_2 already exists on file WORK.REPEAT_ALL.
1007                                        The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable ADV_EVE_IND_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_IND_4 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_IND_5 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_4 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_5 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_TYPE_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_TYPE_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DIAGNOSIS_TYPE_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DIAGNOSIS_TYPE_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_CAVITY_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_CAVITY_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_MILIARY_TB_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_MILIARY_TB_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_RSLT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_RSLT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_4 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_5 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_INDUSTRY_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_INDUSTRY_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_OCCUPATION_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_OCCUPATION_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable GENE_NM_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable GENE_NM_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable GENE_NM_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_INDEL_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_INDEL_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_INDEL_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_SPEC_SRC_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_SPEC_SRC_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_SPEC_SRC_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_TST_TYP_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_TST_TYP_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_TST_TYP_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_RSLT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_RSLT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_RSLT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable QUANT_RSLT_UNITS_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable QUANT_RSLT_UNITS_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SPECIMEN_SOURCE_2 already exists on file WORK.REPEAT_ALL.
1008                                        The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable SPECIMEN_SOURCE_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_RESULT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_RESULT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_TYPE_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_TYPE_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CMPLT_TRT_PREV_DIAG_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CMPLT_TRT_PREV_DIAG_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DRG_USD_TRT_MDR_TB_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DRG_USD_TRT_MDR_TB_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DRG_USD_TRT_MDR_TB_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DUR_DRG_ADMINSTRD_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DUR_DRG_ADMINSTRD_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DUR_DRG_ADMINSTRD_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_INDUSTRY_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_OCCUPATION_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable QUANT_RSLT_UNITS_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable SPECIMEN_SOURCE_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_RESULT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_TYPE_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_RESULT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_RESULT_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_RESULT_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_SPECIMEN_SRC_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_SPECIMEN_SRC_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_SPECIMEN_SRC_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_TEST_METHOD_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_TEST_METHOD_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_TEST_METHOD_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_DRUG_NM_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_DRUG_NM_2 already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_DRUG_NM_3 already exists on file WORK.REPEAT_ALL.
WARNING: Variable DIAGNOSIS_TYPE_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CMPLT_TRT_PREV_DIAG_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_TYPE_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_CAVITY_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_MILIARY_TB_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_RSLT_1 already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_IND_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADV_EVE_MNFSTN_DT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ADVERSE_EVENT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTRY_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CNTY_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable ST_OR_PROV_OF_EXP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable GENE_NM_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_INDEL_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_SPEC_SRC_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_TST_TYP_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable MOLEC_SUSC_RSLT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable DRG_USD_TRT_MDR_TB_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable DUR_DRG_ADMINSTRD_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CURRENT_INDUSTRY_ALL already exists on file WORK.REPEAT_ALL.
1009                                        The SAS System             22:41 Saturday, January 6, 2024

WARNING: Variable CURRENT_OCCUPATION_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable QUANT_RSLT_UNITS_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable SPECIMEN_SOURCE_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_RESULT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable TEST_TYPE_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_RESULT_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_SPECIMEN_SRC_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_TEST_METHOD_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable AST_DRUG_NM_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable DIAGNOSIS_TYPE_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CMPLT_TRT_PREV_DIAG_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_TYPE_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_CAVITY_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable EVIDENCE_MILIARY_TB_ALL already exists on file WORK.REPEAT_ALL.
WARNING: Variable CHEST_STDY_RSLT_ALL already exists on file WORK.REPEAT_ALL.
NOTE: Compressing data set WORK.REPEAT_ALL decreased size by 90.48 percent. 
      Compressed is 2 pages; un-compressed would require 21 pages.
NOTE: Table WORK.REPEAT_ALL created, with 21 rows and 233 columns.

4300      +                                                  QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.14 seconds
      

4300      +                                                         PROC SQL;
4300      +                                                                   CREATE TABLE 
DM_INV_TB_LTBI AS SELECT * FROM  DISCRETE_ALL LEFT OUTER JOIN REPEAT_ALL ON  
DISCRETE_ALL.INVESTIGATION_KEY = REPEAT_ALL.INVESTIGATION_KEY;
WARNING: Variable INVESTIGATION_KEY already exists on file WORK.DM_INV_TB_LTBI.
NOTE: Compressing data set WORK.DM_INV_TB_LTBI decreased size by 96.36 percent. 
      Compressed is 2 pages; un-compressed would require 55 pages.
NOTE: Table WORK.DM_INV_TB_LTBI created, with 55 rows and 518 columns.

4300      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

4300      +
Proc Append Force
4301      + base=nbs_rdb.DM_INV_TB_LTBI data=DM_INV_TB_LTBI;  Run;

NOTE: Appending WORK.DM_INV_TB_LTBI to NBS_RDB.DM_INV_TB_LTBI.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: SAS variable labels, formats, and lengths are not written to DBMS tables.
WARNING: Engine ODBC does not support SORTEDBY operations.  SORTEDBY information cannot be copied.
NOTE: There were 55 observations read from the data set WORK.DM_INV_TB_LTBI.
NOTE: The data set NBS_RDB.DM_INV_TB_LTBI has 55 observations and 518 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.12 seconds
      cpu time            0.01 seconds
1010                                        The SAS System             22:41 Saturday, January 6, 2024

      
4301      +                                                         Quit;;

4301      +                                                                 PROC SQL;
4301      +                                                                           DROP TABLE 
DISCRETE_ALL;
NOTE: Table WORK.DISCRETE_ALL has been dropped.
4301      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4301      +
PROC SQL;  
4301      +
 DROP TABLE REPEAT_ALL;
NOTE: Table WORK.REPEAT_ALL has been dropped.
4301      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

4301      +
PROC SQL;  
4301      +
 DROP TABLE DM_INV_TB_LTBI;
NOTE: Table WORK.DM_INV_TB_LTBI has been dropped.
4301      +
 QUIT;     
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2327       
2328       /*The following code was created */
2329       
2330       /*A table with the investigations with data mart name associated to it but not condition*/
2331       
2332       PROC SQL;
2333       CREATE TABLE INIT_BLANK AS
2334       	SELECT  NBS_PAGE.FORM_CD, NBS_PAGE.DATAMART_NM FROM NBS_ODS.NBS_PAGE LEFT JOIN
2334     ! NBS_ODS.PAGE_COND_MAPPING
2335       	ON PAGE_COND_MAPPING.WA_TEMPLATE_UID = NBS_PAGE.WA_TEMPLATE_UID
2336       WHERE DATAMART_NM IS NOT NULL AND CONDITION_CD IS NULL;
NOTE: Compressing data set WORK.INIT_BLANK increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: Table WORK.INIT_BLANK created, with 1 rows and 2 columns.

2337       QUIT;
1011                                        The SAS System             22:41 Saturday, January 6, 2024

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      

2338       
2339       /*table for those investigations without condition associated to it, where the rdb_table_nm
2339     !  is investigation */
2340       PROC SQL;
2341       CREATE TABLE INIT_FORM_BLANK_SET AS
2342       SELECT INIT_BLANK.FORM_CD, INIT_BLANK.DATAMART_NM  FROM INIT_BLANK INNER JOIN
2342     ! NBS_ODS.NBS_UI_METADATA
2343       ON NBS_UI_METADATA.INVESTIGATION_FORM_CD = INIT_BLANK.FORM_CD
2344       INNER JOIN NBS_ODS.NBS_RDB_METADATA
2345       ON NBS_UI_METADATA.NBS_UI_METADATA_UID = NBS_RDB_METADATA.NBS_UI_METADATA_UID
2346       WHERE RDB_TABLE_NM='INVESTIGATION' ORDER BY INIT_BLANK.FORM_CD,
2346     ! NBS_RDB_METADATA.RDB_COLUMN_NM;
NOTE: The query as specified involves ordering by an item that doesn't appear in its SELECT clause.
NOTE: Compressing data set WORK.INIT_FORM_BLANK_SET decreased size by 0.00 percent. 
      Compressed is 2 pages; un-compressed would require 2 pages.
NOTE: Table WORK.INIT_FORM_BLANK_SET created, with 46 rows and 2 columns.

2347       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

2348       PROC SORT DATA= INIT_FORM_BLANK_SET NODUPKEY; BY FORM_CD;RUN;

NOTE: There were 46 observations read from the data set WORK.INIT_FORM_BLANK_SET.
NOTE: 45 observations with duplicate key values were deleted.
NOTE: The data set WORK.INIT_FORM_BLANK_SET has 1 observations and 2 variables.
NOTE: Compressing data set WORK.INIT_FORM_BLANK_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2349       
2350       %ASSIGN_KEY (INIT_FORM_BLANK_SET, SORT_KEY);

NOTE: There were 1 observations read from the data set WORK.INIT_FORM_BLANK_SET.
NOTE: The data set WORK.INIT_FORM_BLANK_SET has 2 observations and 3 variables.
NOTE: Compressing data set WORK.INIT_FORM_BLANK_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 2 observations read from the data set WORK.INIT_FORM_BLANK_SET.
1012                                        The SAS System             22:41 Saturday, January 6, 2024

NOTE: 1 observations with duplicate key values were deleted.
NOTE: The data set WORK.INIT_FORM_BLANK_SET has 1 observations and 3 variables.
NOTE: Compressing data set WORK.INIT_FORM_BLANK_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2351       
2352       /*dropping the table*/
2353       
2354       DATA INIT_FORM_BLANK_SET;
2355         SET INIT_FORM_BLANK_SET;
2356       	BY SORT_KEY;
2357       	LENGTH RDB_COLUMN_NAME $30;
2358       	LENGTH INVESTIGATION_FORM_CODE $30;
2359       	IF FIRST.SORT_KEY THEN
2360       		DATAMART_NAME = 'DM_INV_'|| DATAMART_NM;
2361       		call execute('%INVEST_FORM_CLEAN_PROC('|| DATAMART_NAME||')');
2362       
2363       
2364       	OUTPUT;
2365       	
2366       	
2367       RUN;

NOTE: Variable RDB_COLUMN_NAME is uninitialized.
NOTE: Variable INVESTIGATION_FORM_CODE is uninitialized.
NOTE: There were 1 observations read from the data set WORK.INIT_FORM_BLANK_SET.
NOTE: The data set WORK.INIT_FORM_BLANK_SET has 1 observations and 6 variables.
NOTE: Compressing data set WORK.INIT_FORM_BLANK_SET increased size by 100.00 percent. 
      Compressed is 2 pages; un-compressed would require 1 pages.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: CALL EXECUTE generated line.
1         + PROC SQL;
1         +           DROP TABLE NBS_RDB.DM_INV_MONKEYPOX;
WARNING: File NBS_RDB.DM_INV_MONKEYPOX.DATA does not exist.
WARNING: Table NBS_RDB.DM_INV_MONKEYPOX has not been dropped.
1         +                                                QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

2368       
2369       
2370       

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
1013                                        The SAS System             22:41 Saturday, January 6, 2024

NOTE: The SAS System used:
      real time           5:01.30
      cpu time            1:45.92
      
